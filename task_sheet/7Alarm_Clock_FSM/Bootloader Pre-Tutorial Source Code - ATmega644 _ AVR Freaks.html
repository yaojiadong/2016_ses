<!DOCTYPE html>
<!-- saved from url=(0085)http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all -->
<html lang="en" dir="ltr" prefix="content: http://purl.org/rss/1.0/modules/content/ dc: http://purl.org/dc/terms/ foaf: http://xmlns.com/foaf/0.1/ og: http://ogp.me/ns# rdfs: http://www.w3.org/2000/01/rdf-schema# sioc: http://rdfs.org/sioc/ns# sioct: http://rdfs.org/sioc/types# skos: http://www.w3.org/2004/02/skos/core# xsd: http://www.w3.org/2001/XMLSchema# schema: http://schema.org/" class="js js flexbox canvas canvastext webgl no-touch geolocation postmessage websqldatabase indexeddb hashchange history draganddrop websockets rgba hsla multiplebgs backgroundsize borderimage borderradius boxshadow textshadow opacity cssanimations csscolumns cssgradients cssreflections csstransforms csstransforms3d csstransitions fontface generatedcontent video audio localstorage sessionstorage webworkers applicationcache svg inlinesvg smil svgclippaths js boxshadow"><!--<![endif]--><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<meta property="og:type" content="article">
<meta property="og:site_name" content="AVR Freaks">
<meta property="og:url" content="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644">
<link rel="shortcut icon" href="http://www.avrfreaks.net/sites/all/themes/avrfreaks/favicon.ico" type="image/vnd.microsoft.icon">
<link rel="canonical" href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644">
<link rel="shortlink" href="http://www.avrfreaks.net/node/58300">
<meta name="generator" content="Drupal 7 (http://drupal.org)">
<meta content="Bootloader Pre-Tutorial Source Code - ATmega644" about="/forum/bootloader-pre-tutorial-source-code-atmega644" property="dc:title">
<meta name="description" content="I&#39;m in the midst of writing a Bootloader Tutorial for the Tutorials Forum and I&#39;ve gotten a bootloader working in C for the ATmega644 that I wanted to post a">
<meta about="/forum/bootloader-pre-tutorial-source-code-atmega644" property="sioc:num_replies" content="63" datatype="xsd:integer">
<meta property="og:description" content="I&#39;m in the midst of writing a Bootloader Tutorial for the Tutorials Forum and I&#39;ve gotten a bootloader working in C for the ATmega644 that I wanted to post a">
<meta property="og:title" content="Bootloader Pre-Tutorial Source Code - ATmega644">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="MobileOptimized" content="width">
<meta name="HandheldFriendly" content="true">
<meta name="apple-mobile-web-app-capable" content="yes">
<title>Bootloader Pre-Tutorial Source Code - ATmega644 | AVR Freaks</title>
<link type="text/css" rel="stylesheet" href="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/css_pbm0lsQQJ7A7WCCIMgxLho6mI_kBNgznNUWmTWcnfoE.css" media="all">
<link type="text/css" rel="stylesheet" href="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/css_g-qSaKSWUGFZE4v41ZakDLsoWUvbVDhhKffxc8tJ3uk.css" media="all">
<link type="text/css" rel="stylesheet" href="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/css_lVpVtDU976erTkJykGPKgsPurcVpE2Q3VFXKn4serlk.css" media="all">
<link type="text/css" rel="stylesheet" href="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/css_zfSUIO-bntnzdWiInxP6Z-6_mi1ptcF35QgYBPBt3gA.css" media="screen">
<link type="text/css" rel="stylesheet" href="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/css_6b38QoA10iNo0WlQABsPuoYUzGFZrPw1WER3vGjCXdw.css" media="print">
<link type="text/css" rel="stylesheet" href="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/css_uS4NjxRdC3RJ1agsmisNJLwbZc3YBKRTDDybOGIbj3k.css" media="only screen">

<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="http://www.avrfreaks.net/sites/default/files/css/css_-5FYXt7x7pi1LDVhNX3xqD-mTMEh3bq59MoR4cM3N8Q.css" media="screen" />
<![endif]-->

<!--[if (lt IE 9)&(!IEMobile 7)]>
<link type="text/css" rel="stylesheet" href="http://www.avrfreaks.net/sites/default/files/css/css_DqMa2yIJOsRmEDdvyvYEmkQ1UPvriDJ1S7BifKQzo5I.css" media="screen" />
<![endif]-->
<script type="text/javascript" async="" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/ga.js"></script><script src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/js_0gj6QcpfRH2jzTbCQqf7kEkm4MXY0UA_sRhwPc8jC1o.js"></script>
<script src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/js_OIqIkRHsLHCh1LkPSgRxfdOHazSjrcYru0XJEh1iLus.js"></script>
<script src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/js_D513xrHxkFzR3xMs-U1B-okOiPuXCy6MX1kwfrKN5Ls.js"></script>
<script src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/js_H1de-9op2ODTGt39FqMmKipMv3OWbiqoVKMN-bQNeaQ.js"></script>
<script>var _gaq = _gaq || [];_gaq.push(["_setAccount", "UA-1473358-1"]);_gaq.push(["_trackPageview"]);(function() {var ga = document.createElement("script");ga.type = "text/javascript";ga.async = true;ga.src = ("https:" == document.location.protocol ? "https://ssl" : "http://www") + ".google-analytics.com/ga.js";var s = document.getElementsByTagName("script")[0];s.parentNode.insertBefore(ga, s);})();</script>
<script src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/js_MbUlIYOCWfucM3dM8YlAM4sBXExMh83PgE3fvukwVUI.js"></script>
<script src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/modernizr.min.js"></script>
<script src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/js_9LxQYNcHez42saCSnQXHePouksOl8pzxQr4SokgRx18.js"></script>
<script src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/js_B3vW3HLQ7vwUMIMKvie5hiboXgTfG3IttznnA9sJOyQ.js"></script>
<script>jQuery.extend(Drupal.settings, {"basePath":"\/","pathPrefix":"","ajaxPageState":{"theme":"avrfreaks","theme_token":"U35_LwPHOAUPHf3PUG9vNbm1R05KKerUJA9C8x7-fJI","js":{"sites\/all\/modules\/contrib\/jquery_update\/replace\/jquery\/1.7\/jquery.min.js":1,"misc\/jquery.once.js":1,"misc\/drupal.js":1,"sites\/all\/modules\/contrib\/jquery_update\/replace\/ui\/external\/jquery.cookie.js":1,"sites\/all\/modules\/contrib\/jquery_update\/replace\/misc\/jquery.form.min.js":1,"misc\/ajax.js":1,"sites\/all\/modules\/contrib\/apachesolr_sort\/apachesolr_sort.js":1,"sites\/all\/modules\/contrib\/apachesolr_autocomplete\/apachesolr_autocomplete.js":1,"sites\/all\/modules\/contrib\/apachesolr_autocomplete\/jquery-autocomplete\/jquery.autocomplete.js":1,"sites\/all\/modules\/custom\/quote\/quote.js":1,"misc\/progress.js":1,"profiles\/commons\/modules\/contrib\/ctools\/js\/modal.js":1,"profiles\/commons\/modules\/contrib\/rate\/templates\/fivestar\/fivestar.js":1,"profiles\/commons\/modules\/contrib\/rate\/rate.js":1,"sites\/all\/modules\/custom\/avrfreaks_forum\/js\/avrfreaks_forum.js":1,"sites\/all\/modules\/contrib\/google_analytics\/googleanalytics.js":1,"0":1,"sites\/all\/modules\/custom\/avrfreaks_moderate\/js\/avrfreaks_moderate.js":1,"http:\/\/cdnjs.cloudflare.com\/ajax\/libs\/modernizr\/2.0.6\/modernizr.min.js":1,"sites\/all\/modules\/contrib\/hide_submit\/hide_submit.js":1,"sites\/all\/themes\/avrfreaks\/scripts\/modernizr.js":1,"sites\/all\/themes\/avrfreaks\/scripts\/syze.min.js":1,"sites\/all\/themes\/avrfreaks\/scripts\/script.js":1},"css":{"modules\/system\/system.base.css":1,"modules\/system\/system.menus.css":1,"modules\/system\/system.messages.css":1,"modules\/system\/system.theme.css":1,"modules\/comment\/comment.css":1,"profiles\/commons\/modules\/contrib\/date\/date_api\/date.css":1,"modules\/field\/theme\/field.css":1,"profiles\/commons\/modules\/contrib\/mollom\/mollom.css":1,"modules\/node\/node.css":1,"modules\/poll\/poll.css":1,"modules\/user\/user.css":1,"modules\/forum\/forum.css":1,"profiles\/commons\/modules\/contrib\/views\/css\/views.css":1,"sites\/all\/modules\/contrib\/ckeditor\/css\/ckeditor.css":1,"profiles\/commons\/modules\/commons\/commons_media\/commons_media.css":1,"sites\/all\/modules\/contrib\/apachesolr_autocomplete\/apachesolr_autocomplete.css":1,"sites\/all\/modules\/contrib\/apachesolr_autocomplete\/jquery-autocomplete\/jquery.autocomplete.css":1,"profiles\/commons\/modules\/contrib\/ctools\/css\/ctools.css":1,"sites\/all\/modules\/custom\/quote\/quote.css":1,"sites\/all\/modules\/contrib\/tagclouds\/tagclouds.css":1,"sites\/all\/modules\/custom\/advanced_forum\/styles\/naked\/advanced-forum.naked.structure.css":1,"sites\/all\/modules\/custom\/advanced_forum\/styles\/naked\/advanced-forum.naked.images.css":1,"profiles\/commons\/modules\/contrib\/ctools\/css\/modal.css":1,"profiles\/commons\/modules\/contrib\/rate\/templates\/fivestar\/fivestar.css":1,"sites\/all\/modules\/custom\/avrfreaks_forum\/css\/forum-topic.css":1,"profiles\/commons\/modules\/contrib\/rate\/rate.css":1,"sites\/all\/modules\/contrib\/hide_submit\/hide_submit.css":1,"profiles\/commons\/themes\/contrib\/adaptivetheme\/at_core\/css\/at.layout.css":1,"sites\/all\/themes\/avrfreaks\/css\/global.base.css":1,"sites\/all\/themes\/avrfreaks\/css\/global.styles.css":1,"sites\/all\/themes\/avrfreaks\/css\/global.breakpoints.css":1,"sites\/all\/themes\/avrfreaks\/css\/community.breakpoints.css":1,"sites\/all\/themes\/avrfreaks\/css\/forum.css":1,"sites\/all\/themes\/avrfreaks\/css\/pager.css":1,"sites\/all\/themes\/avrfreaks\/css\/community.css":1,"sites\/all\/themes\/avrfreaks\/css\/print.css":1,"public:\/\/adaptivetheme\/avrfreaks_files\/avrfreaks.responsive.layout.css":1,"public:\/\/adaptivetheme\/avrfreaks_files\/avrfreaks.responsive.styles.css":1,"public:\/\/adaptivetheme\/avrfreaks_files\/avrfreaks.lt-ie9.layout.css":1,"sites\/all\/themes\/avrfreaks\/css\/lt-ie9.css":1}},"apachesolr_autocomplete":{"path":"\/apachesolr_autocomplete"},"quote_nest":"0","CToolsModal":{"loadingText":"Loading...","closeText":"Close Window","closeImage":"\u003Cimg typeof=\u0022foaf:Image\u0022 class=\u0022image-style-none\u0022 src=\u0022http:\/\/www.avrfreaks.net\/profiles\/commons\/modules\/contrib\/ctools\/images\/icon-close-window.png\u0022 alt=\u0022Close window\u0022 title=\u0022Close window\u0022 \/\u003E","throbber":"\u003Cimg typeof=\u0022foaf:Image\u0022 class=\u0022image-style-none\u0022 src=\u0022http:\/\/www.avrfreaks.net\/profiles\/commons\/modules\/contrib\/ctools\/images\/throbber.gif\u0022 alt=\u0022Loading\u0022 title=\u0022Loading...\u0022 \/\u003E"},"rate":{"basePath":"\/rate\/vote\/js","destination":"node\/58300?page=all"},"hide_submit":{"hide_submit_status":true,"hide_submit_method":"disable","hide_submit_css":"hide-submit-disable","hide_submit_abtext":"","hide_submit_atext":"","hide_submit_hide_css":"hide-submit-processing","hide_submit_hide_text":"Processing...","hide_submit_hide_fx":false,"hide_submit_reset_time":5000},"googleanalytics":{"trackOutbound":1,"trackMailto":1,"trackDownload":1,"trackDownloadExtensions":"7z|aac|arc|arj|asf|asx|avi|bin|csv|doc|exe|flv|gif|gz|gzip|hqx|jar|jpe?g|js|mp(2|3|4|e?g)|mov(ie)?|msi|msp|pdf|phps|png|ppt|qtm?|ra(m|r)?|sea|sit|tar|tgz|torrent|txt|wav|wma|wmv|wpd|xls|xml|z|zip"},"adaptivetheme":{"avrfreaks":{"layout_settings":{"bigscreen":"three-col-grail","tablet_landscape":"three-col-grail","tablet_portrait":"one-col-vert","smalltouch_landscape":"one-col-vert","smalltouch_portrait":"one-col-stack"},"media_query_settings":{"bigscreen":"only screen and (min-width:1800px)","tablet_landscape":"only screen and (min-width:755px) and (max-width:1799px)","tablet_portrait":"only screen and (min-width:680px) and (max-width:754px)","smalltouch_landscape":"only screen and (min-width:321px) and (max-width:679px)","smalltouch_portrait":"only screen and (max-width:320px)"}}}});</script>
<!--[if lt IE 9]>
<script src="http://www.avrfreaks.net/profiles/commons/themes/contrib/adaptivetheme/at_core/scripts/html5.js?o6e13p"></script>
<![endif]-->
</head>
<body class="html not-front not-logged-in no-sidebars page-node page-node- page-node-58300 node-type-forum site-name-hidden atr-7.x-3.x atv-7.x-3.4 palette-active palette-blue-blue webkit chrome win avr-freaks ios7-fix-processed">
  <div id="skip-link">
    <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#main-content" class="element-invisible element-focusable">Skip to main content</a>
  </div>
    <div class="header-wrapper">
  <div class="header-color-row-one">
    <header id="header" class="clearfix" role="banner">

              <!-- start: Branding -->
        <div id="branding" class="branding-elements clearfix branding-mobile">
                      <div id="logo">
                <a class="avr-menu-toggle mobile-menu-processed" href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#top"><img class="nav-mobile" typeof="foaf:Image" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/hamburger.png" alt="Menu"></a>
              <a href="http://www.avrfreaks.net/" title="AVR Freaks"><img class="site-logo" typeof="foaf:Image" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/Atmel_Freaks_logo_large.png" alt="AVR Freaks"></a>              <a href="http://www.avrfreaks.net/" class="mobile-logo-link"><img class="site-logo-mobile" typeof="foaf:Image" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/mobile_logo.png" alt="AVR Freaks"></a>            </div>
          
                      <!-- start: Site name and Slogan hgroup -->
            <hgroup class="element-invisible h-group" id="name-and-slogan">

                              <h1 class="element-invisible" id="site-name"><a href="http://www.avrfreaks.net/" title="Home page">AVR Freaks</a></h1>
              
              
            </hgroup><!-- /end #name-and-slogan -->
          
        </div><!-- /end #branding -->
           
      <!-- Navigation elements -->
        <div id="menu-bar" class="nav clearfix"><nav id="block-menu-menu-main-menu-mobile" class="block block-menu menu-wrapper menu-bar-wrapper clearfix odd first block-count-1 block-region-menu-bar block-menu-main-menu-mobile" role="navigation">  
      <h3 class="element-invisible block-title">Main menu mobile</h3>
  
  <ul class="menu clearfix"><li class="first leaf"><a href="http://www.avrfreaks.net/" class="thin">Home</a></li>
<li class="leaf"><a href="http://community.atmel.com/communities">Communities</a></li>
<li class="leaf"><a href="http://www.avrfreaks.net/forum" class="thin">Forums</a></li>
<li class="leaf"><a href="http://community.atmel.com/projects" class="thin">Projects</a></li>
<li class="leaf"><a href="http://community.atmel.com/vendors" class="thin">Vendors</a></li>
<li class="leaf"><a href="http://www.avrfreaks.net/wiki" class="thin">Wiki</a></li>
<li class="leaf"><a href="http://community.atmel.com/search/site" class="thick">Search</a></li>
<li class="leaf"><a href="http://community.atmel.com/user" class="thin">My summary</a></li>
<li class="leaf"><a href="http://www.atmel.com/About/privacy.aspx" class="thin" target="_blank">Privacy</a></li>
<li class="leaf"><a href="http://www.atmel.com/About/contact/distributors/default.aspx?contactType=Online%20Directory" class="thin" target="_blank">Contact</a></li>
<li class="leaf"><a href="http://www.atmel.com/About/legal.aspx" class="thin" target="_blank">Site Use Terms</a></li>
<li class="last leaf"><a href="http://www.atmel.com/About/cookies.aspx" class="thin" target="_blank">Cookies</a></li>
</ul>
  </nav><nav id="block-system-main-menu" class="block block-system block-menu no-title menu-wrapper menu-bar-wrapper clearfix even last block-count-2 block-region-menu-bar block-main-menu" role="navigation">  
  
  <ul class="menu clearfix"><li class="first leaf"><a href="http://community.atmel.com/communities">Communities</a></li>
<li class="leaf active-trail"><a href="http://www.avrfreaks.net/forum" class="active">Forums</a></li>
<li class="leaf"><a href="http://community.atmel.com/projects">Projects</a></li>
<li class="leaf"><a href="http://community.atmel.com/vendors">Vendors</a></li>
<li class="last leaf"><a href="http://www.avrfreaks.net/wiki/brief-history-artificial-intelligence" title="Wiki">WIKI</a></li>
</ul>
  </nav></div>
      <!-- region: Header -->
      <div class="region region-header"><div class="region-inner clearfix"><div id="block-avrfreaks-rewrites-avr-header-logout-link" class="block block-avrfreaks-rewrites no-title odd first block-count-3 block-region-header block-avr-header-logout-link"><div class="block-inner clearfix">  
  
  <div class="block-content content"><ul class="authentication-links"><li class="signup first"><a href="http://www.avrfreaks.net/user/register">Signup</a></li>
<li class="login last"><a href="http://www.avrfreaks.net/user/login?destination=home-new">Login</a></li>
</ul></div>
  </div></div><div id="block-search-form" class="block block-search no-title even last block-count-4 block-region-header block-form" role="search"><div class="block-inner clearfix">  
  
  <div class="block-content content"><form action="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all" method="post" id="search-block-form" accept-charset="UTF-8" class="form hideSubmitButton-processed">
  <div>
        <div class="container-inline">
      <h2 class="element-invisible">Search form</h2>
    <div class="form-item form-type-textfield form-item-search-block-form">
  <label class="element-invisible" for="edit-search-block-form--2">Search </label>
 <input title="Enter the terms you wish to search for." class="apachesolr-autocomplete unprocessed form-text form-autocomplete" placeholder="What are you interested in?" type="search" id="edit-search-block-form--2" name="search_block_form" value="" size="15" maxlength="128" autocomplete="off">
</div>
<div class="form-item form-type-select form-item-filter-by">
 <select id="edit-filter-by" name="filter_by" class="form-select"><option value="all">Entire Site</option><option value="forum">All Communities</option><option value="9631">AVR Freaks</option><option value="9636">Atmel SMART ARM-based MCUs</option><option value="9666">Internet of Things</option><option value="9826">Capacitive Touch</option><option value="project">Projects</option><option value="vendor">Vendors</option><option value="wiki">Wiki</option></select>
</div>
<div class="form-actions form-wrapper" id="edit-actions"><input type="submit" id="edit-submit" name="op" value="Search" class="form-submit"></div><input type="hidden" name="form_build_id" value="form-CzKoiZEkYfeaoIpCvZ3s6_Bn0rr-Y5iCC1yBaH8quoM">
<input type="hidden" name="form_id" value="search_block_form">
</div>
  </div>
</form>

</div>
  </div></div></div></div>    </header>
  </div>
  <div class="header-color-row-two"></div>
</div>
<div id="header-second-wrapper" class="header-second">
        <!-- Breadcrumbs -->
    <div id="breadcrumb" class="clearfix"><nav class="breadcrumb-wrapper clearfix" role="navigation" aria-labelledby="breadcrumb-label"><h2 id="breadcrumb-label" class="element-invisible">You are here</h2><ol id="crumbs" class="clearfix"><li class="crumb crumb-first"><span typeof="v:Breadcrumb"><a rel="v:url" property="v:title" href="http://community.atmel.com/">Home</a></span></li><li class="crumb"><span class="crumb-separator"> » </span><span typeof="v:Breadcrumb"><a rel="v:url" property="v:title" href="http://community.atmel.com/communities">Communities</a></span></li><li class="crumb"><span class="crumb-separator"> » </span><span typeof="v:Breadcrumb"><a rel="v:url" property="v:title" href="http://www.avrfreaks.net/">AVR Freaks</a></span></li><li class="crumb"><span class="crumb-separator"> » </span><span typeof="v:Breadcrumb"><a rel="v:url" property="v:title" href="http://www.avrfreaks.net/forum">Forums</a></span></li><li class="crumb"><span class="crumb-separator"> » </span><span typeof="v:Breadcrumb"><a rel="v:url" property="v:title" href="http://www.avrfreaks.net/forums/avr-microcontrollers">AVR Microcontrollers</a></span></li><li class="crumb"><span class="crumb-separator"> » </span><span typeof="v:Breadcrumb"><a rel="v:url" property="v:title" href="http://www.avrfreaks.net/forums/megaavr-and-tinyavr">megaAVR and tinyAVR</a></span></li><li class="crumb crumb-last"><span class="crumb-separator"> » </span><span typeof="v:Breadcrumb"><span property="v:title">Bootloader Pre-Tutorial Source Code - ATmega644</span></span></li></ol></nav></div>    </div>
<div id="page" class="container page">

  <div id="columns" class="columns clearfix">
    <!-- Messages and Help -->
    
    <!-- region: Secondary Content -->
    
    <div id="page-top">
            
          </div>
    <div id="content-column" class="content-column" role="main">
      <div class="content-inner">
        
        <!-- region: Highlighted -->
        
        <div id="main-content">

          <!-- region: Main Content -->
                      <div id="content" class="region">
                <div class="mobile-menu-bar">
                  <div id="menu-bar" class="nav clearfix"><div id="menu-bar" class="nav clearfix"><nav id="block-menu-menu-main-menu-mobile" class="block block-menu menu-wrapper menu-bar-wrapper clearfix odd first block-count-1 block-region-menu-bar block-menu-main-menu-mobile" role="navigation">  
      <h3 class="element-invisible block-title">Main menu mobile</h3>
  
  <ul class="menu clearfix"><li class="first leaf"><a href="http://www.avrfreaks.net/" class="thin">Home</a></li>
<li class="leaf"><a href="http://community.atmel.com/communities">Communities</a></li>
<li class="leaf"><a href="http://www.avrfreaks.net/forum" class="thin">Forums</a></li>
<li class="leaf"><a href="http://community.atmel.com/projects" class="thin">Projects</a></li>
<li class="leaf"><a href="http://community.atmel.com/vendors" class="thin">Vendors</a></li>
<li class="leaf"><a href="http://www.avrfreaks.net/wiki" class="thin">Wiki</a></li>
<li class="leaf"><a href="http://community.atmel.com/search/site" class="thick">Search</a></li>
<li class="leaf"><a href="http://community.atmel.com/user" class="thin">My summary</a></li>
<li class="leaf"><a href="http://www.atmel.com/About/privacy.aspx" class="thin" target="_blank">Privacy</a></li>
<li class="leaf"><a href="http://www.atmel.com/About/contact/distributors/default.aspx?contactType=Online%20Directory" class="thin" target="_blank">Contact</a></li>
<li class="leaf"><a href="http://www.atmel.com/About/legal.aspx" class="thin" target="_blank">Site Use Terms</a></li>
<li class="last leaf"><a href="http://www.atmel.com/About/cookies.aspx" class="thin" target="_blank">Cookies</a></li>
</ul>
  </nav><nav id="block-system-main-menu" class="block block-system block-menu no-title menu-wrapper menu-bar-wrapper clearfix even last block-count-2 block-region-menu-bar block-main-menu" role="navigation">  
  
  <ul class="menu clearfix"><li class="first leaf"><a href="http://community.atmel.com/communities">Communities</a></li>
<li class="leaf active-trail"><a href="http://www.avrfreaks.net/forum" class="active">Forums</a></li>
<li class="leaf"><a href="http://community.atmel.com/projects">Projects</a></li>
<li class="leaf"><a href="http://community.atmel.com/vendors">Vendors</a></li>
<li class="last leaf"><a href="http://www.avrfreaks.net/wiki/brief-history-artificial-intelligence" title="Wiki">WIKI</a></li>
</ul>
  </nav></div></div>                </div>
              <div class="one-column at-panel panel-display clearfix">
  <div class="region region-one-main">
    <div class="region-inner clearfix">
      <div class="panel-pane pane-node-title no-title block">
  <div class="block-inner clearfix">
    
            
    
    <div class="block-content">
      <h2>Bootloader Pre-Tutorial Source Code - ATmega644</h2>
    </div>

    
    
  </div>
</div>
<div class="panel-separator"></div><div class="panel-pane pane-node-content pane-commons-bw-group no-title block">
  <div class="block-inner clearfix">
    
            
    
    <div class="block-content">
        
<div id="forum-topic-header" class="forum-topic-header clearfix">
	
      <div class="topic-reply-link">
      <a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments    </div>
    
  
      <div class="last-post-link">
       <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=1#comment-357996" class="af-button-large active"><span>Go To Last Post</span></a>    </div>
    
      
  <div class="topic-post-count">
      <span>64 posts / 0 new</span>
  </div>
    
  <div class="topic-post-pager">
         </div>
    
  <a id="forum-topic-top"></a>
</div>

<a id="forum-topic-top"></a>
  <div class="forum-topic-hat clearfix">
    <div class="forum-hat-left-side">Author</div>
    <div class="forum-hat-right-side">Message</div>
  </div>
<div id="post-58300" class="forum-post clearfix en posted-by-38341 article odd node-full  " about="/forum/bootloader-pre-tutorial-source-code-atmega644" typeof="sioc:Post sioct:BoardPost" role="article">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><a href="http://community.atmel.com/users/smileymicros-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/smileymicros-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">smileymicros</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/smileymicros-0" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/picture-38341-1410020303.jpg" alt="smileymicros&#39;s picture" title="smileymicros&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Raving Lunatic              </div>
      <div class="forum-post-panel-joined">
                  Joined: Wed. Nov 17, 2004              </div>
      <div class="forum-post-panel-posts">
                  Posts: 6299 <a href="http://community.atmel.com/user/38341/content">View posts</a>              </div>
      <div class="forum-post-user-location">
                  Location: Great Smokey Mountains.              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644" class="active">#1</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/smileymicros-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/smileymicros-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">smileymicros</a></span>: </span>
              <span class="date-time">Sat. Mar 8, 2008 - 04:06 AM</span>                                        </div>
                          <div class="rating-widget">
                <div class="form-item form-type-item">
  <label>Fivestar widget </label>
 <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-f511f58110cea4cb9fcf6e5f041c5c9c rate-node-58300-3-3 rate-processed" id="rate-node-58300-3-3"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-251">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-252">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-253">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-254">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-255">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>
</div>
              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <div class="field field-name-body field-type-text-with-summary field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p>I'm in the midst of writing a Bootloader Tutorial for the Tutorials Forum and I've gotten a bootloader working in C for the ATmega644 that I wanted to post and let folks have at it before I get it committed to it an screw up some newbies who will try to learn about bootloaders by looking at it. I do know one problem, the USART code works, but uses some wrong constants that just happen to have the right value.</p>
<p>Anyway, I'd appreciate it if you guys would give 'er a look and critique'r before it gets set in concrete.</p>
<p>[edit]3/8/08 took mike and cliff's suggestions. Based on mikes suggestion, code size went from 2372 bytes to 1993 bytes so now it will fit in the 1024 word boot section! THANKS MIKE! Will investigate Cliff's suggestion about -nostdlib and nostartfiles later today. THANKS CLIFF![/edit]</p>
<p>[edit] 3/10/08 I've reduced the size for a minimum bootloader that still works with AVRProg and posted it on the second page of this thread, it is for the ATmega32 and is 912 bytes so it fits in the 512 word boot section.[/edit]</p>
<div class="bb-quote">
<blockquote class="bb-quote-body">
<pre>/*****************************************************
	RequiredText.c 3/7/08 Joe Pardue
******************************************************/

#include <avr io.h="" rel="nofollow">
#include <avr pgmspace.h="" rel="nofollow"> 
#include <avr boot.h="" rel="nofollow">
#include <avr interrupt.h="" rel="nofollow">

static void USARTInit();
static void sendByte( uint8_t );
static uint8_t receiveByte( void );
//static void sendBytePROGMEM(const uint8_t *);

static void AVR109CommandParser(void);

static void enterProgramMode(void);
static void autoIncrementAddress(void);
static void setAddress(void);
static void chipErase(void);
//static void leaveProgramMode(void);
static void selectDeviceType(void);
static void readSignatureBytes(void);
static void returnSupportedDeviceCodes(void);
static void returnSoftwareIdentifier(void);
static void returnSoftwareVersion(void);
static void returnProgrammerType(void);
static void setLED(void);
static void clearLED(void);
static void exitBootloader(void);
static void checkBlockSupport(void);
static void BlockLoad(uint16_t size, uint8_t type);
static void startBlockFlashLoad(uint16_t size);
static void startBlockEEPROMLoad(uint16_t size);
static void BlockRead(uint16_t size, uint8_t type);
static void startBlockFlashRead(uint16_t size);
static void startBlockEEPROMRead(uint16_t size);

//static void badAVR109Command(uint8_t);

//const uint8_t PM_badAVR109Command[] PROGMEM = "badAVR109Command\r";

#define	BOOT_STATE_PORT			PORTD
#define	BOOT_STATE_PIN			PIND
#define	BOOT_STATE_PIN_NUMBER	PD7  
 
//const uint8_t IS_BOOTLOADER[] PROGMEM = "IS the bootloader.\r";
//const uint8_t NOT_BOOTLOADER[] PROGMEM = "NOT the bootloader.\r";

uint16_t address;
uint8_t device;

#define SUPPORTED_DEVICE_CODE 	0x73

// Signature bytes for ATmega644
#define	SIGNATURE_BYTE_1		0x1E
#define	SIGNATURE_BYTE_2		0x96
#define	SIGNATURE_BYTE_3		0x09

// Function pointer to jump to the applicaion memory section
void (*funcptr)( void ) = 0x0000; 

#define BOOTSIZE 4096 // For test only

// SRAM Page buffer for flash page
uint8_t pageBuffer[SPM_PAGESIZE];

uint16_t address;

#define UART_RX_BUFFER_SIZE SPM_PAGESIZE
unsigned char gBuffer[UART_RX_BUFFER_SIZE];

int main(void)
{
	/* Function pointer to jump to the applicaion memory section */
    //void (*funcptr)( void ) = 0x0000;       

	//uint8_t b;

	USARTInit();

	// Use bootloader or application code?
    if( !(BOOT_STATE_PIN &amp; (1&lt;&lt;BOOT_STATE_PIN_NUMBER)) ) /* If BOOT_STATE_PIN_NUMBER is low, use bootloader. */
    {
		while(1)
		{
			// wait for esc character (0x1B) and respond with AVRBOOT
			if(receiveByte() == 0x1B)
			{
				// wait for software identifier request
				while( receiveByte() != 'S');
				
				// answer the request
				returnSoftwareIdentifier();
				
				// begin servicing the commands
				AVR109CommandParser();
			}
			else sendByte('?');
		}

	}
	else
	{
		// If BOOT_STATE_PIN_NUMBER is high, don't use bootloader.
		// So... jump to the application 
		funcptr();
	}

	return 0;
}

void AVR109CommandParser()
{
	uint8_t cmd;
	uint16_t tempSize;

	while(1)
	{
		cmd = receiveByte();

		switch (cmd)
		{
			case 'P':
				enterProgramMode();
				break;
			case 'a':
				autoIncrementAddress();
				break;
			case 'A':
				setAddress();
				break;
			case 'e':
				chipErase();	
				break;
			case 'L':
				enterProgramMode();
				break;
			case 'T':
				selectDeviceType();
				break;					
			case 's':
				readSignatureBytes();	
				break;			
			case 't':
				returnSupportedDeviceCodes();	
				break;
			case 'S':
				returnSoftwareIdentifier();	
				break;			
			case 'V':
				returnSoftwareVersion();	
				break;			
			case 'x':
				setLED();
				break;
			case 'y':
				clearLED();
				break;
			case 'p':
				returnProgrammerType();	
				break;			
			case 'E':
				exitBootloader();	
				break;
			case 'b':
				checkBlockSupport();	
				break;
			case 'B':
				tempSize = (receiveByte() &lt;&lt; 8) | receiveByte();
				BlockLoad( tempSize, receiveByte() );
				break;
			case 'g':
				tempSize = (receiveByte() &lt;&lt; 8) | receiveByte();
				BlockRead( tempSize, receiveByte() );	// Perform the block read
				break;									
			default:
				if(cmd != 0x1B) sendByte('?');
		}
	}
}	


/*****************************************************
	AVR109 Self Programming Commands
******************************************************/

void enterProgramMode() // 'P'
{
	// what else is it going to do?
	sendByte('\r');
}

void autoIncrementAddress(void) // 'a'
{ 
	// Yes, this code autoincrements
	sendByte('Y');
}

void setAddress(void) // 'A'
{ 
	// Note that flash addresses are in words, not bytes               
    address = receiveByte();   
	address = (address&lt;&lt;8) | receiveByte();
	address = address &lt;&lt; 1; // convert word address to byte address

 	sendByte('\r');  // respond okay
}

void chipErase(void) // 'e'
{ 
 	int i;
 	for(i = 0 ; i &lt; (FLASHEND - (BOOTSIZE * 2)); i += SPM_PAGESIZE)
	{
    	boot_page_erase(i);	// Erase the page
    	boot_spm_busy_wait();		// Wait until finished.
	}
   
	sendByte('\r');  // respond okay
}

/*void leaveProgramMode() // 'L'
{
	// what else is it going to do?
	sendByte('\r');
}*/

void selectDeviceType() // 'T'
{
	//dummy read since we only have one device type
	uint8_t dummy;
	dummy = receiveByte();
	sendByte('\r');
}

void readSignatureBytes(void) // 'S'
{ 
    sendByte( SIGNATURE_BYTE_3 );
    sendByte( SIGNATURE_BYTE_2 );
    sendByte( SIGNATURE_BYTE_1 );
}

void returnSupportedDeviceCodes(void) // 't'
{
	sendByte(SUPPORTED_DEVICE_CODE); // Support only this device
	sendByte(0); // list terminator
}

void returnSoftwareIdentifier(void) // 'S'
{ 
    // Software identifier is 'AVRBOOT'
	sendByte('A');
    sendByte('V'); 
    sendByte('R');
    sendByte('B');
    sendByte('O');
    sendByte('O');
    sendByte('T');
}

void returnSoftwareVersion(void) // 'V'
{ 
	// Return software version.
    sendByte('0');
    sendByte('1');
}

void setLED(void)
{
	// ignore command
	receiveByte();
	sendByte('r');
}

void clearLED(void)
{
	// ignore command
	receiveByte();
	sendByte('r');
}

void returnProgrammerType(void) // 'p'
{      
	// Get programmer type - serial.
    sendByte('S');
}

void exitBootloader(void)
{ 
	sendByte('\r');
    
	funcptr(); // jump to application
}

void checkBlockSupport(void) // 'b'
{ 
    sendByte('Y'); // yes, block load is supported.
    sendByte((SPM_PAGESIZE&gt;&gt;8) &amp; 0xFF); // send MSB first.
    sendByte(SPM_PAGESIZE &amp; 0xFF); // send LSB second.
}

void BlockLoad(uint16_t size, uint8_t type)
{ 
	if(type == 'F')
	{
		startBlockFlashLoad(size);// load flash
	}
	else if(type == 'E')
	{
		startBlockEEPROMLoad(size);// load EEPROM
	}
	else sendByte('?');
}

void startBlockEEPROMLoad(uint16_t size)
{ 
	if(size &lt;= SPM_PAGESIZE)
	{
		uint16_t i;
		for( i = 0 ; i &lt; size; i++)
		{
			pageBuffer[i] = receiveByte();
		}

		eeprom_write_block((const void*)pageBuffer,(void*)address,size);

		sendByte('\r');
	}
	else sendByte('?');
}

void startBlockFlashLoad(uint16_t size)
{ 
	uint16_t tempAddress = address;

	uint16_t i,cnt,tempWord;

	// store values to be programmed in temporary buffer
	for (cnt=0; cnt<uart_rx_buffer_size; cnt++)="" {="" if="" (cnt<size)="" pagebuffer[cnt]="receiveByte();" else="" }="" cnt="0;" boot_page_erase(address);="" perform="" page="" erase="" boot_spm_busy_wait();="" wait="" until="" the="" memory="" is="" erased.="" for(i="0;" i="" <="" size;="" i+="2)" tempword="pageBuffer[i];" load="" little="" end="" then="" increment="" +="(pageBuffer[i+1]" &lt;&lt;="" 8);="" big="" boot_page_fill(address,tempword);="" address="address" 2;="" word="" boot_page_write(tempaddress);="" boot_rww_enable();="" re-enable="" rww="" section="" sendbyte('\r');="" void="" blockread(uint16_t="" size,="" uint8_t="" type)="" if(type="=" 'f')="" startblockflashread(size);="" read="" flash="" 'e')="" startblockeepromread(size);="" eeprom="" sendbyte('?');="" startblockeepromread(uint16_t="" size)="" uint16_t="" tempaddress="address;" do="" sendbyte(eeprom_read_byte((const="" *)="" tempaddress++));="" while="" (--size);="" repeat="" size=""> 0


}
void startBlockFlashRead(uint16_t size)
{ 
	uint8_t data;
	do {
		data = pgm_read_byte_near(address++);	// read_program_memory(address,0x00);
		sendByte(data);			   				// send byte
		size--;							// reduce number of bytes to read by one
	} while (size);						// loop through size
}

/*void badAVR109Command(uint8_t cmd)
{
	// return the bad command with an error message
	sendBytePROGMEM(PM_badAVR109Command);
	sendByte(cmd);
}*/


/*****************************************************
	Functions from UART_Test
******************************************************/

void USARTInit()
{
	/* Set baud rate hard coded to 19200 for 12MHz */
	UBRR0L = 38;
	/* Enable receiver and transmitter */
	UCSR0B = (1&lt;&lt;RXEN0)|(1&lt;&lt;TXEN0);
	/* Set frame format: n,8,1 */
	UCSRC |= (1 &lt;&lt; URSEL) | (1 &lt;&lt; UCSZ0) | (1 &lt;&lt; UCSZ1); // Use 8-bit character sizes 
}

void sendByte( uint8_t data )
{
	/* Wait for empty transmit buffer */
	while ( !( UCSR0A &amp; (1&lt;&lt;UDRE0)) )
	;
	/* Put data into buffer, sends the data */
	UDR0 = data;
}

uint8_t receiveByte( void )
{
	// Wait for data to be received 
	while ( !(UCSR0A &amp; (1&lt;&lt;RXC0)) )
	;
	// Get and return received data from buffer 
	return UDR0;
}

/*void sendBytePROGMEM(const uint8_t *FlashString)
{
	int i = 0;

	// The 'for' logic terminates if the byte is '\0' or if i = 60.
	// '\0' is 'null' and terminates C strings
	// The 80 prevents too much overrun if we get a bad pointer
	// and it limits the string size	
	for( i = 0 ; pgm_read_byte(&amp;FlashString[i]) &amp;&amp; i &lt; 80; i++) 
	{
			sendByte(pgm_read_byte(&amp;FlashString[i]));
	}
} */
</uart_rx_buffer_size;></avr></avr></avr></avr></pre></blockquote>
</div>
<p>[edit] This is curtvm's suggestion (below in the thread) for the makefile:<br>
</p><div class="bb-quote">Quote:<blockquote class="bb-quote-body">Its simple to change in AVR Studio, (assuming mega164 here with 1024word bl) Project-&gt;Configuration Options-&gt;Memory Settings-&gt;Add-&gt;Memory Type: Flash, Name: .text, Address (Hex): 0x1C00 (that's a word address here). </blockquote></div> This if for the ATmega32 for the ATmega644 you need to set the address to 0x7C00.<p></p>
<p>[/edit] changed UCSRC setting</p>
</div></div></div><span property="dc:title" content="Bootloader Pre-Tutorial Source Code - ATmega644" class="rdf-meta"></span>        </div>
                                          <div class="post-tags">
            <h2 class="field-label">Tags:</h2><div class="topic-comments-tags"><a href="http://community.atmel.com/search/site?f[0]=im_taxonomy_forums%3A968&amp;f[1]=bundle%3Aforum">AVR Microcontrollers</a>, <a href="http://community.atmel.com/search/site?f[0]=im_taxonomy_forums%3A591&amp;f[1]=bundle%3Aforum">megaAVR and tinyAVR</a>, <a href="http://community.atmel.com/search/site?f[0]=im_field_avr_forum_devices%3A846&amp;f[1]=bundle%3Aforum">ATmega16</a>, <a href="http://community.atmel.com/search/site?f[0]=im_field_avr_forum_devices%3A870&amp;f[1]=bundle%3Aforum">ATmega32</a>, <a href="http://community.atmel.com/search/site?f[0]=im_field_avr_forum_devices%3A899&amp;f[1]=bundle%3Aforum">ATmega64</a>, <a href="http://community.atmel.com/search/site?f[0]=im_field_avr_forum_devices%3A901&amp;f[1]=bundle%3Aforum">ATmega644</a></div>          </div>
              </div>
    </div>
          <div class="post-update">
        Last Edited: <span class="date-time">Tue. Mar 2, 2010 - 11:33 PM</span>      </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline node-action-links"><li class="comment_forbidden first last"><span class=""><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-f/m">Log in</a> / <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-f/m">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<div id="forum-comments" class="comment-wrapper">
  <a id="comment-348541"></a>

<a id="forum-topic-top"></a>
<div id="post-348541" class="forum-post clearfix en posted-by-221489 odd first comment-with-picture comment-with-signature  " about="/comment/348541#comment-348541" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><a href="http://community.atmel.com/users/mikeperks" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/mikeperks" typeof="sioc:UserAccount" property="foaf:name" datatype="">mikeperks</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/mikeperks" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/1242546424473df73d086ea_3.gif" alt="mikeperks&#39;s picture" title="mikeperks&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Hangaround              </div>
      <div class="forum-post-panel-joined">
                  Joined: Tue. Nov 6, 2007              </div>
      <div class="forum-post-panel-posts">
                  Posts: 181 <a href="http://community.atmel.com/user/221489/content">View posts</a>              </div>
      <div class="forum-post-user-location">
                  Location: Austin, TX              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/348541#comment-348541" class="permalink" rel="bookmark">#2</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/mikeperks" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/mikeperks" typeof="sioc:UserAccount" property="foaf:name" datatype="">mikeperks</a></span>: </span>
              <span class="date-time">Sat. Mar 8, 2008 - 05:18 AM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-239e7a813fac3b437495af94ecd75746 rate-comment-348541-3-3 rate-processed" id="rate-comment-348541-3-3--2"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-256">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-257">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-258">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-259">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-260">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p>The code looks ok from a quick code scan - i.e. all the right pieces. I would put a BSD source code license at the top of the file and add a lot more comments to show what is going on especially as this is a tutorial.</p>
<p>You didn't supply a Makefile so I reused one I had and WinAVR 20071221. I got two warnings that should be eliminated:<br>
</p><div class="bb-quote">
<blockquote class="bb-quote-body">
<pre>boot.c:10: warning: function declaration isn't a prototype
boot.c:410: warning: function declaration isn't a prototype</pre></blockquote>
</div>
<p>One key aspect of bootloaders is the elimination of extra code such as the vector table and various other startup overheads. If you make all of the functions static or inline, it is harder to read the LSS file or debug but saves 300 bytes.</p>
<p>After making all the functions static I get the additional warning:<br>
</p><div class="bb-quote">
<blockquote class="bb-quote-body">
<pre>boot.c:223: warning: 'leaveProgramMode' defined but not used</pre></blockquote>
</div>
<p>The following line is repeated:<br>
</p><div class="bb-quote">
<blockquote class="bb-quote-body">
<pre>static void (*funcptr)( void ) = 0x0000;</pre></blockquote>
</div>
<p>Does your tutorial start off with code that can be run as a simple application and is then incrementally added too, moved to the bootloader section of flash, then tuned for code space? That is one way to develop a bootloader. </p>
<p>Are you planning to mention how other download protocols could be used instead of AVR109?</p>
<p>I think a baud rate friendly frequency is better than 12 MHz. You should also remove the hardcoded UBRR0L value and use the standard macro.</p>
<p>I have a 644 in my parts box but haven't had a chance to actually test your code.</p>
</div></div></div><span property="foaf:name" content="mikeperks" class="rdf-meta"></span>        </div>
                                  <div class="author-signature">
            <p>--Mike</p>
          </div>
                      </div>
    </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<a id="comment-348609"></a>

<a id="forum-topic-top"></a>
<div id="post-348609" class="forum-post clearfix en posted-by-28397 even comment-with-picture comment-with-signature  " about="/comment/348609#comment-348609" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><a href="http://community.atmel.com/users/clawson" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/clawson" typeof="sioc:UserAccount" property="foaf:name" datatype="">clawson</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/clawson" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/picture-28397-1406891613.gif" alt="clawson&#39;s picture" title="clawson&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Moderator              </div>
      <div class="forum-post-panel-joined">
                  Joined: Mon. Jul 18, 2005              </div>
      <div class="forum-post-panel-posts">
                  Posts: 81900 <a href="http://community.atmel.com/user/28397/content">View posts</a>              </div>
      <div class="forum-post-user-location">
                  Location: (using avr-gcc in) Finchingfield, Essex, England              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/348609#comment-348609" class="permalink" rel="bookmark">#3</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/clawson" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/clawson" typeof="sioc:UserAccount" property="foaf:name" datatype="">clawson</a></span>: </span>
              <span class="date-time">Sat. Mar 8, 2008 - 03:04 PM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-21d0ba40755587a3cce2eae8856a2f65 rate-comment-348609-3-3 rate-processed" id="rate-comment-348609-3-3--2"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-261">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-262">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-263">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-264">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-265">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p>If the code can work without relying on the globals being zeroed in the preamble then try adding -nostdlib to the link options which will drop the vector table and the C preamble. But you will need to add just a little bit of asm near the start to make sure _zero_reg__ contains 0 and the SP is initialised. Alternatively look at the effect of -nostartfiles which is similar.</p>
<p>(I explained how I used these (and worked around what they don't deliver) in the "smallest bootloader" thread)</p>
<p>BTW, like Mike says, funcptr is defined twice. As the global copy is not used (and appears to be the only .data/.bss entry that might rely on being 0) then ditch that and use the automatic copy inside main()</p>
</div></div></div><span property="foaf:name" content="clawson" class="rdf-meta"></span>        </div>
                                  <div class="author-signature">
            <p><a href="http://www.nongnu.org/avr-libc/user-manual/FAQ.html" target="_blank" rel="nofollow"><img alt="" class="attr__format__default attr__typeof__foaf:Image image-style-none img__fid__251241 img__view_mode__default media-image" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/faq_0.jpg"></a></p>
          </div>
                      </div>
    </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<a id="comment-348631"></a>

<a id="forum-topic-top"></a>
<div id="post-348631" class="forum-post clearfix en posted-by-38341 post-by-starter odd comment-with-picture  " about="/comment/348631#comment-348631" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><a href="http://community.atmel.com/users/smileymicros-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/smileymicros-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">smileymicros</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/smileymicros-0" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/picture-38341-1410020303.jpg" alt="smileymicros&#39;s picture" title="smileymicros&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Raving Lunatic              </div>
      <div class="forum-post-panel-joined">
                  Joined: Wed. Nov 17, 2004              </div>
      <div class="forum-post-panel-posts">
                  Posts: 6299 <a href="http://community.atmel.com/user/38341/content">View posts</a>              </div>
      <div class="forum-post-user-location">
                  Location: Great Smokey Mountains.              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/348631#comment-348631" class="permalink" rel="bookmark">#4</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/smileymicros-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/smileymicros-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">smileymicros</a></span>: </span>
              <span class="date-time">Sat. Mar 8, 2008 - 04:29 PM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-e2ec0dbf7e0a4d103938792d0d708453 rate-comment-348631-3-3 rate-processed" id="rate-comment-348631-3-3--2"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-266">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-267">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-268">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-269">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-270">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p></p><div class="bb-quote"><b>mikeperks wrote:</b><blockquote class="bb-quote-body">The code looks ok from a quick code scan - i.e. all the right pieces. I would put a BSD source code license at the top of the file and add a lot more comments to show what is going on especially as this is a tutorial.</blockquote></div> I will havea lot more comments, especially in the text of the tutorial which will elaborate each section of the code. I personally don't see the value of a license of any sort since this will be in the public domain and I really don't care how it is used. Why take up the space?<p></p>
<p></p><div class="bb-quote"><b>mikeperks wrote:</b><blockquote class="bb-quote-body">You didn't supply a Makefile so I reused one I had and WinAVR 20071221. I got two warnings that should be eliminated:<br>
<div class="bb-quote">
<blockquote class="bb-quote-body">
<pre>boot.c:10: warning: function declaration isn't a prototype
boot.c:410: warning: function declaration isn't a prototype</pre></blockquote>
</div>
<p></p></blockquote></div>Added the makefile, more details on using it in the tutorial.<p></p>
<p></p><div class="bb-quote"><b>mikeperks wrote:</b><blockquote class="bb-quote-body"><br>
One key aspect of bootloaders is the elimination of extra code such as the vector table and various other startup overheads. If you make all of the functions static or inline, it is harder to read the LSS file or debug but saves 300 bytes.</blockquote></div><br>
THANKS, SEE BELOW!<p></p>
<p></p><div class="bb-quote"><b>mikeperks wrote:</b><blockquote class="bb-quote-body"><br>
After making all the functions static I get the additional warning:<br>
<div class="bb-quote">
<blockquote class="bb-quote-body">
<pre>boot.c:223: warning: 'leaveProgramMode' defined but not used</pre></blockquote>
</div>
<p>The following line is repeated:<br>
</p><div class="bb-quote">
<blockquote class="bb-quote-body">
<pre>static void (*funcptr)( void ) = 0x0000;</pre></blockquote>
</div>
<p></p></blockquote></div> Got rid of them.<p></p>
<p></p><div class="bb-quote"><b>mikeperks wrote:</b><blockquote class="bb-quote-body"><br>
Does your tutorial start off with code that can be run as a simple application and is then incrementally added too, moved to the bootloader section of flash, then tuned for code space? That is one way to develop a bootloader.<br>
</blockquote></div> The tutorial will start off with some very simple and progressively more complex discussion and code for flash and EEPROM.<p></p>
<p></p><div class="bb-quote"><b>mikeperks wrote:</b><blockquote class="bb-quote-body">Are you planning to mention how other download protocols could be used instead of AVR109?</blockquote></div>Nope. I plan to slowly build up the knowledge for an AVR109 bootloader and assume that if anyone makes it through that, they should be able to move forward on their own.<p></p>
<p></p><div class="bb-quote"><b>mikeperks wrote:</b><blockquote class="bb-quote-body">I think a baud rate friendly frequency is better than 12 MHz.</blockquote></div>I'm using my BBUSB thingee which provides the 12MHz clock and the power supply for the breadboard. And it works just fine at 19200 baud. <p></p>
<p></p><div class="bb-quote"><b>mikeperks wrote:</b><blockquote class="bb-quote-body">You should also remove the hardcoded UBRR0L value and use the standard macro.</blockquote></div>It's on my TODO list.<p></p>
<p></p><div class="bb-quote"><b>mikeperks wrote:</b><blockquote class="bb-quote-body">I have a 644 in my parts box but haven't had a chance to actually test your code.</blockquote></div>Hey, you saved me over 300 bytes, your contribution is major!<p></p>
<p>I made changes suggested by Mike and the code size went from 1186 words (requiring the 2046 word size boot section size) to 997 word meaning that I can now use the 1024 word boot section size thus saving 2048 bytes of memory space. I'm not in a smallest bootloader contest since I am opting for clarity over size in the tutorial, but a whoping 2048 byte saving is a great contribution - THANKS MIKE!</p>
<p>I'll look into Cliffs suggestion later today.</p>
</div></div></div><span property="foaf:name" content="smileymicros" class="rdf-meta"></span>        </div>
                                      </div>
    </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<a id="comment-348649"></a>

<a id="forum-topic-top"></a>
<div id="post-348649" class="forum-post clearfix en posted-by-54542 even comment-with-picture  " about="/comment/348649#comment-348649" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><img src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/offline.png"><a href="http://community.atmel.com/users/dbc" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/dbc" typeof="sioc:UserAccount" property="foaf:name" datatype="">dbc</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/dbc" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/picture-default.jpg" alt="dbc&#39;s picture" title="dbc&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Resident              </div>
      <div class="forum-post-panel-joined">
                  Joined: Sat. Jul 8, 2006              </div>
      <div class="forum-post-panel-posts">
                  Posts: 503 <a href="http://community.atmel.com/user/54542/content">View posts</a>              </div>
      <div class="forum-post-user-location">
                  Location: Sunnyvale, CA              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/348649#comment-348649" class="permalink" rel="bookmark">#5</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/dbc" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/dbc" typeof="sioc:UserAccount" property="foaf:name" datatype="">dbc</a></span>: </span>
              <span class="date-time">Sat. Mar 8, 2008 - 05:45 PM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-25de732760ea8312ef68b65f32caf4f9 rate-comment-348649-3-3 rate-processed" id="rate-comment-348649-3-3--2"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-271">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-272">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-273">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-274">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-275">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p></p><div class="bb-quote">Quote:<blockquote class="bb-quote-body">I personally don't see the value of a license of any sort since this will be in the public domain and I really don't care how it is used. Why take up the space? </blockquote></div><br>
Public domain works just as well as a BSD license, it's just that right now there isn't anything in the comments indicating anything. In modern copyright law, simply by writing it you have a copyright.  Unless you explicitly license it or put in a statement placing it in the public domain, nothing gives the rest of us a legal right to use it.  Of course, you probably already know all this, but I'm borrowing your soap box inform those that might not.<p></p>
<p>Back on topic... I'm just starting to study the internals of bootloaders seriously for the first time, so this is very timely and I've already learned a lot.  Should be a great tutorial.  More comments when I give the code a thorough study.</p>
</div></div></div><span property="foaf:name" content="dbc" class="rdf-meta"></span>        </div>
                                      </div>
    </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<a id="comment-348651"></a>

<a id="forum-topic-top"></a>
<div id="post-348651" class="forum-post clearfix en posted-by-38341 post-by-starter odd comment-with-picture  " about="/comment/348651#comment-348651" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><a href="http://community.atmel.com/users/smileymicros-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/smileymicros-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">smileymicros</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/smileymicros-0" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/picture-38341-1410020303.jpg" alt="smileymicros&#39;s picture" title="smileymicros&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Raving Lunatic              </div>
      <div class="forum-post-panel-joined">
                  Joined: Wed. Nov 17, 2004              </div>
      <div class="forum-post-panel-posts">
                  Posts: 6299 <a href="http://community.atmel.com/user/38341/content">View posts</a>              </div>
      <div class="forum-post-user-location">
                  Location: Great Smokey Mountains.              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/348651#comment-348651" class="permalink" rel="bookmark">#6</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/smileymicros-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/smileymicros-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">smileymicros</a></span>: </span>
              <span class="date-time">Sat. Mar 8, 2008 - 05:56 PM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-1060d91397f3f6b401a67b2575e8b698 rate-comment-348651-3-3 rate-processed" id="rate-comment-348651-3-3--2"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-276">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-277">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-278">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-279">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-280">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p>Since I did this originally with a boot size of 4096, not knowing how large it would actually be, and Mike gave me the way to reduce it so that it will now fit in the 1024 section, the following procedure will convert the code and AVRStudio to the smaller bootsize:</p>
<div class="bb-quote">
<blockquote class="bb-quote-body">
<pre>Changes bootloader size from 4096 to 1024

1.In the AVR Programmer window fuses tab
     a.From: Boot Flash size= 4096
     b.To: BootFlash size=1024
2.In makefileboot change
     a.From: LDFLAGS += -Wl,-section-start=.text=0xE000
     b.To: LDFLAGS += -Wl,-section-start=.text=0xFC00
3.Change BOOTSIZE 
     a.From: #define BOOTSIZE 4086 // For test only
     b.To: #define BOOTSIZE 1024 // For test only
</pre></blockquote>
</div>
<p>Smiley</p>
</div></div></div><span property="foaf:name" content="smileymicros" class="rdf-meta"></span>        </div>
                                      </div>
    </div>
          <div class="post-update">
        Last Edited: <span class="date-time">Sat. Mar 8, 2008 - 06:05 PM</span>      </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<a id="comment-348653"></a>

<a id="forum-topic-top"></a>
<div id="post-348653" class="forum-post clearfix en posted-by-38341 post-by-starter even comment-with-picture  " about="/comment/348653#comment-348653" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><a href="http://community.atmel.com/users/smileymicros-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/smileymicros-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">smileymicros</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/smileymicros-0" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/picture-38341-1410020303.jpg" alt="smileymicros&#39;s picture" title="smileymicros&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Raving Lunatic              </div>
      <div class="forum-post-panel-joined">
                  Joined: Wed. Nov 17, 2004              </div>
      <div class="forum-post-panel-posts">
                  Posts: 6299 <a href="http://community.atmel.com/user/38341/content">View posts</a>              </div>
      <div class="forum-post-user-location">
                  Location: Great Smokey Mountains.              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/348653#comment-348653" class="permalink" rel="bookmark">#7</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/smileymicros-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/smileymicros-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">smileymicros</a></span>: </span>
              <span class="date-time">Sat. Mar 8, 2008 - 05:59 PM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-c4d6a2db70928e38187b9ed5f1c9dcfc rate-comment-348653-3-3 rate-processed" id="rate-comment-348653-3-3--2"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-281">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-282">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-283">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-284">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-285">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p></p><div class="bb-quote"><b>dbc wrote:</b><blockquote class="bb-quote-body"><div class="bb-quote">Quote:<blockquote class="bb-quote-body">I personally don't see the value of a license of any sort since this will be in the public domain and I really don't care how it is used. Why take up the space? </blockquote></div><br>
Public domain works just as well as a BSD license, it's just that right now there isn't anything in the comments indicating anything. In modern copyright law, simply by writing it you have a copyright.  Unless you explicitly license it or put in a statement placing it in the public domain, nothing gives the rest of us a legal right to use it.  Of course, you probably already know all this, but I'm borrowing your soap box inform those that might not.<p></p>
<p>Back on topic... I'm just starting to study the internals of bootloaders seriously for the first time, so this is very timely and I've already learned a lot.  Should be a great tutorial.  More comments when I give the code a thorough study.</p></blockquote></div>Okay, I'll have to give this some thought since I didn't realize that by not having the license rigramrole that I was actually copyrighting the stuff. So let me add this to my plate and see what I can come up with. <p></p>
<p>Smiley</p>
</div></div></div><span property="foaf:name" content="smileymicros" class="rdf-meta"></span>        </div>
                                      </div>
    </div>
          <div class="post-update">
        Last Edited: <span class="date-time">Sat. Mar 8, 2008 - 06:01 PM</span>      </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<a id="comment-348667"></a>

<a id="forum-topic-top"></a>
<div id="post-348667" class="forum-post clearfix en posted-by-202540 odd comment-with-picture  " about="/comment/348667#comment-348667" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><img src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/offline.png"><a href="http://community.atmel.com/users/unixwhore8034" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/unixwhore8034" typeof="sioc:UserAccount" property="foaf:name" datatype="">UNiXWHoRe</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/unixwhore8034" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/picture-default.jpg" alt="UNiXWHoRe&#39;s picture" title="UNiXWHoRe&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Posting Freak              </div>
      <div class="forum-post-panel-joined">
                  Joined: Fri. Nov 3, 2006              </div>
      <div class="forum-post-panel-posts">
                  Posts: 1118 <a href="http://community.atmel.com/user/202540/content">View posts</a>              </div>
      <div class="forum-post-user-location">
              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/348667#comment-348667" class="permalink" rel="bookmark">#8</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/unixwhore8034" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/unixwhore8034" typeof="sioc:UserAccount" property="foaf:name" datatype="">UNiXWHoRe</a></span>: </span>
              <span class="date-time">Sat. Mar 8, 2008 - 07:00 PM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-d388b46a33f11c8b091270fdb2f73a53 rate-comment-348667-3-3 rate-processed" id="rate-comment-348667-3-3--2"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-286">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-287">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-288">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-289">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-290">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p>Here is a BSD license template... Clause #3 is optional.</p>
<p></p><div class="bb-quote">Quote:<blockquote class="bb-quote-body"><br>
Software License Agreement (BSD License)<p></p>
<p>Copyright (c) <year>, <owner><br>
All rights reserved.</owner></year></p>
<p>Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</p>
<p>    * Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.<br>
    * Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.<br>
    * Neither the name of the <organization> nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</organization></p>
<p>THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.<br>
</p></blockquote></div><p></p>
</div></div></div><span property="foaf:name" content="UNiXWHoRe" class="rdf-meta"></span>        </div>
                                      </div>
    </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<a id="comment-348671"></a>

<a id="forum-topic-top"></a>
<div id="post-348671" class="forum-post clearfix en posted-by-221489 even comment-with-picture comment-with-signature  " about="/comment/348671#comment-348671" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><a href="http://community.atmel.com/users/mikeperks" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/mikeperks" typeof="sioc:UserAccount" property="foaf:name" datatype="">mikeperks</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/mikeperks" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/1242546424473df73d086ea_3.gif" alt="mikeperks&#39;s picture" title="mikeperks&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Hangaround              </div>
      <div class="forum-post-panel-joined">
                  Joined: Tue. Nov 6, 2007              </div>
      <div class="forum-post-panel-posts">
                  Posts: 181 <a href="http://community.atmel.com/user/221489/content">View posts</a>              </div>
      <div class="forum-post-user-location">
                  Location: Austin, TX              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/348671#comment-348671" class="permalink" rel="bookmark">#9</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/mikeperks" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/mikeperks" typeof="sioc:UserAccount" property="foaf:name" datatype="">mikeperks</a></span>: </span>
              <span class="date-time">Sat. Mar 8, 2008 - 07:11 PM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-83d30baa611cd02f4106696ceec96037 rate-comment-348671-3-3 rate-processed" id="rate-comment-348671-3-3--2"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-291">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-292">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-293">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-294">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-295">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p></p><div class="bb-quote"><b>smileymicros wrote:</b><blockquote class="bb-quote-body">Okay, I'll have to give this some thought since I didn't realize that by not having the license rigramrole that I was actually copyrighting the stuff. So let me add this to my plate and see what I can come up with.</blockquote></div>Not much to add really. <a href="http://en.wikipedia.org/wiki/BSD_license" class="bb-url" rel="nofollow">BSD</a> (or more strictly modified BSD) is a very open license that allows anyone to do anything with your code providing they preserve your original license. As dbc says, a license is important because it tells the rest of us who wrote the code and what we can do with it. Larger corporations (i.e. those with IP Lawyers) will not touch open source code unless it has the author names and a license. To save you some time, here is the BSD license text you could use:<br>
<div class="bb-quote">
<blockquote class="bb-quote-body">
<pre>/*
 *  BSD License
 *  -----------
 *
 *  Copyright (c) 2008, Smiley Micros, All rights reserved.
 *
 *  Redistribution and use in source and binary forms, with or without 
 *  modification, are permitted provided that the following conditions are met: 
 *
 *  - Redistributions of source code must retain the above copyright notice, 
 *    this list of conditions and the following disclaimer.  
 *	
 *  - Redistributions in binary form must reproduce the above copyright notice, 
 *    this list of conditions and the following disclaimer in the documentation 
 *    and/or other materials provided with the distribution.  
 *	
 *  - Neither the name of the Smiley Micros nor the names of its contributors 
 *    may be used to endorse or promote products derived from this software 
 *    without specific prior written permission.  
 *
 *  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" 
 *  AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE 
 *  IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE 
 *  ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE 
 *  LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR 
 *  CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF 
 *  SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS 
 *  INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN 
 *  CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) 
 *  ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE 
 *  POSSIBILITY OF SUCH DAMAGE.
 */</pre></blockquote>
</div>
<p>It's the same as the one I use for Oak Micros except I replaced "Oak" by "Smiley". You may also want to put the author name in the header as well in the same place as the description of the source file.</p>
</div></div></div><span property="foaf:name" content="mikeperks" class="rdf-meta"></span>        </div>
                                  <div class="author-signature">
            <p>--Mike</p>
          </div>
                      </div>
    </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<a id="comment-348675"></a>

<a id="forum-topic-top"></a>
<div id="post-348675" class="forum-post clearfix en posted-by-23145 odd comment-with-picture comment-with-signature  " about="/comment/348675#comment-348675" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><a href="http://community.atmel.com/users/microcarl" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/microcarl" typeof="sioc:UserAccount" property="foaf:name" datatype="">microcarl</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/microcarl" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/picture-23145-1420410442.jpg" alt="microcarl&#39;s picture" title="microcarl&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Raving Lunatic              </div>
      <div class="forum-post-panel-joined">
                  Joined: Sun. May 30, 2004              </div>
      <div class="forum-post-panel-posts">
                  Posts: 8312 <a href="http://community.atmel.com/user/23145/content">View posts</a>              </div>
      <div class="forum-post-user-location">
                  Location: Cincinnati, Ohio               </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/348675#comment-348675" class="permalink" rel="bookmark">#10</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/microcarl" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/microcarl" typeof="sioc:UserAccount" property="foaf:name" datatype="">microcarl</a></span>: </span>
              <span class="date-time">Sat. Mar 8, 2008 - 07:50 PM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-a093e16871b10091dbb00a569be47aac rate-comment-348675-3-3 rate-processed" id="rate-comment-348675-3-3--2"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-296">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-297">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-298">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-299">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-300">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p>Is there a copyright on the use of copyright agreements?</p>
<p>It seems that some lawyer would have figured he/she could make a buck on copyrighting the copyright of a copyright, etc. by now.</p>
<p>It seems that copyrights get tossed around awfully freely.</p>
</div></div></div><span property="foaf:name" content="microcarl" class="rdf-meta"></span>        </div>
                                  <div class="author-signature">
            <p><strong><em>You can avoid reality, for a while.&nbsp; But you can't avoid the consequences of reality!</em></strong> - C.W. Livingston</p>
          </div>
                      </div>
    </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<a id="comment-348676"></a>

<a id="forum-topic-top"></a>
<div id="post-348676" class="forum-post clearfix en posted-by-202540 even comment-with-picture  " about="/comment/348676#comment-348676" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><img src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/offline.png"><a href="http://community.atmel.com/users/unixwhore8034" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/unixwhore8034" typeof="sioc:UserAccount" property="foaf:name" datatype="">UNiXWHoRe</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/unixwhore8034" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/picture-default.jpg" alt="UNiXWHoRe&#39;s picture" title="UNiXWHoRe&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Posting Freak              </div>
      <div class="forum-post-panel-joined">
                  Joined: Fri. Nov 3, 2006              </div>
      <div class="forum-post-panel-posts">
                  Posts: 1118 <a href="http://community.atmel.com/user/202540/content">View posts</a>              </div>
      <div class="forum-post-user-location">
              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/348676#comment-348676" class="permalink" rel="bookmark">#11</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/unixwhore8034" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/unixwhore8034" typeof="sioc:UserAccount" property="foaf:name" datatype="">UNiXWHoRe</a></span>: </span>
              <span class="date-time">Sat. Mar 8, 2008 - 07:59 PM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-19d02f942a4813bac709710d4237daa4 rate-comment-348676-3-3 rate-processed" id="rate-comment-348676-3-3--2"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-301">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-302">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-303">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-304">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-305">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p>This is not really a copyright, merely an agreement that the software is open source and available to everybody for commercial or personal use, with or without modifications. It also protects smiley from potential civil actions if the bootloader was defective in some way, and for example of it was installed in some medical equipment and caused injuries.</p>
<p>The BSD license is free to use I believe.</p>
</div></div></div><span property="foaf:name" content="UNiXWHoRe" class="rdf-meta"></span>        </div>
                                      </div>
    </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<a id="comment-348678"></a>

<a id="forum-topic-top"></a>
<div id="post-348678" class="forum-post clearfix en posted-by-46490 odd comment-with-picture comment-with-signature  " about="/comment/348678#comment-348678" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><img src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/offline.png"><a href="http://community.atmel.com/users/barnacle-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/barnacle-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">barnacle</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/barnacle-0" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/105642177043ee65e3002ea_3.jpg" alt="barnacle&#39;s picture" title="barnacle&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Raving Lunatic              </div>
      <div class="forum-post-panel-joined">
                  Joined: Tue. Jan 3, 2006              </div>
      <div class="forum-post-panel-posts">
                  Posts: 4970 <a href="http://community.atmel.com/user/46490/content">View posts</a>              </div>
      <div class="forum-post-user-location">
                  Location: Hemel Hemsptead, UK              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/348678#comment-348678" class="permalink" rel="bookmark">#12</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/barnacle-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/barnacle-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">barnacle</a></span>: </span>
              <span class="date-time">Sat. Mar 8, 2008 - 08:10 PM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-015be2436f531de810508c8765764521 rate-comment-348678-3-3 rate-processed" id="rate-comment-348678-3-3--2"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-306">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-307">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-308">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-309">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-310">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p>Copyright exists as soon as the work is created. A licence tells people what they may do with it, and makes it explicit. You (as copyright holder) can change the licence terms at any time; from completely forbidden for use to completely open, and you can have different terms for different people.</p>
</div></div></div><span property="foaf:name" content="barnacle" class="rdf-meta"></span>        </div>
                                  <div class="author-signature">
            <p>Neil Barnes<br>
<a href="http://www.nailed-barnacle.co.uk/" target="_blank">www.nailed-barnacle.co.uk</a></p>
          </div>
                      </div>
    </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<a id="comment-348702"></a>

<a id="forum-topic-top"></a>
<div id="post-348702" class="forum-post clearfix en posted-by-1007 even comment-with-picture comment-with-signature  " about="/comment/348702#comment-348702" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><a href="http://community.atmel.com/users/js" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/js" typeof="sioc:UserAccount" property="foaf:name" datatype="">js</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/js" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/picture-1007-1406680492.jpg" alt="js&#39;s picture" title="js&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Moderator              </div>
      <div class="forum-post-panel-joined">
                  Joined: Wed. Mar 28, 2001              </div>
      <div class="forum-post-panel-posts">
                  Posts: 25219 <a href="http://community.atmel.com/user/1007/content">View posts</a>              </div>
      <div class="forum-post-user-location">
                  Location: Sydney, Australia (Gum trees, Koalas and Kangaroos, No Edelweiss)              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/348702#comment-348702" class="permalink" rel="bookmark">#13</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/js" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/js" typeof="sioc:UserAccount" property="foaf:name" datatype="">js</a></span>: </span>
              <span class="date-time">Sat. Mar 8, 2008 - 10:57 PM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-f1cf02c3b5babbb87f19839a9f1efb83 rate-comment-348702-3-3 rate-processed" id="rate-comment-348702-3-3--2"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-311">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-312">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-313">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-314">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-315">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p>It should be able to run easily with a M324p right? Still waiting for some M644p to come in.</p>
<p>Oh, and of course it is to be used with USART0? (M644 has just 1 USART M644P has 2 AFAIK)</p>
</div></div></div><span property="foaf:name" content="js" class="rdf-meta"></span>        </div>
                                  <div class="author-signature">
            <p>John Samperi</p>
<p>Ampertronics Pty. Ltd.</p>
<p><a href="http://www.ampertronics.com.au/" target="_blank">www.ampertronics.com.au</a></p>
<p>* Electronic Design * Custom Products * Contract Assembly</p>
          </div>
                      </div>
    </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<a id="comment-348707"></a>

<a id="forum-topic-top"></a>
<div id="post-348707" class="forum-post clearfix en posted-by-38341 post-by-starter odd comment-with-picture  " about="/comment/348707#comment-348707" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><a href="http://community.atmel.com/users/smileymicros-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/smileymicros-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">smileymicros</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/smileymicros-0" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/picture-38341-1410020303.jpg" alt="smileymicros&#39;s picture" title="smileymicros&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Raving Lunatic              </div>
      <div class="forum-post-panel-joined">
                  Joined: Wed. Nov 17, 2004              </div>
      <div class="forum-post-panel-posts">
                  Posts: 6299 <a href="http://community.atmel.com/user/38341/content">View posts</a>              </div>
      <div class="forum-post-user-location">
                  Location: Great Smokey Mountains.              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/348707#comment-348707" class="permalink" rel="bookmark">#14</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/smileymicros-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/smileymicros-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">smileymicros</a></span>: </span>
              <span class="date-time">Sat. Mar 8, 2008 - 11:06 PM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-5268815f564776fe3270111505ddf0b9 rate-comment-348707-3-3 rate-processed" id="rate-comment-348707-3-3--2"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-316">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-317">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-318">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-319">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-320">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p></p><div class="bb-quote"><b>js wrote:</b><blockquote class="bb-quote-body">It should be able to run easily with a M324p right? Still waiting for some M644p to come in.<p></p>
<p>Oh, and of course it is to be used with USART0? (M644 has just 1 USART M644P has 2 AFAIK)</p></blockquote></div><p></p>
<p>I would hope so. I tried to port it to the ATmega32 and everything went nuts, so I ate a bacon sandwich and took a nap. Now I'm about to go for a walk and I'll think about attacking it again tomorrow. </p>
<p>Anyway, if it does work on the ATmega324p, I'd appreciate a note as to what you had to change and/or any other comments you'd like to make.</p>
<p>Thanks,<br>
Smiley</p>
</div></div></div><span property="foaf:name" content="smileymicros" class="rdf-meta"></span>        </div>
                                      </div>
    </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<a id="comment-348724"></a>

<a id="forum-topic-top"></a>
<div id="post-348724" class="forum-post clearfix en posted-by-1007 even comment-with-picture comment-with-signature  " about="/comment/348724#comment-348724" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><a href="http://community.atmel.com/users/js" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/js" typeof="sioc:UserAccount" property="foaf:name" datatype="">js</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/js" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/picture-1007-1406680492.jpg" alt="js&#39;s picture" title="js&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Moderator              </div>
      <div class="forum-post-panel-joined">
                  Joined: Wed. Mar 28, 2001              </div>
      <div class="forum-post-panel-posts">
                  Posts: 25219 <a href="http://community.atmel.com/user/1007/content">View posts</a>              </div>
      <div class="forum-post-user-location">
                  Location: Sydney, Australia (Gum trees, Koalas and Kangaroos, No Edelweiss)              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/348724#comment-348724" class="permalink" rel="bookmark">#15</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/js" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/js" typeof="sioc:UserAccount" property="foaf:name" datatype="">js</a></span>: </span>
              <span class="date-time">Sun. Mar 9, 2008 - 12:34 AM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-d761582624295e3e29c98fa8126f80f8 rate-comment-348724-3-3 rate-processed" id="rate-comment-348724-3-3--2"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-321">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-322">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-323">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-324">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-325">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p>hmmm nothing like a dummie's input :lol: If I can break it, I will...and I have.</p>
<p>Just tried with a M164p because that's what I have on the bench now with a Dragon. So I did change the chip number in the makefile (will need to change the signature bytes too eventually) and nothing more.</p>
<p>I can get it to compile with a Studio generated makefile, which is not good of course as it puts things at 0x0000. Using the original makefile (pretending it was a M644) I get an error in line 50 (line 53 in my modified makefile which is attached)</p>
<div class="bb-quote">
<blockquote class="bb-quote-body">
<pre>## Compile 
Required_Test.o: ../Required_Test.c 
   $(CC) $(INCLUDES) $(CFLAGS) -c  $&lt; </pre></blockquote>
</div>
<p> last line</p>
<p>and it does not compile.</p>
<p>In order to preserve life and limb that's all I can do for the day I think...</p>
</div></div></div><section class="field field-name-field-attach field-type-file field-label-above view-mode-full"><h2 class="field-label">Attachment(s):&nbsp;</h2><div class="field-items"><div class="field-item even"><span class="file"><img class="file-icon" alt="" title="text/plain" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/text-plain.png"> <a href="http://www.avrfreaks.net/sites/default/files/makefile.txt" type="text/plain; length=10331">makefile.txt</a></span></div></div></section>        </div>
                                  <div class="author-signature">
            <p>John Samperi</p>
<p>Ampertronics Pty. Ltd.</p>
<p><a href="http://www.ampertronics.com.au/" target="_blank">www.ampertronics.com.au</a></p>
<p>* Electronic Design * Custom Products * Contract Assembly</p>
          </div>
                      </div>
    </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<a id="comment-348748"></a>

<a id="forum-topic-top"></a>
<div id="post-348748" class="forum-post clearfix en posted-by-42662 odd comment-with-picture  " about="/comment/348748#comment-348748" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><img src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/offline.png"><a href="http://community.atmel.com/users/curtvm-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/curtvm-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">curtvm</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/curtvm-0" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/picture-default.jpg" alt="curtvm&#39;s picture" title="curtvm&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Raving Lunatic              </div>
      <div class="forum-post-panel-joined">
                  Joined: Wed. Sep 21, 2005              </div>
      <div class="forum-post-panel-posts">
                  Posts: 2328 <a href="http://community.atmel.com/user/42662/content">View posts</a>              </div>
      <div class="forum-post-user-location">
              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/348748#comment-348748" class="permalink" rel="bookmark">#16</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/curtvm-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/curtvm-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">curtvm</a></span>: </span>
              <span class="date-time">Sun. Mar 9, 2008 - 02:25 AM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-6299ed4053e008237b2752e2c4c342ce rate-comment-348748-3-3 rate-processed" id="rate-comment-348748-3-3--2"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-326">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-327">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-328">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-329">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-330">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p></p><div class="bb-quote">Quote:<blockquote class="bb-quote-body">which is not good of course as it puts things at 0x0000</blockquote></div>Its simple to change in AVR Studio, (assuming mega164 here with 1024word bl) Project-&gt;Configuration Options-&gt;Memory Settings-&gt;Add-&gt;Memory Type: Flash, Name: .text, Address (Hex): 0x1C00 (that's a word address here).<p></p>
<p>For mega16/32 types, you will need to change the usart defines (its macro time).</p>
<p>I have just compiled it (not tested) for mega164p, mega32, mega64, mega324p, mega168, and it compiles without error on all of them (a little macro work for the older usart types). I just let AVR Studio do the makefile work (as I always do- Cliff if still trying to convert me).</p>
</div></div></div><span property="foaf:name" content="curtvm" class="rdf-meta"></span>        </div>
                                      </div>
    </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<a id="comment-348761"></a>

<a id="forum-topic-top"></a>
<div id="post-348761" class="forum-post clearfix en posted-by-38341 post-by-starter even comment-with-picture  " about="/comment/348761#comment-348761" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><a href="http://community.atmel.com/users/smileymicros-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/smileymicros-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">smileymicros</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/smileymicros-0" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/picture-38341-1410020303.jpg" alt="smileymicros&#39;s picture" title="smileymicros&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Raving Lunatic              </div>
      <div class="forum-post-panel-joined">
                  Joined: Wed. Nov 17, 2004              </div>
      <div class="forum-post-panel-posts">
                  Posts: 6299 <a href="http://community.atmel.com/user/38341/content">View posts</a>              </div>
      <div class="forum-post-user-location">
                  Location: Great Smokey Mountains.              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/348761#comment-348761" class="permalink" rel="bookmark">#17</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/smileymicros-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/smileymicros-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">smileymicros</a></span>: </span>
              <span class="date-time">Sun. Mar 9, 2008 - 04:30 AM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-c5ca361eefe268aa8c7f89cebeaa3954 rate-comment-348761-3-3 rate-processed" id="rate-comment-348761-3-3--2"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-331">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-332">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-333">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-334">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-335">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p></p><div class="bb-quote"><b>curtvm wrote:</b><blockquote class="bb-quote-body"><div class="bb-quote">Quote:<blockquote class="bb-quote-body">which is not good of course as it puts things at 0x0000</blockquote></div>Its simple to change in AVR Studio, (assuming mega164 here with 1024word bl) Project-&gt;Configuration Options-&gt;Memory Settings-&gt;Add-&gt;Memory Type: Flash, Name: .text, Address (Hex): 0x1C00 (that's a word address here).<p></p>
<p>For mega16/32 types, you will need to change the usart defines (its macro time).</p>
<p>I have just compiled it (not tested) for mega164p, mega32, mega64, mega324p, mega168, and it compiles without error on all of them (a little macro work for the older usart types). I just let AVR Studio do the makefile work (as I always do- Cliff if still trying to convert me).</p></blockquote></div><p></p>
<p>Thanks for the pointer. This does create a makefile with the code located in the bootsection. I've buggered my hardware setup so I can't test it till tomorrow, but it looks like the way to do it. I guess I need to look at the new stuff in AVRStudio since I entirely missed that memory configuration feature.</p>
<p>Smiley</p>
</div></div></div><span property="foaf:name" content="smileymicros" class="rdf-meta"></span>        </div>
                                      </div>
    </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<a id="comment-348879"></a>

<a id="forum-topic-top"></a>
<div id="post-348879" class="forum-post clearfix en posted-by-38341 post-by-starter odd comment-with-picture  " about="/comment/348879#comment-348879" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><a href="http://community.atmel.com/users/smileymicros-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/smileymicros-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">smileymicros</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/smileymicros-0" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/picture-38341-1410020303.jpg" alt="smileymicros&#39;s picture" title="smileymicros&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Raving Lunatic              </div>
      <div class="forum-post-panel-joined">
                  Joined: Wed. Nov 17, 2004              </div>
      <div class="forum-post-panel-posts">
                  Posts: 6299 <a href="http://community.atmel.com/user/38341/content">View posts</a>              </div>
      <div class="forum-post-user-location">
                  Location: Great Smokey Mountains.              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/348879#comment-348879" class="permalink" rel="bookmark">#18</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/smileymicros-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/smileymicros-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">smileymicros</a></span>: </span>
              <span class="date-time">Sun. Mar 9, 2008 - 05:11 PM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-254b6b479f405459352a221cba195dbb rate-comment-348879-3-3 rate-processed" id="rate-comment-348879-3-3--2"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-336">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-337">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-338">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-339">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-340">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p>Okay! The curtvm makefile suggestion works so I've added that to the OP.</p>
<p>Smiley</p>
</div></div></div><span property="foaf:name" content="smileymicros" class="rdf-meta"></span>        </div>
                                      </div>
    </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<a id="comment-349026"></a>

<a id="forum-topic-top"></a>
<div id="post-349026" class="forum-post clearfix en posted-by-1007 even comment-with-picture comment-with-signature  " about="/comment/349026#comment-349026" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><a href="http://community.atmel.com/users/js" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/js" typeof="sioc:UserAccount" property="foaf:name" datatype="">js</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/js" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/picture-1007-1406680492.jpg" alt="js&#39;s picture" title="js&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Moderator              </div>
      <div class="forum-post-panel-joined">
                  Joined: Wed. Mar 28, 2001              </div>
      <div class="forum-post-panel-posts">
                  Posts: 25219 <a href="http://community.atmel.com/user/1007/content">View posts</a>              </div>
      <div class="forum-post-user-location">
                  Location: Sydney, Australia (Gum trees, Koalas and Kangaroos, No Edelweiss)              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/349026#comment-349026" class="permalink" rel="bookmark">#19</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/js" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/js" typeof="sioc:UserAccount" property="foaf:name" datatype="">js</a></span>: </span>
              <span class="date-time">Mon. Mar 10, 2008 - 03:57 AM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-a679358a921bf72591f0d818e93c963e rate-comment-349026-3-3 rate-processed" id="rate-comment-349026-3-3--2"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-341">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-342">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-343">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-344">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-345">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p>It's ALIVE!!!</p>
<p>After doing my favourite mods to the USART init (as I don't have the exact hardware) I can communicate with the bootloader. The USART init has the 2 Stop bits stuff still there like the other tutorial.</p>
<p>Added definition:<br>
</p><div class="bb-quote">
<blockquote class="bb-quote-body">
<pre>//define Baud rate
#define baud 19200</pre></blockquote>
</div>
<p>Modified USART init:<br>
</p><div class="bb-quote">
<blockquote class="bb-quote-body">
<pre>/***************************************************** 
   Functions from UART_Test 
******************************************************/ 

void USARTInit() 
{ 
   // Set baud rate

	UBRR0H = ((F_CPU / (16UL * baud)) - 1)&gt;&gt;8;
	UBRR0L = (F_CPU / (16UL * baud)) - 1;


   /* Enable receiver and transmitter */ 
   UCSR0B = (1&lt;&lt;RXEN0)|(1&lt;&lt;TXEN0); 
   
   /* Set frame format: 8data, 2stop bit */ //****************
  // UCSR0C = (1&lt;&lt;USBS0)|(3&lt;&lt;UCSZ00); 
} </pre></blockquote>
</div>
<p> The above will automatically set up the correct baud rate given "baud" and the clock, which gets sucked out the makefile.</p>
<p>If the bootloader is intended to be used in various chips, this becomes messy:<br>
</p><div class="bb-quote">
<blockquote class="bb-quote-body">
<pre>#define SUPPORTED_DEVICE_CODE    0x73 

// Signature bytes for ATmega644 
#define   SIGNATURE_BYTE_1      0x1E 
#define   SIGNATURE_BYTE_2      0x96 
#define   SIGNATURE_BYTE_3      0x09 </pre></blockquote>
</div>
<p> as it would need conditional compile depending on the micro.</p>
<p>I thought it would be easy enough to just get it from the chips' header file but not so!! The assembler header files have that information in them as:<br>
</p><div class="bb-quote">
<blockquote class="bb-quote-body">
<pre>; ***** SPECIFY DEVICE ***************************************************
.device ATmega164P
#pragma AVRPART ADMIN PART_NAME ATmega164P
.equ	SIGNATURE_000	= 0x1e
.equ	SIGNATURE_001	= 0x94
.equ	SIGNATURE_002	= 0x0a

#pragma AVRPART CORE CORE_VERSION V2E<div class="bb-quote">Quote:<blockquote class="bb-quote-body"></blockquote></div></pre></blockquote>
</div>
<p>None of the C compilers seems to have that info in them...not unexpected given the fledgling state of the C language...not as advanced as ASM.. :? it will improve.</p>
<p>I will start a thread to ask for that info to be added into the header files in the future. May never happen of course.</p>
</div></div></div><span property="foaf:name" content="js" class="rdf-meta"></span>        </div>
                                  <div class="author-signature">
            <p>John Samperi</p>
<p>Ampertronics Pty. Ltd.</p>
<p><a href="http://www.ampertronics.com.au/" target="_blank">www.ampertronics.com.au</a></p>
<p>* Electronic Design * Custom Products * Contract Assembly</p>
          </div>
                      </div>
    </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<a id="comment-349039"></a>

<a id="forum-topic-top"></a>
<div id="post-349039" class="forum-post clearfix en posted-by-42662 odd comment-with-picture  " about="/comment/349039#comment-349039" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><img src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/offline.png"><a href="http://community.atmel.com/users/curtvm-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/curtvm-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">curtvm</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/curtvm-0" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/picture-default.jpg" alt="curtvm&#39;s picture" title="curtvm&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Raving Lunatic              </div>
      <div class="forum-post-panel-joined">
                  Joined: Wed. Sep 21, 2005              </div>
      <div class="forum-post-panel-posts">
                  Posts: 2328 <a href="http://community.atmel.com/user/42662/content">View posts</a>              </div>
      <div class="forum-post-user-location">
              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/349039#comment-349039" class="permalink" rel="bookmark">#20</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/curtvm-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/curtvm-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">curtvm</a></span>: </span>
              <span class="date-time">Mon. Mar 10, 2008 - 05:47 AM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-b6faed8eec072bf4d389589049efb32a rate-comment-349039-3-3 rate-processed" id="rate-comment-349039-3-3--2"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-346">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-347">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-348">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-349">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-350">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p>I was thinking the same sing the other day (signatures), so I wrote a little script to parse the asm headers, and extract the signatures. I can do it again if its wanted. Maybe a nice table of signatures would be handy.</p>
</div></div></div><span property="foaf:name" content="curtvm" class="rdf-meta"></span>        </div>
                                      </div>
    </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<a id="comment-349040"></a>

<a id="forum-topic-top"></a>
<div id="post-349040" class="forum-post clearfix en posted-by-38341 post-by-starter even comment-with-picture  " about="/comment/349040#comment-349040" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><a href="http://community.atmel.com/users/smileymicros-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/smileymicros-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">smileymicros</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/smileymicros-0" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/picture-38341-1410020303.jpg" alt="smileymicros&#39;s picture" title="smileymicros&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Raving Lunatic              </div>
      <div class="forum-post-panel-joined">
                  Joined: Wed. Nov 17, 2004              </div>
      <div class="forum-post-panel-posts">
                  Posts: 6299 <a href="http://community.atmel.com/user/38341/content">View posts</a>              </div>
      <div class="forum-post-user-location">
                  Location: Great Smokey Mountains.              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/349040#comment-349040" class="permalink" rel="bookmark">#21</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/smileymicros-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/smileymicros-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">smileymicros</a></span>: </span>
              <span class="date-time">Mon. Mar 10, 2008 - 05:51 AM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-5df515cbfced3caa36770ad8f7e018a3 rate-comment-349040-3-3 rate-processed" id="rate-comment-349040-3-3--2"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-351">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-352">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-353">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-354">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-355">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p></p><div class="bb-quote"><b>curtvm wrote:</b><blockquote class="bb-quote-body">I was thinking the same sing the other day (signatures), so I wrote a little script to parse the asm headers, and extract the signatures. I can do it again if its wanted. Maybe a nice table of signatures would be handy.</blockquote></div><p></p>
<p>Yeah, you'd think that wouldn't you. How can you create a generic bootloader with #ifdefs to specific devices without that information? You'd think it would be available somewhere already.</p>
<p>Smiley</p>
</div></div></div><span property="foaf:name" content="smileymicros" class="rdf-meta"></span>        </div>
                                      </div>
    </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<a id="comment-349043"></a>

<a id="forum-topic-top"></a>
<div id="post-349043" class="forum-post clearfix en posted-by-1007 odd comment-with-picture comment-with-signature  " about="/comment/349043#comment-349043" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><a href="http://community.atmel.com/users/js" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/js" typeof="sioc:UserAccount" property="foaf:name" datatype="">js</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/js" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/picture-1007-1406680492.jpg" alt="js&#39;s picture" title="js&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Moderator              </div>
      <div class="forum-post-panel-joined">
                  Joined: Wed. Mar 28, 2001              </div>
      <div class="forum-post-panel-posts">
                  Posts: 25219 <a href="http://community.atmel.com/user/1007/content">View posts</a>              </div>
      <div class="forum-post-user-location">
                  Location: Sydney, Australia (Gum trees, Koalas and Kangaroos, No Edelweiss)              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/349043#comment-349043" class="permalink" rel="bookmark">#22</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/js" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/js" typeof="sioc:UserAccount" property="foaf:name" datatype="">js</a></span>: </span>
              <span class="date-time">Mon. Mar 10, 2008 - 06:20 AM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-541fb863f7324d14214eda6131a1b3cc rate-comment-349043-3-3 rate-processed" id="rate-comment-349043-3-3--2"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-356">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-357">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-358">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-359">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-360">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p></p><div class="bb-quote">Quote:<blockquote class="bb-quote-body">You'd think it would be available somewhere already.<br>
</blockquote></div> It is, in C:\Program Files\Atmel\AVR Tools\AvrAssembler2\Appnotes xxxx*.inc files for each chip :)<p></p>
</div></div></div><span property="foaf:name" content="js" class="rdf-meta"></span>        </div>
                                  <div class="author-signature">
            <p>John Samperi</p>
<p>Ampertronics Pty. Ltd.</p>
<p><a href="http://www.ampertronics.com.au/" target="_blank">www.ampertronics.com.au</a></p>
<p>* Electronic Design * Custom Products * Contract Assembly</p>
          </div>
                      </div>
    </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<a id="comment-349049"></a>

<a id="forum-topic-top"></a>
<div id="post-349049" class="forum-post clearfix en posted-by-1007 even comment-with-picture comment-with-signature  " about="/comment/349049#comment-349049" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><a href="http://community.atmel.com/users/js" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/js" typeof="sioc:UserAccount" property="foaf:name" datatype="">js</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/js" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/picture-1007-1406680492.jpg" alt="js&#39;s picture" title="js&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Moderator              </div>
      <div class="forum-post-panel-joined">
                  Joined: Wed. Mar 28, 2001              </div>
      <div class="forum-post-panel-posts">
                  Posts: 25219 <a href="http://community.atmel.com/user/1007/content">View posts</a>              </div>
      <div class="forum-post-user-location">
                  Location: Sydney, Australia (Gum trees, Koalas and Kangaroos, No Edelweiss)              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/349049#comment-349049" class="permalink" rel="bookmark">#23</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/js" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/js" typeof="sioc:UserAccount" property="foaf:name" datatype="">js</a></span>: </span>
              <span class="date-time">Mon. Mar 10, 2008 - 06:56 AM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-83a76b794abd2f8d1ecafe1ef8ae2702 rate-comment-349049-3-3 rate-processed" id="rate-comment-349049-3-3--2"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-361">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-362">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-363">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-364">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-365">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p>Not all seems to be well. Even though both AVRprog and AVROSPII seem to communicate with the bootloader, programming fails to verify (or work) with both Flash and EEPROM. The chip's "signature" is detected by AVROSP in automatic detection as the Mega644 (haven't changed that yet).</p>
<p>Must do some paid work for a while now.....</p>
</div></div></div><span property="foaf:name" content="js" class="rdf-meta"></span>        </div>
                                  <div class="author-signature">
            <p>John Samperi</p>
<p>Ampertronics Pty. Ltd.</p>
<p><a href="http://www.ampertronics.com.au/" target="_blank">www.ampertronics.com.au</a></p>
<p>* Electronic Design * Custom Products * Contract Assembly</p>
          </div>
                      </div>
    </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<a id="comment-349050"></a>

<a id="forum-topic-top"></a>
<div id="post-349050" class="forum-post clearfix en posted-by-42662 odd comment-with-picture  " about="/comment/349050#comment-349050" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><img src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/offline.png"><a href="http://community.atmel.com/users/curtvm-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/curtvm-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">curtvm</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/curtvm-0" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/picture-default.jpg" alt="curtvm&#39;s picture" title="curtvm&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Raving Lunatic              </div>
      <div class="forum-post-panel-joined">
                  Joined: Wed. Sep 21, 2005              </div>
      <div class="forum-post-panel-posts">
                  Posts: 2328 <a href="http://community.atmel.com/user/42662/content">View posts</a>              </div>
      <div class="forum-post-user-location">
              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/349050#comment-349050" class="permalink" rel="bookmark">#24</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/curtvm-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/curtvm-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">curtvm</a></span>: </span>
              <span class="date-time">Mon. Mar 10, 2008 - 07:14 AM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-93cba0acec159711cdae36b069cf6616 rate-comment-349050-3-3 rate-processed" id="rate-comment-349050-3-3--2"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-366">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-367">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-368">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-369">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-370">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p>Here's a summary- PDF, raw text, and header.</p>
<p>Header untested, though.</p>
</div></div></div><section class="field field-name-field-attach field-type-file field-label-above view-mode-full"><h2 class="field-label">Attachment(s):&nbsp;</h2><div class="field-items"><div class="field-item even"><span class="file"><img class="file-icon" alt="" title="application/octet-stream" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/application-octet-stream.png"> <a href="http://www.avrfreaks.net/sites/default/files/signatures.h" type="application/octet-stream; length=12740">signatures.h</a></span></div><div class="field-item odd"><span class="file"><img class="file-icon" alt="" title="text/plain" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/text-plain.png"> <a href="http://www.avrfreaks.net/sites/default/files/AVR%20Signatures.txt" type="text/plain; length=2575">AVR Signatures.txt</a></span></div><div class="field-item even"><span class="file"><img class="file-icon" alt="" title="application/pdf" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/application-pdf.png"> <a href="http://www.avrfreaks.net/sites/default/files/AVR%20Signatures.pdf" type="application/pdf; length=36836">AVR Signatures.pdf</a></span></div></div></section>        </div>
                                      </div>
    </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<a id="comment-349056"></a>

<a id="forum-topic-top"></a>
<div id="post-349056" class="forum-post clearfix en posted-by-677 even comment-with-picture comment-with-signature  " about="/comment/349056#comment-349056" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><img src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/offline.png"><a href="http://community.atmel.com/users/ew" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/ew" typeof="sioc:UserAccount" property="foaf:name" datatype="">EW</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/ew" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/1360407124cf7af3d5530c_3.jpg" alt="EW&#39;s picture" title="EW&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Raving Lunatic              </div>
      <div class="forum-post-panel-joined">
                  Joined: Thu. Mar 1, 2001              </div>
      <div class="forum-post-panel-posts">
                  Posts: 4934 <a href="http://community.atmel.com/user/677/content">View posts</a>              </div>
      <div class="forum-post-user-location">
                  Location: Rocky Mountains              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/349056#comment-349056" class="permalink" rel="bookmark">#25</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/ew" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/ew" typeof="sioc:UserAccount" property="foaf:name" datatype="">EW</a></span>: </span>
              <span class="date-time">Mon. Mar 10, 2008 - 07:28 AM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-48455acd29d1b245d73269b875216100 rate-comment-349056-3-3 rate-processed" id="rate-comment-349056-3-3--2"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-371">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-372">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-373">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-374">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-375">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p>One of things that I'd like to mention: We could always use more help with documentation in AVR-LibC. Instead of filling up the tutorials forum with fantastic work, it would be nice to include it in the AVR-LibC User Manual where it will get wider distribution.</p>
</div></div></div><span property="foaf:name" content="EW" class="rdf-meta"></span>        </div>
                                  <div class="author-signature">
            <p>Eric Weddington<br>
<a href="http://www.linkedin.com/in/ericweddington/" target="_blank">www.linkedin.com/in/ericweddington/</a></p>
          </div>
                      </div>
    </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<a id="comment-349058"></a>

<a id="forum-topic-top"></a>
<div id="post-349058" class="forum-post clearfix en posted-by-677 odd comment-with-picture comment-with-signature  " about="/comment/349058#comment-349058" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><img src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/offline.png"><a href="http://community.atmel.com/users/ew" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/ew" typeof="sioc:UserAccount" property="foaf:name" datatype="">EW</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/ew" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/1360407124cf7af3d5530c_3.jpg" alt="EW&#39;s picture" title="EW&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Raving Lunatic              </div>
      <div class="forum-post-panel-joined">
                  Joined: Thu. Mar 1, 2001              </div>
      <div class="forum-post-panel-posts">
                  Posts: 4934 <a href="http://community.atmel.com/user/677/content">View posts</a>              </div>
      <div class="forum-post-user-location">
                  Location: Rocky Mountains              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/349058#comment-349058" class="permalink" rel="bookmark">#26</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/ew" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/ew" typeof="sioc:UserAccount" property="foaf:name" datatype="">EW</a></span>: </span>
              <span class="date-time">Mon. Mar 10, 2008 - 07:30 AM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-f6c6289eacf187721e3c3f3724b88db8 rate-comment-349058-3-3 rate-processed" id="rate-comment-349058-3-3--2"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-376">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-377">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-378">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-379">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-380">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p></p><div class="bb-quote"><b>curtvm wrote:</b><blockquote class="bb-quote-body">Here's a summary- PDF, raw text, and header.<p></p>
<p>Header untested, though.</p></blockquote></div><p></p>
<p>As I mentioned to js in another thread, please submit a feature request at the avr-libc project, and not here in the forums.</p>
<p>I lean towards including the signature information in each individual IO header file.</p>
</div></div></div><span property="foaf:name" content="EW" class="rdf-meta"></span>        </div>
                                  <div class="author-signature">
            <p>Eric Weddington<br>
<a href="http://www.linkedin.com/in/ericweddington/" target="_blank">www.linkedin.com/in/ericweddington/</a></p>
          </div>
                      </div>
    </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<a id="comment-349065"></a>

<a id="forum-topic-top"></a>
<div id="post-349065" class="forum-post clearfix en posted-by-42662 even comment-with-picture  " about="/comment/349065#comment-349065" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><img src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/offline.png"><a href="http://community.atmel.com/users/curtvm-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/curtvm-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">curtvm</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/curtvm-0" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/picture-default.jpg" alt="curtvm&#39;s picture" title="curtvm&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Raving Lunatic              </div>
      <div class="forum-post-panel-joined">
                  Joined: Wed. Sep 21, 2005              </div>
      <div class="forum-post-panel-posts">
                  Posts: 2328 <a href="http://community.atmel.com/user/42662/content">View posts</a>              </div>
      <div class="forum-post-user-location">
              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/349065#comment-349065" class="permalink" rel="bookmark">#27</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/curtvm-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/curtvm-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">curtvm</a></span>: </span>
              <span class="date-time">Mon. Mar 10, 2008 - 07:56 AM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-cb93627f8b0ad45e7e8efea91deb2770 rate-comment-349065-3-3 rate-processed" id="rate-comment-349065-3-3--2"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-381">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-382">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-383">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-384">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-385">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p></p><div class="bb-quote">Quote:<blockquote class="bb-quote-body">I lean towards including the signature information in each individual IO header file.</blockquote></div>That would be the place to put it. I was just helping the '109 Bootloader Boys' on their quest. The header seemed like a good idea after I created the pdf, since I just needed to change a couple lines in my script to create it.<p></p>
</div></div></div><span property="foaf:name" content="curtvm" class="rdf-meta"></span>        </div>
                                      </div>
    </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<a id="comment-349070"></a>

<a id="forum-topic-top"></a>
<div id="post-349070" class="forum-post clearfix en posted-by-1007 odd comment-with-picture comment-with-signature  " about="/comment/349070#comment-349070" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><a href="http://community.atmel.com/users/js" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/js" typeof="sioc:UserAccount" property="foaf:name" datatype="">js</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/js" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/picture-1007-1406680492.jpg" alt="js&#39;s picture" title="js&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Moderator              </div>
      <div class="forum-post-panel-joined">
                  Joined: Wed. Mar 28, 2001              </div>
      <div class="forum-post-panel-posts">
                  Posts: 25219 <a href="http://community.atmel.com/user/1007/content">View posts</a>              </div>
      <div class="forum-post-user-location">
                  Location: Sydney, Australia (Gum trees, Koalas and Kangaroos, No Edelweiss)              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/349070#comment-349070" class="permalink" rel="bookmark">#28</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/js" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/js" typeof="sioc:UserAccount" property="foaf:name" datatype="">js</a></span>: </span>
              <span class="date-time">Mon. Mar 10, 2008 - 08:46 AM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-c9cf0427b1aae2036534a6c12b80d463 rate-comment-349070-3-3 rate-processed" id="rate-comment-349070-3-3--2"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-386">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-387">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-388">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-389">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-390">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p></p><div class="bb-quote">Quote:<blockquote class="bb-quote-body">I was just helping the '109 Bootloader Boys' on their quest. </blockquote></div> Then we need a small change to make it compatible with Smiley's code. :)<p></p>
<p>edit ...and of course<br>
</p><div class="bb-quote">
<blockquote class="bb-quote-body">
<pre>#include "signatures.h"</pre></blockquote>
</div>
<p> and<br>
</p><div class="bb-quote">
<blockquote class="bb-quote-body">
<pre>// Signature bytes for ATmega644 
//#define   SIGNATURE_BYTE_1      0x1E 
//#define   SIGNATURE_BYTE_2      0x96 
//#define   SIGNATURE_BYTE_3      0x09 </pre></blockquote>
</div>
<p>What about the SUPPORTED_DEVICE_CODE? Does that change with every device like it used to with the old AVR910 firmware? If so then it could be added to the signature file for each device. </p>
<p>I think this will need to be the case for now untill the next release if the changes are added to the header files.</p>
<p>Now the programmer (AVROSPII) detects the correct "signature", still not programming though. :(</p>
</div></div></div><section class="field field-name-field-attach field-type-file field-label-above view-mode-full"><h2 class="field-label">Attachment(s):&nbsp;</h2><div class="field-items"><div class="field-item even"><span class="file"><img class="file-icon" alt="" title="application/octet-stream" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/application-octet-stream.png"> <a href="http://www.avrfreaks.net/sites/default/files/signatures.h" type="application/octet-stream; length=12740">signatures.h</a></span></div></div></section>        </div>
                                  <div class="author-signature">
            <p>John Samperi</p>
<p>Ampertronics Pty. Ltd.</p>
<p><a href="http://www.ampertronics.com.au/" target="_blank">www.ampertronics.com.au</a></p>
<p>* Electronic Design * Custom Products * Contract Assembly</p>
          </div>
                      </div>
    </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<a id="comment-349260"></a>

<a id="forum-topic-top"></a>
<div id="post-349260" class="forum-post clearfix en posted-by-38341 post-by-starter even comment-with-picture  " about="/comment/349260#comment-349260" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><a href="http://community.atmel.com/users/smileymicros-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/smileymicros-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">smileymicros</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/smileymicros-0" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/picture-38341-1410020303.jpg" alt="smileymicros&#39;s picture" title="smileymicros&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Raving Lunatic              </div>
      <div class="forum-post-panel-joined">
                  Joined: Wed. Nov 17, 2004              </div>
      <div class="forum-post-panel-posts">
                  Posts: 6299 <a href="http://community.atmel.com/user/38341/content">View posts</a>              </div>
      <div class="forum-post-user-location">
                  Location: Great Smokey Mountains.              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/349260#comment-349260" class="permalink" rel="bookmark">#29</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/smileymicros-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/smileymicros-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">smileymicros</a></span>: </span>
              <span class="date-time">Mon. Mar 10, 2008 - 05:39 PM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-97fbdc97a6a00188fe778d3548eb2634 rate-comment-349260-3-3 rate-processed" id="rate-comment-349260-3-3--2"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-391">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-392">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-393">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-394">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-395">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p>I've reduced the code to the minimum (I think) for AVRProg to work. It now is 912 bytes so it fits in the 512 word boot section. This version if for the ATmega32</p>
<p>[/edit] added watchdog timer reset to USART functions and deleted a duplicate definition for 'address'</p>
<div class="bb-quote">
<blockquote class="bb-quote-body">
<pre>/*****************************************************
	RequiredText.c 3/10/08 Joe Pardue
	Minimum AVR109 bootloader commands
	ATmega32 Verson
******************************************************/

// I HATE LICENSES LIKE THIS BUT I've been told that without
// the license then the work is automatically copyrighted in my name
// since my purpose is to educate, I want the code to used by whoever
// wants to use it to learn something. If you like it, then visit
// my website www.smileymicros.com and buy something.

/*
 *  BSD License
 *  -----------
 *
 *  Copyright (c) 2008, Smiley Micros, All rights reserved.
 *
 *  Redistribution and use in source and binary forms, with or without
 *  modification, are permitted provided that the following conditions are met:
 *
 *  - Redistributions of source code must retain the above copyright notice,
 *    this list of conditions and the following disclaimer. 
 *   
 *  - Redistributions in binary form must reproduce the above copyright notice,
 *    this list of conditions and the following disclaimer in the documentation
 *    and/or other materials provided with the distribution. 
 *   
 *  - Neither the name of the Smiley Micros nor the names of its contributors
 *    may be used to endorse or promote products derived from this software
 *    without specific prior written permission. 
 *
 *  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 *  AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 *  IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 *  ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
 *  LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 *  CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 *  SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 *  INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 *  CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 *  ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 *  POSSIBILITY OF SUCH DAMAGE.
 */

// And to further cover my ass, let me add that if you use this software
// it will destroy whatever machine you use it on and kill anyone in a one 
// kilometer radius. So don't even consider using it for any reason whatsoever!


#include <avr io.h="" rel="nofollow">
#include <avr pgmspace.h="" rel="nofollow"> 
#include <avr boot.h="" rel="nofollow">
#include <avr interrupt.h="" rel="nofollow">
#include <avr wdt.h="" rel="nofollow"> // watchdog timer 

// USART declarations
static void USARTInit();
static void sendByte( uint8_t );
static uint8_t receiveByte( void );

// AVR109 Command Parser declaration
static void AVR109CommandParser(void);

// AVR109 Command declarations
static void enterProgramMode(void);
static void autoIncrementAddress(void);
static void setAddress(void);
static void chipErase(void);
static void selectDeviceType(void);
static void readSignatureBytes(void);
static void returnSupportedDeviceCodes(void);
static void returnSoftwareIdentifier(void);
static void returnProgrammerType(void);
static void checkBlockSupport(void);
static void blockFlashLoad(uint16_t size);
static void blockFlashRead(uint16_t size);

// Pin definitions for boot or application reset state
#define	BOOT_STATE_PORT			PORTD
#define	BOOT_STATE_PIN			PIND
#define	BOOT_STATE_PIN_NUMBER	PD7  

#define SUPPORTED_DEVICE_CODE 	0x73

// Signature bytes for ATmega32
#define	SIGNATURE_BYTE_1		0x1E
#define	SIGNATURE_BYTE_2		0x95
#define	SIGNATURE_BYTE_3		0x02

// Function pointer to jump to the applicaion memory section
void (*funcptr)( void ) = 0x0000; 

// Used by chipErase function
#define BOOTSIZE 512

// SRAM Page buffer for flash page pre-load
uint8_t pageBuffer[SPM_PAGESIZE];
#define UART_RX_BUFFER_SIZE SPM_PAGESIZE

// AVR109 uses a global address
uint16_t address;

// From Peter Fluery AVRFreaks Aug 10 2005 - to remove interrupt Vector table
// put -nostartfiles in LDFlags, add the following function
// saves wasted space
void __jumpMain     (void) __attribute__ ((naked)) __attribute__ ((section (".init9")));

void __jumpMain(void)
{   
    asm volatile ( ".set __stack, %0" :: "i" (RAMEND) );
    asm volatile ( "clr __zero_reg__" );        // r1 set to 0
    asm volatile ( "rjmp main");                   // jump to main()
} 

int main(void)
{
	USARTInit();

	// Use bootloader or application code?
    if( !(BOOT_STATE_PIN &amp; (1&lt;&lt;BOOT_STATE_PIN_NUMBER)) ) /* If BOOT_STATE_PIN_NUMBER is low, use bootloader. */
    {
		while(1)
		{
			// wait for esc character (0x1B) and respond with AVRBOOT
			if(receiveByte() == 0x1B)
			{
				// wait for software identifier request
				while( receiveByte() != 'S');
				
				// answer the request
				returnSoftwareIdentifier();
				
				// begin servicing the commands
				AVR109CommandParser();
			}
			else sendByte('?');
		}
	}
	else
	{
		// If BOOT_STATE_PIN_NUMBER is high, don't use bootloader.
		// So... jump to the application 
		funcptr();
	}

	return 0;
}

void AVR109CommandParser()
{
	uint8_t cmd,tempRec;
	uint16_t tempSize;

	while(1)
	{
		cmd = receiveByte();

		switch (cmd)
		{
			case 'P':
				enterProgramMode();
				break;
			case 'a':
				autoIncrementAddress();
				break;
			case 'A':
				setAddress();
				break;
			case 'e':
				chipErase();	
				break;
			case 'L':
				enterProgramMode();
				break;
			case 'T':
				selectDeviceType();
				break;					
			case 's':
				readSignatureBytes();	
				break;			
			case 't':
				returnSupportedDeviceCodes();	
				break;
			case 'S':
				returnSoftwareIdentifier();	
				break;			
			case 'p':
				returnProgrammerType();	
				break;			
			case 'b':
				checkBlockSupport();	
				break;
			case 'B':
			case 'g':
				tempSize = (receiveByte() &lt;&lt; 8) | receiveByte();
				// dummy read for type - we only do flash NOT EEPROM
				tempRec = receiveByte(); 
				if(cmd == 'B') blockFlashLoad( tempSize );
				else blockFlashRead( tempSize  );
				break;									
			default:
				if(cmd != 0x1B) sendByte('?');
		}
	}
}	

/*****************************************************
	AVR109 Self Programming Commands
******************************************************/

void enterProgramMode() // 'P'
{
	// what else is it going to do?
	sendByte('\r');
}

void autoIncrementAddress(void) // 'a'
{ 
	// Yes, this code autoincrements
	sendByte('Y');
}

void setAddress(void) // 'A'
{ 
	// Note that flash addresses are in words, not bytes               
    address = receiveByte();   
	address = (address&lt;&lt;8) | receiveByte();
	address = address &lt;&lt; 1; // convert word address to byte address

 	sendByte('\r');  // respond okay
}

void chipErase(void) // 'e'
{ 
 	int i;
 	for(i = 0 ; i &lt; (FLASHEND - (BOOTSIZE * 2)); i += SPM_PAGESIZE)
	{
    	boot_page_erase_safe(i);	// Erase the page
    	boot_spm_busy_wait();		// Wait until finished.
	}
   
	sendByte('\r');  // respond okay
}

void selectDeviceType() // 'T'
{
	//dummy read since we only have one device type
	uint8_t dummy;
	dummy = receiveByte();
	sendByte('\r');
}

void readSignatureBytes(void) // 'S'
{ 
    sendByte( SIGNATURE_BYTE_3 );
    sendByte( SIGNATURE_BYTE_2 );
    sendByte( SIGNATURE_BYTE_1 );
}

void returnSupportedDeviceCodes(void) // 't'
{
	sendByte(SUPPORTED_DEVICE_CODE); // Support only this device
	sendByte(0); // list terminator
}

void returnSoftwareIdentifier(void) // 'S'
{ 
    // Software identifier is 'AVRBOOT'
	sendByte('A');
    sendByte('V'); 
    sendByte('R');
    sendByte('B');
    sendByte('O');
    sendByte('O');
    sendByte('T');
}

void returnProgrammerType(void) // 'p'
{      
	// Get programmer type - serial.
    sendByte('S');
}

void checkBlockSupport(void) // 'b'
{ 
    sendByte('Y'); // yes, block load is supported.
    sendByte((SPM_PAGESIZE&gt;&gt;8) &amp; 0xFF); // send MSB first.
    sendByte(SPM_PAGESIZE &amp; 0xFF); // send LSB second.
}

void blockFlashLoad(uint16_t size)
{ 
	uint16_t tempAddress = address;

	uint16_t i,tempWord;

	// store values to be programmed in temporary buffer
	for (i=0; i<uart_rx_buffer_size; i++)="" {="" if="" (i<size)="" pagebuffer[i]="receiveByte();" else="" }="" i="0;" boot_page_erase_safe(address);="" perform="" page="" erase="" boot_spm_busy_wait();="" wait="" until="" the="" memory="" is="" erased.="" for(i="0;" <="" size;="" i+="2)" tempword="pageBuffer[i];" load="" little="" end="" then="" increment="" +="(pageBuffer[i+1]" &lt;&lt;="" 8);="" big="" boot_page_fill_safe(address,tempword);="" address="address" 2;="" word="" boot_page_write_safe(tempaddress);="" boot_rww_enable();="" re-enable="" rww="" section="" sendbyte('\r');="" void="" blockflashread(uint16_t="" size)="" uint8_t="" data;="" do="" data="pgm_read_byte_near(address++);" read_program_memory(address,0x00);="" sendbyte(data);="" send="" byte="" size--;="" reduce="" number="" of="" bytes="" to="" read="" by="" one="" while="" (size);="" loop="" through="" size="" *****************************************************="" functions="" from="" uart_test="" ******************************************************="" usartinit()="" set="" baud="" rate="" hard="" coded="" 19200="" for="" 12mhz="" ubrrl="38;" enable="" receiver="" and="" transmitter="" ucsrb="(1&lt;&lt;RXEN)|(1&lt;&lt;TXEN);" frame="" format:="" n,8,1="" ucsrc="" |="(1" ursel)="" (1="" ucsz0)="" ucsz1);="" sendbyte(="" )="" wdt_reset();="" reset="" watchdog="" timer,="" it="" empty="" transmit="" buffer="" (="" !(="" ucsra="" &="" (1&lt;&lt;udre))="" );="" put="" into="" buffer,="" sends="" udr="data;" receivebyte(="" be="" received="" !(ucsra="" (1&lt;&lt;rxc))="" get="" return="" udr;="" pre=""></uart_rx_buffer_size;></avr></avr></avr></avr></avr></pre></blockquote>
</div>
<p>To use it for the ATmega644 just change the signature bytes and the device type to match the OP.</p>
<p>The real trick is setting up the AVRStudio configuration files and the AVR Programmer. I'll discuss all that in the soon to arrive tutorial.</p>
<p>Smiley</p>
</div></div></div><span property="foaf:name" content="smileymicros" class="rdf-meta"></span>        </div>
                                      </div>
    </div>
          <div class="post-update">
        Last Edited: <span class="date-time">Mon. Mar 10, 2008 - 08:15 PM</span>      </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<a id="comment-349269"></a>

<a id="forum-topic-top"></a>
<div id="post-349269" class="forum-post clearfix en posted-by-38341 post-by-starter odd comment-with-picture  " about="/comment/349269#comment-349269" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><a href="http://community.atmel.com/users/smileymicros-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/smileymicros-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">smileymicros</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/smileymicros-0" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/picture-38341-1410020303.jpg" alt="smileymicros&#39;s picture" title="smileymicros&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Raving Lunatic              </div>
      <div class="forum-post-panel-joined">
                  Joined: Wed. Nov 17, 2004              </div>
      <div class="forum-post-panel-posts">
                  Posts: 6299 <a href="http://community.atmel.com/user/38341/content">View posts</a>              </div>
      <div class="forum-post-user-location">
                  Location: Great Smokey Mountains.              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/349269#comment-349269" class="permalink" rel="bookmark">#30</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/smileymicros-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/smileymicros-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">smileymicros</a></span>: </span>
              <span class="date-time">Mon. Mar 10, 2008 - 05:58 PM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-ccf4ef853b35b813bbfb92ee161900b0 rate-comment-349269-3-3 rate-processed" id="rate-comment-349269-3-3--2"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-396">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-397">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-398">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-399">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-400">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p></p><div class="bb-quote"><b>EW wrote:</b><blockquote class="bb-quote-body">One of things that I'd like to mention: We could always use more help with documentation in AVR-LibC. Instead of filling up the tutorials forum with fantastic work, it would be nice to include it in the AVR-LibC User Manual where it will get wider distribution.</blockquote></div><p></p>
<p>Eric,</p>
<p>I'm happy to oblige, but to keep the trolls at bay I'm going to PM you with my concerns.</p>
<p>Smiley</p>
</div></div></div><span property="foaf:name" content="smileymicros" class="rdf-meta"></span>        </div>
                                      </div>
    </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<a id="comment-349271"></a>

<a id="forum-topic-top"></a>
<div id="post-349271" class="forum-post clearfix en posted-by-6164 even comment-with-picture comment-with-signature  " about="/comment/349271#comment-349271" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><img src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/online.png"><a href="http://community.atmel.com/users/bobgardner" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/bobgardner" typeof="sioc:UserAccount" property="foaf:name" datatype="">bobgardner</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/bobgardner" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/6945349644de41a1350735_3.jpg" alt="bobgardner&#39;s picture" title="bobgardner&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: 10k+ Postman              </div>
      <div class="forum-post-panel-joined">
                  Joined: Wed. Sep 4, 2002              </div>
      <div class="forum-post-panel-posts">
                  Posts: 26246 <a href="http://community.atmel.com/user/6164/content">View posts</a>              </div>
      <div class="forum-post-user-location">
                  Location: Orlando Florida              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/349271#comment-349271" class="permalink" rel="bookmark">#31</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/bobgardner" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/bobgardner" typeof="sioc:UserAccount" property="foaf:name" datatype="">bobgardner</a></span>: </span>
              <span class="date-time">Mon. Mar 10, 2008 - 06:10 PM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-9111b95026a6530d848da249e9c9049d rate-comment-349271-3-3 rate-processed" id="rate-comment-349271-3-3--2"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-401">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-402">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-403">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-404">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-405">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p>Smiley... will this compile with the latest winavr AND with the one in use at the time of your book? Might save a newbie a compiler configuration management headache</p>
</div></div></div><span property="foaf:name" content="bobgardner" class="rdf-meta"></span>        </div>
                                  <div class="author-signature">
            <p>Imagecraft compiler user</p>
          </div>
                      </div>
    </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<a id="comment-349281"></a>

<a id="forum-topic-top"></a>
<div id="post-349281" class="forum-post clearfix en posted-by-221489 odd comment-with-picture comment-with-signature  " about="/comment/349281#comment-349281" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><a href="http://community.atmel.com/users/mikeperks" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/mikeperks" typeof="sioc:UserAccount" property="foaf:name" datatype="">mikeperks</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/mikeperks" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/1242546424473df73d086ea_3.gif" alt="mikeperks&#39;s picture" title="mikeperks&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Hangaround              </div>
      <div class="forum-post-panel-joined">
                  Joined: Tue. Nov 6, 2007              </div>
      <div class="forum-post-panel-posts">
                  Posts: 181 <a href="http://community.atmel.com/user/221489/content">View posts</a>              </div>
      <div class="forum-post-user-location">
                  Location: Austin, TX              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/349281#comment-349281" class="permalink" rel="bookmark">#32</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/mikeperks" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/mikeperks" typeof="sioc:UserAccount" property="foaf:name" datatype="">mikeperks</a></span>: </span>
              <span class="date-time">Mon. Mar 10, 2008 - 06:46 PM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-b341703913ac9d1cb6340a3720d1c202 rate-comment-349281-3-3 rate-processed" id="rate-comment-349281-3-3--2"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-406">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-407">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-408">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-409">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-410">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p></p><div class="bb-quote"><b>smileymicros wrote:</b><blockquote class="bb-quote-body">I've reduced the code to the minimum (I think) for AVRProg to work. It now is 912 bytes so it fits in the 512 word boot section. This version if for the ATmega32</blockquote></div>There are several items you need to still implement to make this a completely robust bootloader:<ul class="bb-list" style="list-style-type: circle;"><li>Support for RAMPZ and 32-bit addresses e.g.
<div class="bb-quote">
<blockquote class="bb-quote-body">
<pre>#if defined(RAMPZ)
typedef uint32_t address_t;
#else
typedef uint16_t address_t;
#endif

   /* calculate flash address from page number and page size */
   /* use 16bit address variable for ATmegas with &lt;= 64K flash */
	/* set the RAMPZ register for ATmegas &gt; 64K flash */
	#if defined(RAMPZ)
		uint32_t address = ((uint32_t)Page) * SPM_PAGESIZE;
		RAMPZ = ((Page &gt;&gt; 8) != 0);
	#else
		uint16_t address = Page * SPM_PAGESIZE;
	#endif

   /* erase page and wait for completion */
	boot_page_erase(address); 
	boot_spm_busy_wait();
	....</pre></blockquote>
</div>
<p></p></li><li>Turn off the watchdog, if supported by the device e.g.
<div class="bb-quote">
<blockquote class="bb-quote-body">
<pre>	/* reset the watchdog timer */
   wdt_reset();
	WDTCR |= _BV(WDCE) | _BV(WDE);
	WDTCR = 0;</pre></blockquote>
</div>
<p></p></li><li>Generalize the access to registers using standard names and map to device specific registers for each chip e.g.
<div class="bb-quote">
<blockquote class="bb-quote-body">
<pre>/* defines for the various USART registers */
#if defined(__AVR_ATmega32__)

	/* ATMega with one USART */
	#define UART_BAUD_RATE_LOW	     UBRRL
	#define UART_STATUS_REG	        UCSRA
	#define UART_CONTROL_REG	     UCSRB
	#define UART_ENABLE_TRANSMITTER TXEN
	#define UART_ENABLE_RECEIVER	  RXEN
	#define UART_READY_TO_TRANSMIT  UDRE
	#define UART_TRANSMIT_COMPLETE  TXC
	#define UART_RECEIVE_COMPLETE	  RXC
	#define UART_DATA_REG	        UDR

#elif defined(__AVR_ATmega128__) || defined(__AVR_ATmega1281__) || defined(__AVR_ATmega644__)

	/* ATMega with two USARTs */
	#define UART_BAUD_RATE_LOW	     UBRR0L
	#define UART_STATUS_REG	        UCSR0A
	#define UART_CONTROL_REG	     UCSR0B
	#define UART_READY_TO_TRANSMIT  UDRE0
	#define UART_ENABLE_TRANSMITTER TXEN0
	#define UART_ENABLE_RECEIVER	  RXEN0
	#define UART_TRANSMIT_COMPLETE  TXC0
	#define UART_RECEIVE_COMPLETE	  RXC0
	#define UART_DATA_REG	        UDR0

#else
	#error "no UART definition for MCU"
#endif

/* defines for EEPROM write bits */
#if defined(__AVR_ATmega32__) || defined(__AVR_ATmega128__)

	#define EEPROM_MASTER_WRITE  EEMWE
	#define EEPROM_WRITE         EEWE

#elif  defined(__AVR_ATmega644__) || defined(__AVR_ATmega1281__)

	#define EEPROM_MASTER_WRITE  EEMPE
	#define EEPROM_WRITE         EEPE

#else
	#error "no EEPROM definition for MCU"
#endif</pre></blockquote>
</div>
<p></p></li></ul><p></p>
</div></div></div><span property="foaf:name" content="mikeperks" class="rdf-meta"></span>        </div>
                                  <div class="author-signature">
            <p>--Mike</p>
          </div>
                      </div>
    </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<a id="comment-349283"></a>

<a id="forum-topic-top"></a>
<div id="post-349283" class="forum-post clearfix en posted-by-42662 even comment-with-picture  " about="/comment/349283#comment-349283" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><img src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/offline.png"><a href="http://community.atmel.com/users/curtvm-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/curtvm-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">curtvm</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/curtvm-0" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/picture-default.jpg" alt="curtvm&#39;s picture" title="curtvm&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Raving Lunatic              </div>
      <div class="forum-post-panel-joined">
                  Joined: Wed. Sep 21, 2005              </div>
      <div class="forum-post-panel-posts">
                  Posts: 2328 <a href="http://community.atmel.com/user/42662/content">View posts</a>              </div>
      <div class="forum-post-user-location">
              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/349283#comment-349283" class="permalink" rel="bookmark">#33</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/curtvm-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/curtvm-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">curtvm</a></span>: </span>
              <span class="date-time">Mon. Mar 10, 2008 - 07:03 PM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-5dfd170b11ae047d61cee7a20cfd3c5f rate-comment-349283-3-3 rate-processed" id="rate-comment-349283-3-3--2"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-411">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-412">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-413">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-414">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-415">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><div class="bb-quote">
<blockquote class="bb-quote-body">
<pre>// Function pointer to jump to the applicaion memory section
void (*funcptr)( void ) = 0x0000; </pre></blockquote>
</div>
<p>You can make that static, then there will be no ram required for that variable (and will help later if you go to -nodefaultlibs).</p>
<p>It looks like you are using -nostartfiles only, so why not kill 2 birds with 1 stone-<br>
</p><div class="bb-quote">
<blockquote class="bb-quote-body">
<pre>int main (void) __attribute__ ((naked,section (".init9")));
int main(void){
    asm volatile ( "clr __zero_reg__" );
    SP=RAMEND;
...
</pre></blockquote>
</div>
<p>which puts main at the start, and gets rid of the useless pushing/popping at main start/end (naked).</p>
<p>You can remove one of these(declared twice)<br>
</p><div class="bb-quote">
<blockquote class="bb-quote-body">
<pre>// AVR109 sets the address globally
uint16_t address;</pre></blockquote>
</div>
<p>I'm sure we are getting carried away with your bootloader, but one thing I will add that was just mentioned by mikeperks- the watchdog. A simple thing to do would be to put a 'wdr' inside the receive and transmit loop (I think those two places would take care of it). That way it does not matter if the avr has the watchdog fused on, was reset by the watchdog, or whatever- you just keep clearing it in those loops.</p>
</div></div></div><span property="foaf:name" content="curtvm" class="rdf-meta"></span>        </div>
                                      </div>
    </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<a id="comment-349303"></a>

<a id="forum-topic-top"></a>
<div id="post-349303" class="forum-post clearfix en posted-by-38341 post-by-starter odd comment-with-picture  " about="/comment/349303#comment-349303" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><a href="http://community.atmel.com/users/smileymicros-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/smileymicros-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">smileymicros</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/smileymicros-0" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/picture-38341-1410020303.jpg" alt="smileymicros&#39;s picture" title="smileymicros&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Raving Lunatic              </div>
      <div class="forum-post-panel-joined">
                  Joined: Wed. Nov 17, 2004              </div>
      <div class="forum-post-panel-posts">
                  Posts: 6299 <a href="http://community.atmel.com/user/38341/content">View posts</a>              </div>
      <div class="forum-post-user-location">
                  Location: Great Smokey Mountains.              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/349303#comment-349303" class="permalink" rel="bookmark">#34</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/smileymicros-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/smileymicros-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">smileymicros</a></span>: </span>
              <span class="date-time">Mon. Mar 10, 2008 - 08:07 PM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-3f81768c41e0934656f3c09b1509815e rate-comment-349303-3-3 rate-processed" id="rate-comment-349303-3-3--2"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-416">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-417">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-418">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-419">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-420">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p></p><div class="bb-quote"><b>bobgardner wrote:</b><blockquote class="bb-quote-body">Smiley... will this compile with the latest winavr AND with the one in use at the time of your book? Might save a newbie a compiler configuration management headache</blockquote></div><br>
No, I've moved up to the latest and greatest. The old stuff is just for the book and I expect those guys to follow the instruction that once finished with the book, then get the latest WinAVR. I consider this bootloader stuff post-book material.<p></p>
<p></p><div class="bb-quote"><b>mikeperks wrote:</b><blockquote class="bb-quote-body"><div class="bb-quote"><b>smileymicros wrote:</b><blockquote class="bb-quote-body">I've reduced the code to the minimum (I think) for AVRProg to work. It now is 912 bytes so it fits in the 512 word boot section. This version if for the ATmega32</blockquote></div>There are several items you need to still implement to make this a completely robust bootloader:<ul class="bb-list" style="list-style-type: circle;"><li>Support for RAMPZ and 32-bit addresses e.g.<pre class="bb-code-block">#if defined(RAMPZ)&lt;br /&gt;
</pre></li></ul></blockquote></div>&lt;/p&gt;
&lt;p&gt;I'm assuming that the rampz stuff is for devices with &gt; 64K memory? So if I restrict my code to 40 pin DIP devices and smaller, then it won't be needed.&lt;br /&gt;
Also I'm going for clarity over 'robust' since this is instructional code. It should work okay for the systems described, but once understood the reader should then move on to a better bootloader depending on that individuals definition of better.&lt;/p&gt;
&lt;p&gt;<div class="bb-quote"><b>mikeperks wrote:</b><blockquote class="bb-quote-body">&lt;br /&gt;
<li>Turn off the watchdog, if supported by the device e.g.[code]	/* reset the watchdog timer */&lt;br /&gt;
   wdt_reset();&lt;br /&gt;
	WDTCR |= _BV(WDCE) | _BV(WDE);&lt;br /&gt;
	WDTCR = 0;<br>
</li></blockquote></div><br>
I'll give this a try, along with curtvm's version below.<p></p>
<p></p><div class="bb-quote"><b>mikeperks wrote:</b><blockquote class="bb-quote-body"><li>Generalize the access to registers using standard names and map to device specific registers for each chip e.g.<pre class="bb-code-block">/* defines for the various USART registers */</pre></li></blockquote></div>&lt;br /&gt;
These are good suggestions. I'm concerned with adding too much code that isn't bootloader specific since that topic alone is too much for most folks and any distraction might prove fatal to understanding. I guess what I should do is provide a well discussed minimal bootloader, then append a listing for a more robust and generic bootloader based on the one discussed. I'll look into this as I have time.&lt;/p&gt;
&lt;p&gt;<div class="bb-quote"><b>curtvm wrote:</b><blockquote class="bb-quote-body">&lt;br /&gt;
[code]&lt;br /&gt;
// Function pointer to jump to the applicaion memory section&lt;br /&gt;
void (*funcptr)( void ) = 0x0000;&lt;br /&gt;
<br>
You can make that static, then there will be no ram required for that variable (and will help later if you go to -nodefaultlibs).<p></p>
<p>It looks like you are using -nostartfiles only, so why not kill 2 birds with 1 stone-<br>
</p><pre class="bb-code-block">&lt;br /&gt;
int main (void) __attribute__ ((naked,section (".init9")));&lt;br /&gt;
int main(void){&lt;br /&gt;
    asm volatile ( "clr __zero_reg__" );&lt;br /&gt;
    SP=RAMEND;&lt;br /&gt;
...&lt;br /&gt;
</pre><br>
which puts main at the start, and gets rid of the useless pushing/popping at main start/end (naked).<p></p>
<p>You can remove one of these(declared twice)<br>
</p><pre class="bb-code-block">// AVR109 sets the address globally&lt;br /&gt;
uint16_t address;</pre><p></p>
<p>I'm sure we are getting carried away with your bootloader, but one thing I will add that was just mentioned by mikeperks- the watchdog. A simple thing to do would be to put a 'wdr' inside the receive and transmit loop (I think those two places would take care of it). That way it does not matter if the avr has the watchdog fused on, was reset by the watchdog, or whatever- you just keep clearing it in those loops.</p></blockquote></div><p></p>
<p>Since I've gotten it below 512 words and am unlikely to get it below 256 words, I'm going to leave off any further optimizations that aren't directly relevant to understanding a basic bootloader. I will include a watchdog fix as you and mike have suggested. Thanks for catching the duplicated definition.</p>
<p>Thanks for all the great input guys,<br>
Smiley</p>
</div></div></div><span property="foaf:name" content="smileymicros" class="rdf-meta"></span>        </div>
                                      </div>
    </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<a id="comment-349331"></a>

<a id="forum-topic-top"></a>
<div id="post-349331" class="forum-post clearfix en posted-by-42662 even comment-with-picture  " about="/comment/349331#comment-349331" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><img src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/offline.png"><a href="http://community.atmel.com/users/curtvm-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/curtvm-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">curtvm</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/curtvm-0" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/picture-default.jpg" alt="curtvm&#39;s picture" title="curtvm&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Raving Lunatic              </div>
      <div class="forum-post-panel-joined">
                  Joined: Wed. Sep 21, 2005              </div>
      <div class="forum-post-panel-posts">
                  Posts: 2328 <a href="http://community.atmel.com/user/42662/content">View posts</a>              </div>
      <div class="forum-post-user-location">
              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/349331#comment-349331" class="permalink" rel="bookmark">#35</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/curtvm-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/curtvm-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">curtvm</a></span>: </span>
              <span class="date-time">Mon. Mar 10, 2008 - 09:13 PM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-377d3a17a1328b879a78732a4c5d9cbb rate-comment-349331-3-3 rate-processed" id="rate-comment-349331-3-3--2"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-421">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-422">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-423">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-424">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-425">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p>While adding this-<br>
</p><div class="bb-quote">
<blockquote class="bb-quote-body">
<pre>void sendByte( uint8_t data )
{
   // Wait for empty transmit buffer
   do{
        wdt_reset();
   }
   while ( !( UCSRA &amp; (1&lt;&lt;UDRE)) );
   // Put data into buffer, sends the data
   UDR = data;
}</pre></blockquote>
</div>
<p>I noticed the size decreased quite a bit (relatively speaking). It seems for some reason the latest winavr/gcc is 'inlining' all those sendByte's (take a look at returnSoftwareIdentifier for example). After adding the above wdr, it no longer felt the need to inline it everytime. For double checking, I just simply added a 'nop' instead of the wdr/do/while code, and the same thing happens. Apparently the compiler seems to think inlining is the thing to do, until adding one more instruction tips it over the edge, or something (only gcc 4.x.x doing this, gcc 3.4.6 already makes it a 'called function' everytime). Not sure what's going on there.</p>
</div></div></div><span property="foaf:name" content="curtvm" class="rdf-meta"></span>        </div>
                                      </div>
    </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<a id="comment-349339"></a>

<a id="forum-topic-top"></a>
<div id="post-349339" class="forum-post clearfix en posted-by-38341 post-by-starter odd comment-with-picture  " about="/comment/349339#comment-349339" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><a href="http://community.atmel.com/users/smileymicros-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/smileymicros-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">smileymicros</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/smileymicros-0" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/picture-38341-1410020303.jpg" alt="smileymicros&#39;s picture" title="smileymicros&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Raving Lunatic              </div>
      <div class="forum-post-panel-joined">
                  Joined: Wed. Nov 17, 2004              </div>
      <div class="forum-post-panel-posts">
                  Posts: 6299 <a href="http://community.atmel.com/user/38341/content">View posts</a>              </div>
      <div class="forum-post-user-location">
                  Location: Great Smokey Mountains.              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/349339#comment-349339" class="permalink" rel="bookmark">#36</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/smileymicros-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/smileymicros-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">smileymicros</a></span>: </span>
              <span class="date-time">Mon. Mar 10, 2008 - 09:34 PM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-b33af140a31f9c84d9a389cdd84b10d0 rate-comment-349339-3-3 rate-processed" id="rate-comment-349339-3-3--2"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-426">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-427">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-428">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-429">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-430">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p>I made that suggested change and it made no difference in my compiled code size. Added it to the receiveByte code and it incresed the codesize by 2 bytes. Wonder what's going on? </p>
<p>Program 756<br>
data 132</p>
<p>Smiley</p>
</div></div></div><span property="foaf:name" content="smileymicros" class="rdf-meta"></span>        </div>
                                      </div>
    </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<a id="comment-349354"></a>

<a id="forum-topic-top"></a>
<div id="post-349354" class="forum-post clearfix en posted-by-42662 even comment-with-picture  " about="/comment/349354#comment-349354" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><img src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/offline.png"><a href="http://community.atmel.com/users/curtvm-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/curtvm-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">curtvm</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/curtvm-0" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/picture-default.jpg" alt="curtvm&#39;s picture" title="curtvm&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Raving Lunatic              </div>
      <div class="forum-post-panel-joined">
                  Joined: Wed. Sep 21, 2005              </div>
      <div class="forum-post-panel-posts">
                  Posts: 2328 <a href="http://community.atmel.com/user/42662/content">View posts</a>              </div>
      <div class="forum-post-user-location">
              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/349354#comment-349354" class="permalink" rel="bookmark">#37</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/curtvm-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/curtvm-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">curtvm</a></span>: </span>
              <span class="date-time">Mon. Mar 10, 2008 - 10:06 PM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-5450efb5964fec81278d961fe3d4a4b5 rate-comment-349354-3-3 rate-processed" id="rate-comment-349354-3-3--2"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-431">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-432">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-433">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-434">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-435">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p>It could be my setup. With the original sendByte, mine wants to inline all those. When anything is added to the function, it decides to not inline it anymore.</p>
<p>I'm pretty close to your 756 now (726 with main naked, 760 without, and 688 with -mshort-calls).</p>
</div></div></div><span property="foaf:name" content="curtvm" class="rdf-meta"></span>        </div>
                                      </div>
    </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<a id="comment-349355"></a>

<a id="forum-topic-top"></a>
<div id="post-349355" class="forum-post clearfix en posted-by-1007 odd comment-with-picture comment-with-signature  " about="/comment/349355#comment-349355" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><a href="http://community.atmel.com/users/js" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/js" typeof="sioc:UserAccount" property="foaf:name" datatype="">js</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/js" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/picture-1007-1406680492.jpg" alt="js&#39;s picture" title="js&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Moderator              </div>
      <div class="forum-post-panel-joined">
                  Joined: Wed. Mar 28, 2001              </div>
      <div class="forum-post-panel-posts">
                  Posts: 25219 <a href="http://community.atmel.com/user/1007/content">View posts</a>              </div>
      <div class="forum-post-user-location">
                  Location: Sydney, Australia (Gum trees, Koalas and Kangaroos, No Edelweiss)              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/349355#comment-349355" class="permalink" rel="bookmark">#38</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/js" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/js" typeof="sioc:UserAccount" property="foaf:name" datatype="">js</a></span>: </span>
              <span class="date-time">Mon. Mar 10, 2008 - 10:07 PM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-90a492cebb88bf04bb52bb8104e9719c rate-comment-349355-3-3 rate-processed" id="rate-comment-349355-3-3--2"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-436">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-437">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-438">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-439">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-440">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p><span style="color:red"> <span style="font-weight:bold">**WARNING** **WARNING** **WARNING** </span></span><br>
MAKE SURE that the bootsize fuses are set correctly to fit the bootloader code as SPM does NOT work outside the bootloader area. :( :(</p>
<p>This bit should be on top of every page...ok I'll stand in the corner facing the wall for the next hour :(</p>
<p>It's all working now.</p>
<p>However there is one thing I'm interested in finding out.</p>
<p>The SUPPORTED_DEVICE_CODE 0x73 is for the boot area of the Mega 32, it still works with the Mega 164p and AVRProg is thinking that is talking to the M32 boot.</p>
<p>Since AVRPROG is no longer updtated,ie no device codes are available for new chips for the past 5 years or so, how is it that it will still program newer chips? Does the device code really matter as the bootloader is doing the real programming? I'm confused.</p>
<p>I'll try the new, smaller code later on.</p>
</div></div></div><span property="foaf:name" content="js" class="rdf-meta"></span>        </div>
                                  <div class="author-signature">
            <p>John Samperi</p>
<p>Ampertronics Pty. Ltd.</p>
<p><a href="http://www.ampertronics.com.au/" target="_blank">www.ampertronics.com.au</a></p>
<p>* Electronic Design * Custom Products * Contract Assembly</p>
          </div>
                      </div>
    </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<a id="comment-356436"></a>

<a id="forum-topic-top"></a>
<div id="post-356436" class="forum-post clearfix en posted-by-1007 even comment-with-picture comment-with-signature  " about="/comment/356436#comment-356436" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><a href="http://community.atmel.com/users/js" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/js" typeof="sioc:UserAccount" property="foaf:name" datatype="">js</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/js" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/picture-1007-1406680492.jpg" alt="js&#39;s picture" title="js&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Moderator              </div>
      <div class="forum-post-panel-joined">
                  Joined: Wed. Mar 28, 2001              </div>
      <div class="forum-post-panel-posts">
                  Posts: 25219 <a href="http://community.atmel.com/user/1007/content">View posts</a>              </div>
      <div class="forum-post-user-location">
                  Location: Sydney, Australia (Gum trees, Koalas and Kangaroos, No Edelweiss)              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/356436#comment-356436" class="permalink" rel="bookmark">#39</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/js" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/js" typeof="sioc:UserAccount" property="foaf:name" datatype="">js</a></span>: </span>
              <span class="date-time">Mon. Mar 31, 2008 - 12:12 AM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-7d0a10757265721b975a9c0b2a3838f5 rate-comment-356436-3-3 rate-processed" id="rate-comment-356436-3-3--2"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-441">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-442">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-443">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-444">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-445">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p>I have done a bit more playing with this (I see the tutorial is out) and managed to get the firmware to read the signature bytes directly out of the chip as the M164 family supports this.</p>
<p>It works with M164 and M324 but I can't get the M644 to work because no matter which chip is selected it always seems to compile at 0x3800. So it will work with the Dragon attached in debug mode but not in standaldone mode with the M644 as the code is not at the right location.</p>
<p>What are the incantation words to use so it will compile at the correct locations for all 3 chips? (ie the equ of .org :(  something to do with the .init9 ?? )</p>
<p>I have also added an internal pull up to the bootloader select pin as the board I'm using has just a link to ground.</p>
<p>edit ok I see that the original makefile has the correct .text address but the one generated by Studio stays at:<br>
</p><div class="bb-quote">
<blockquote class="bb-quote-body">
<pre>LDFLAGS += -Wl,-section-start=.text=0x3800</pre></blockquote>
</div>
<p> regardless of the chip selected, M164, M324 or M644. </p>
<p>A BUG???</p>
</div></div></div><span property="foaf:name" content="js" class="rdf-meta"></span>        </div>
                                  <div class="author-signature">
            <p>John Samperi</p>
<p>Ampertronics Pty. Ltd.</p>
<p><a href="http://www.ampertronics.com.au/" target="_blank">www.ampertronics.com.au</a></p>
<p>* Electronic Design * Custom Products * Contract Assembly</p>
          </div>
                      </div>
    </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<a id="comment-356453"></a>

<a id="forum-topic-top"></a>
<div id="post-356453" class="forum-post clearfix en posted-by-42662 odd comment-with-picture  " about="/comment/356453#comment-356453" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><img src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/offline.png"><a href="http://community.atmel.com/users/curtvm-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/curtvm-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">curtvm</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/curtvm-0" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/picture-default.jpg" alt="curtvm&#39;s picture" title="curtvm&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Raving Lunatic              </div>
      <div class="forum-post-panel-joined">
                  Joined: Wed. Sep 21, 2005              </div>
      <div class="forum-post-panel-posts">
                  Posts: 2328 <a href="http://community.atmel.com/user/42662/content">View posts</a>              </div>
      <div class="forum-post-user-location">
              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/356453#comment-356453" class="permalink" rel="bookmark">#40</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/curtvm-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/curtvm-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">curtvm</a></span>: </span>
              <span class="date-time">Mon. Mar 31, 2008 - 01:21 AM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-20de76fc4ab583b49d21d65eb7f46d14 rate-comment-356453-3-3 rate-processed" id="rate-comment-356453-3-3--2"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-446">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-447">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-448">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-449">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-450">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p>You have to change the AVR Studio memory settings-<br>
<a href="http://www.avrfreaks.net/index.php?name=PNphpBB2&amp;file=viewtopic&amp;p=419323#419323" target="_blank">http://www.avrfreaks.net/index.p...</a></p>
<p>It will not change by itself. No incantation words will help (I'm assuming words already tried did not help).</p>
</div></div></div><span property="foaf:name" content="curtvm" class="rdf-meta"></span>        </div>
                                      </div>
    </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<a id="comment-356454"></a>

<a id="forum-topic-top"></a>
<div id="post-356454" class="forum-post clearfix en posted-by-38341 post-by-starter even comment-with-picture  " about="/comment/356454#comment-356454" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><a href="http://community.atmel.com/users/smileymicros-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/smileymicros-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">smileymicros</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/smileymicros-0" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/picture-38341-1410020303.jpg" alt="smileymicros&#39;s picture" title="smileymicros&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Raving Lunatic              </div>
      <div class="forum-post-panel-joined">
                  Joined: Wed. Nov 17, 2004              </div>
      <div class="forum-post-panel-posts">
                  Posts: 6299 <a href="http://community.atmel.com/user/38341/content">View posts</a>              </div>
      <div class="forum-post-user-location">
                  Location: Great Smokey Mountains.              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/356454#comment-356454" class="permalink" rel="bookmark">#41</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/smileymicros-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/smileymicros-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">smileymicros</a></span>: </span>
              <span class="date-time">Mon. Mar 31, 2008 - 01:24 AM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-bf073fb85c192c4ffb8754ed173a7e1f rate-comment-356454-3-3 rate-processed" id="rate-comment-356454-3-3--2"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-451">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-452">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-453">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-454">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-455">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p>I no longer mess with the makefile. This will be discussed in the soon to be released tutorial, but for now you need to set the boot section in two places. First in AVRStudio Project menu Configurations Options, click the Memory Settings Icon and then in the Memory Segments section click the Add button and add Memory Type 'Flash' Name '.text' Address 'Ox7e00'. Then in the AVR Programmer under the Fuses tab select the bootsize for 512 words and check the bootsz checkbox. Okay, that was a mouth full, but in the new tutorial I show pictures so it will be clearer. Anyway no need to mess with the makefile. Yeah!</p>
<p>Smiley</p>
</div></div></div><span property="foaf:name" content="smileymicros" class="rdf-meta"></span>        </div>
                                      </div>
    </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<a id="comment-356461"></a>

<a id="forum-topic-top"></a>
<div id="post-356461" class="forum-post clearfix en posted-by-1007 odd comment-with-picture comment-with-signature  " about="/comment/356461#comment-356461" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><a href="http://community.atmel.com/users/js" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/js" typeof="sioc:UserAccount" property="foaf:name" datatype="">js</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/js" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/picture-1007-1406680492.jpg" alt="js&#39;s picture" title="js&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Moderator              </div>
      <div class="forum-post-panel-joined">
                  Joined: Wed. Mar 28, 2001              </div>
      <div class="forum-post-panel-posts">
                  Posts: 25219 <a href="http://community.atmel.com/user/1007/content">View posts</a>              </div>
      <div class="forum-post-user-location">
                  Location: Sydney, Australia (Gum trees, Koalas and Kangaroos, No Edelweiss)              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/356461#comment-356461" class="permalink" rel="bookmark">#42</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/js" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/js" typeof="sioc:UserAccount" property="foaf:name" datatype="">js</a></span>: </span>
              <span class="date-time">Mon. Mar 31, 2008 - 01:53 AM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-07f88b2961e859f321a91ebe882a9a4b rate-comment-356461-3-3 rate-processed" id="rate-comment-356461-3-3--2"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-456">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-457">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-458">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-459">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-460">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p></p><div class="bb-quote">Quote:<blockquote class="bb-quote-body">click the Memory Settings Icon and then in the Memory Segments section click the Add button and add Memory Type 'Flash' Name '.text' Address 'Ox7e00'</blockquote></div> Thanks! I just discovered that and was about to post a " do not worry" message :oops: I still have the M164 settings there, self made bug. :oops:<p></p>
<p>I have to go for the larger bootsize for now (using 0x7c00) as the signature file reading bit is pushing the code just over the egde. I think I can trim it down.</p>
<p>This is just playing around as it is not really useful for older chips without that facility.</p>
<p>Is <avr interrupt.h="" rel="nofollow"> really needed? I don't see any actual interrupt service routines. Will this possibly remove the dead code for the interrupt handlers? A lot of wasted flash there.</avr></p>
<div class="bb-quote">
<blockquote class="bb-quote-body">
<pre>f800 &lt;__vectors&gt;:
    f800:	0c 94 3e 7c 	jmp	0xf87c	; 0xf87c &lt;__ctors_end&gt;
    f804:	0c 94 5d 7c 	jmp	0xf8ba	; 0xf8ba &lt;__bad_interrupt&gt;
    f808:	0c 94 5d 7c 	jmp	0xf8ba	; 0xf8ba &lt;__bad_interrupt&gt;
    f80c:	0c 94 5d 7c 	jmp	0xf8ba	; 0xf8ba &lt;__bad_interrupt&gt;
    f810:	0c 94 5d 7c 	jmp	0xf8ba	; 0xf8ba &lt;__bad_interrupt&gt;
    f814:	0c 94 5d 7c 	jmp	0xf8ba	; 0xf8ba &lt;__bad_interrupt&gt;
    f818:	0c 94 5d 7c 	jmp	0xf8ba	; 0xf8ba &lt;__bad_interrupt&gt;
    f81c:	0c 94 5d 7c 	jmp	0xf8ba	; 0xf8ba &lt;__bad_interrupt&gt;
    f820:	0c 94 5d 7c 	jmp	0xf8ba	; 0xf8ba &lt;__bad_interrupt&gt;
    f824:	0c 94 5d 7c 	jmp	0xf8ba	; 0xf8ba &lt;__bad_interrupt&gt;
    f828:	0c 94 5d 7c 	jmp	0xf8ba	; 0xf8ba &lt;__bad_interrupt&gt;
    f82c:	0c 94 5d 7c 	jmp	0xf8ba	; 0xf8ba &lt;__bad_interrupt&gt;
    f830:	0c 94 5d 7c 	jmp	0xf8ba	; 0xf8ba &lt;__bad_interrupt&gt;
    f834:	0c 94 5d 7c 	jmp	0xf8ba	; 0xf8ba &lt;__bad_interrupt&gt;
    f838:	0c 94 5d 7c 	jmp	0xf8ba	; 0xf8ba &lt;__bad_interrupt&gt;
    f83c:	0c 94 5d 7c 	jmp	0xf8ba	; 0xf8ba &lt;__bad_interrupt&gt;
    f840:	0c 94 5d 7c 	jmp	0xf8ba	; 0xf8ba &lt;__bad_interrupt&gt;
    f844:	0c 94 5d 7c 	jmp	0xf8ba	; 0xf8ba &lt;__bad_interrupt&gt;
    f848:	0c 94 5d 7c 	jmp	0xf8ba	; 0xf8ba &lt;__bad_interrupt&gt;
    f84c:	0c 94 5d 7c 	jmp	0xf8ba	; 0xf8ba &lt;__bad_interrupt&gt;
    f850:	0c 94 5d 7c 	jmp	0xf8ba	; 0xf8ba &lt;__bad_interrupt&gt;
    f854:	0c 94 5d 7c 	jmp	0xf8ba	; 0xf8ba &lt;__bad_interrupt&gt;
    f858:	0c 94 5d 7c 	jmp	0xf8ba	; 0xf8ba &lt;__bad_interrupt&gt;
    f85c:	0c 94 5d 7c 	jmp	0xf8ba	; 0xf8ba &lt;__bad_interrupt&gt;
    f860:	0c 94 5d 7c 	jmp	0xf8ba	; 0xf8ba &lt;__bad_interrupt&gt;
    f864:	0c 94 5d 7c 	jmp	0xf8ba	; 0xf8ba &lt;__bad_interrupt&gt;
    f868:	0c 94 5d 7c 	jmp	0xf8ba	; 0xf8ba &lt;__bad_interrupt&gt;
    f86c:	0c 94 5d 7c 	jmp	0xf8ba	; 0xf8ba &lt;__bad_interrupt&gt;
    f870:	0c 94 5d 7c 	jmp	0xf8ba	; 0xf8ba &lt;__bad_interrupt&gt;
    f874:	0c 94 5d 7c 	jmp	0xf8ba	; 0xf8ba &lt;__bad_interrupt&gt;
    f878:	0c 94 5d 7c 	jmp	0xf8ba	; 0xf8ba &lt;__bad_interrupt&gt;</pre></blockquote>
</div>
</div></div></div><span property="foaf:name" content="js" class="rdf-meta"></span>        </div>
                                  <div class="author-signature">
            <p>John Samperi</p>
<p>Ampertronics Pty. Ltd.</p>
<p><a href="http://www.ampertronics.com.au/" target="_blank">www.ampertronics.com.au</a></p>
<p>* Electronic Design * Custom Products * Contract Assembly</p>
          </div>
                      </div>
    </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<a id="comment-356468"></a>

<a id="forum-topic-top"></a>
<div id="post-356468" class="forum-post clearfix en posted-by-38341 post-by-starter even comment-with-picture  " about="/comment/356468#comment-356468" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><a href="http://community.atmel.com/users/smileymicros-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/smileymicros-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">smileymicros</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/smileymicros-0" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/picture-38341-1410020303.jpg" alt="smileymicros&#39;s picture" title="smileymicros&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Raving Lunatic              </div>
      <div class="forum-post-panel-joined">
                  Joined: Wed. Nov 17, 2004              </div>
      <div class="forum-post-panel-posts">
                  Posts: 6299 <a href="http://community.atmel.com/user/38341/content">View posts</a>              </div>
      <div class="forum-post-user-location">
                  Location: Great Smokey Mountains.              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/356468#comment-356468" class="permalink" rel="bookmark">#43</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/smileymicros-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/smileymicros-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">smileymicros</a></span>: </span>
              <span class="date-time">Mon. Mar 31, 2008 - 02:37 AM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-7191a3d03664b1fe7963a474451ac584 rate-comment-356468-3-3 rate-processed" id="rate-comment-356468-3-3--2"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-461">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-462">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-463">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-464">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-465">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p>I don't think removing the interrupt header will do anything, but there is something that can be done to keep from wasting all that space putting the interrupt handler vectors in the boot section, problem is that I don't remember what. I'll make a not to make sure to cover this in the final tutorial which I'll work on tomorrow.</p>
<p>Smiley</p>
</div></div></div><span property="foaf:name" content="smileymicros" class="rdf-meta"></span>        </div>
                                      </div>
    </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<a id="comment-356471"></a>

<a id="forum-topic-top"></a>
<div id="post-356471" class="forum-post clearfix en posted-by-42662 odd comment-with-picture  " about="/comment/356471#comment-356471" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><img src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/offline.png"><a href="http://community.atmel.com/users/curtvm-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/curtvm-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">curtvm</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/curtvm-0" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/picture-default.jpg" alt="curtvm&#39;s picture" title="curtvm&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Raving Lunatic              </div>
      <div class="forum-post-panel-joined">
                  Joined: Wed. Sep 21, 2005              </div>
      <div class="forum-post-panel-posts">
                  Posts: 2328 <a href="http://community.atmel.com/user/42662/content">View posts</a>              </div>
      <div class="forum-post-user-location">
              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/356471#comment-356471" class="permalink" rel="bookmark">#44</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/curtvm-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/curtvm-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">curtvm</a></span>: </span>
              <span class="date-time">Mon. Mar 31, 2008 - 03:09 AM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-53e6ec39b7a292bb18e402c950b54d67 rate-comment-356471-3-3 rate-processed" id="rate-comment-356471-3-3--2"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-466">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-467">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-468">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-469">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-470">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p>linker option<br>
-nostartfiles</p>
<p>but then you need to take care of a few details yourself.<br>
<a href="http://www.avrfreaks.net/index.php?name=PNphpBB2&amp;file=viewtopic&amp;p=419922#419922" target="_blank">http://www.avrfreaks.net/index.p...</a></p>
</div></div></div><span property="foaf:name" content="curtvm" class="rdf-meta"></span>        </div>
                                      </div>
    </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<a id="comment-356473"></a>

<a id="forum-topic-top"></a>
<div id="post-356473" class="forum-post clearfix en posted-by-1007 even comment-with-picture comment-with-signature  " about="/comment/356473#comment-356473" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><a href="http://community.atmel.com/users/js" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/js" typeof="sioc:UserAccount" property="foaf:name" datatype="">js</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/js" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/picture-1007-1406680492.jpg" alt="js&#39;s picture" title="js&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Moderator              </div>
      <div class="forum-post-panel-joined">
                  Joined: Wed. Mar 28, 2001              </div>
      <div class="forum-post-panel-posts">
                  Posts: 25219 <a href="http://community.atmel.com/user/1007/content">View posts</a>              </div>
      <div class="forum-post-user-location">
                  Location: Sydney, Australia (Gum trees, Koalas and Kangaroos, No Edelweiss)              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/356473#comment-356473" class="permalink" rel="bookmark">#45</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/js" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/js" typeof="sioc:UserAccount" property="foaf:name" datatype="">js</a></span>: </span>
              <span class="date-time">Mon. Mar 31, 2008 - 03:15 AM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-74ad4b63840bcdd2baf14e5bc65d08e9 rate-comment-356473-3-3 rate-processed" id="rate-comment-356473-3-3--2"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-471">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-472">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-473">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-474">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-475">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p></p><div class="bb-quote">Quote:<blockquote class="bb-quote-body">I don't think removing the interrupt header will do anything, </blockquote></div> True, just tried it.<p></p>
<p>Apart from that it's all happy now for all 3 chips once I get the .text thingy adjusted for each type of chip.</p>
<p>For anyone that may want to try the reading of the signature bytes here are the changes. Pretty ugly code as I don't really understand how to use register and bit names with inline asm. Also 12 bytes could be saved if the push and pop are not needed (not sure about that).</p>
<p>It pushes the size of the code to 1042 unfortunately...now if we can get rid of the dead int pointers... :) and of course it only works for the M164 family and M640 AFAIK and I guess other new chips<br>
</p><div class="bb-quote">
<blockquote class="bb-quote-body">
<pre>1st change:
// Signature bytes for ATmega32 
//#define   SIGNATURE_BYTE_1      0x1E 
//#define   SIGNATURE_BYTE_2      0x95 
//#define   SIGNATURE_BYTE_3      0x02 

volatile uint8_t SIGNATURE_BYTE_1, SIGNATURE_BYTE_2, SIGNATURE_BYTE_3;
...
...

the code itself

void readSignatureBytes(void) // 's' 
{ 
asm volatile(
	"push	r24\n\t"
	"push	r30\n\t"
	"push	r31\n\t"
	"clr	r30\n\t"		//point z to 0x0000 1st sig byte
	"clr	r31\n\t"
	"rcall	read_sig\n\t"
	"sts	SIGNATURE_BYTE_1,r24\n\t"

	"adiw	r30,2\n\t"		//point z to 0x0002 2nd sig byte
	"rcall	read_sig\n\t"
	"sts	SIGNATURE_BYTE_2,r24\n\t"

	"adiw	r30,2\n\t"		//point z to 0x0004 3rd sig byte
	"rcall	read_sig\n\t"
	"sts	SIGNATURE_BYTE_3,r24\n\t"
	"rjmp	read_sig_exit\n\t"

	"read_sig:\n\t"
	"ldi	r24,0x21\n\t"
	"out	0x37,r24\n\t"
	"lpm	r24,z\n\t"
	"ret\n\t"

	"read_sig_exit:\n\t"
	"pop	r31\n\t"
	"pop	r30\n\t"
	"pop	r24\n\t"
	::);

	sendByte( SIGNATURE_BYTE_3 ); 
    sendByte( SIGNATURE_BYTE_2 ); 
    sendByte( SIGNATURE_BYTE_1 ); 
} </pre></blockquote>
</div>
<p> This is frightening I even defined the 3 variables as volatile :o</p>
</div></div></div><span property="foaf:name" content="js" class="rdf-meta"></span>        </div>
                                  <div class="author-signature">
            <p>John Samperi</p>
<p>Ampertronics Pty. Ltd.</p>
<p><a href="http://www.ampertronics.com.au/" target="_blank">www.ampertronics.com.au</a></p>
<p>* Electronic Design * Custom Products * Contract Assembly</p>
          </div>
                      </div>
    </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<a id="comment-356475"></a>

<a id="forum-topic-top"></a>
<div id="post-356475" class="forum-post clearfix en posted-by-1007 odd comment-with-picture comment-with-signature  " about="/comment/356475#comment-356475" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><a href="http://community.atmel.com/users/js" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/js" typeof="sioc:UserAccount" property="foaf:name" datatype="">js</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/js" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/picture-1007-1406680492.jpg" alt="js&#39;s picture" title="js&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Moderator              </div>
      <div class="forum-post-panel-joined">
                  Joined: Wed. Mar 28, 2001              </div>
      <div class="forum-post-panel-posts">
                  Posts: 25219 <a href="http://community.atmel.com/user/1007/content">View posts</a>              </div>
      <div class="forum-post-user-location">
                  Location: Sydney, Australia (Gum trees, Koalas and Kangaroos, No Edelweiss)              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/356475#comment-356475" class="permalink" rel="bookmark">#46</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/js" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/js" typeof="sioc:UserAccount" property="foaf:name" datatype="">js</a></span>: </span>
              <span class="date-time">Mon. Mar 31, 2008 - 03:25 AM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-64ef47476a75410fc0e40b36c28590e9 rate-comment-356475-3-3 rate-processed" id="rate-comment-356475-3-3--2"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-476">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-477">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-478">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-479">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-480">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p></p><div class="bb-quote">Quote:<blockquote class="bb-quote-body">linker option<br>
-nostartfiles<br>
</blockquote></div> I can see that now in the source file. Any hints on how to do this with the Studio config options? :)<p></p>
<p>It took out the origin address and the code starts at 0 with the vectors still there :(</p>
</div></div></div><span property="foaf:name" content="js" class="rdf-meta"></span>        </div>
                                  <div class="author-signature">
            <p>John Samperi</p>
<p>Ampertronics Pty. Ltd.</p>
<p><a href="http://www.ampertronics.com.au/" target="_blank">www.ampertronics.com.au</a></p>
<p>* Electronic Design * Custom Products * Contract Assembly</p>
          </div>
                      </div>
    </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<a id="comment-356477"></a>

<a id="forum-topic-top"></a>
<div id="post-356477" class="forum-post clearfix en posted-by-42662 even comment-with-picture  " about="/comment/356477#comment-356477" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><img src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/offline.png"><a href="http://community.atmel.com/users/curtvm-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/curtvm-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">curtvm</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/curtvm-0" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/picture-default.jpg" alt="curtvm&#39;s picture" title="curtvm&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Raving Lunatic              </div>
      <div class="forum-post-panel-joined">
                  Joined: Wed. Sep 21, 2005              </div>
      <div class="forum-post-panel-posts">
                  Posts: 2328 <a href="http://community.atmel.com/user/42662/content">View posts</a>              </div>
      <div class="forum-post-user-location">
              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/356477#comment-356477" class="permalink" rel="bookmark">#47</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/curtvm-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/curtvm-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">curtvm</a></span>: </span>
              <span class="date-time">Mon. Mar 31, 2008 - 03:47 AM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-95b7c9721dd3694803c8c9645fc3651a rate-comment-356477-3-3 rate-processed" id="rate-comment-356477-3-3--2"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-481">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-482">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-483">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-484">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-485">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p></p><div class="bb-quote">Quote:<blockquote class="bb-quote-body">This is frightening </blockquote></div>what's frightening is all that assembly code that could be replaced with a few C lines :)<p></p>
<p>Project-&gt;Configuration Options-&gt;Custom Options-&gt;<br>
select [Linker options],<br>
type in -nostartfiles,<br>
click add</p>
<p>add this to your code-<br>
</p><div class="bb-quote">
<blockquote class="bb-quote-body">
<pre>int main (void) __attribute__ ((naked,section (".init9")));
void my_crt (void) __attribute__ ((naked,section (".init0")));
void my_crt (void){
    asm volatile ( "clr __zero_reg__" );
    SREG=0; //newer crt1.S does this
    SP=RAMEND;
}</pre></blockquote>
</div>
<p>that will get r1 cleared (before its used to clear bss data), clear sreg (I assume to cli), and set the stack. The normal data/bss thing still happens right after that (you need -nodefaultlibs to get rid of that). Then main is positioned at .init9 so it is the first thing to run after the startup stuff.</p>
</div></div></div><span property="foaf:name" content="curtvm" class="rdf-meta"></span>        </div>
                                      </div>
    </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<a id="comment-356488"></a>

<a id="forum-topic-top"></a>
<div id="post-356488" class="forum-post clearfix en posted-by-1007 odd comment-with-picture comment-with-signature  " about="/comment/356488#comment-356488" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><a href="http://community.atmel.com/users/js" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/js" typeof="sioc:UserAccount" property="foaf:name" datatype="">js</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/js" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/picture-1007-1406680492.jpg" alt="js&#39;s picture" title="js&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Moderator              </div>
      <div class="forum-post-panel-joined">
                  Joined: Wed. Mar 28, 2001              </div>
      <div class="forum-post-panel-posts">
                  Posts: 25219 <a href="http://community.atmel.com/user/1007/content">View posts</a>              </div>
      <div class="forum-post-user-location">
                  Location: Sydney, Australia (Gum trees, Koalas and Kangaroos, No Edelweiss)              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/356488#comment-356488" class="permalink" rel="bookmark">#48</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/js" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/js" typeof="sioc:UserAccount" property="foaf:name" datatype="">js</a></span>: </span>
              <span class="date-time">Mon. Mar 31, 2008 - 04:37 AM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-362dd4e25f7050aa1aa54381e6e83980 rate-comment-356488-3-3 rate-processed" id="rate-comment-356488-3-3--2"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-486">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-487">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-488">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-489">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-490">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p></p><div class="bb-quote">Quote:<blockquote class="bb-quote-body">all that assembly code that could be replaced with a few C lines </blockquote></div> Go for it :) <p></p>
<p>I'll wait for the new and improved source tomorrow???</p>
<p>by the way since I put the -nostartfile the code has gone back to 0x0000 no matter what, even deleted all generated files including the makefile.</p>
<p>Now I still have </p>
<div class="bb-quote">
<blockquote class="bb-quote-body">
<pre>LDFLAGS += -Wl,-section-start=.txt=0xf800</pre></blockquote>
</div>
<p> but it generates<br>
</p><div class="bb-quote">
<blockquote class="bb-quote-body">
<pre>00000000 &lt;__vectors&gt;:
   0:	0c 94 3e 00 	jmp	0x7c	; 0x7c &lt;__ctors_end&gt;
   4:	0c 94 5d 00 	jmp	0xba	; 0xba &lt;__bad_interrupt&gt;
   8:	0c 94 5d 00 	jmp	0xba	; 0xba &lt;__bad_interrupt&gt;
</pre></blockquote>
</div>
<p> no matter what I do and yes I have deleted the -nostartfile from the options.</p>
</div></div></div><span property="foaf:name" content="js" class="rdf-meta"></span>        </div>
                                  <div class="author-signature">
            <p>John Samperi</p>
<p>Ampertronics Pty. Ltd.</p>
<p><a href="http://www.ampertronics.com.au/" target="_blank">www.ampertronics.com.au</a></p>
<p>* Electronic Design * Custom Products * Contract Assembly</p>
          </div>
                      </div>
    </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<a id="comment-356624"></a>

<a id="forum-topic-top"></a>
<div id="post-356624" class="forum-post clearfix en posted-by-38341 post-by-starter even comment-with-picture  " about="/comment/356624#comment-356624" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><a href="http://community.atmel.com/users/smileymicros-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/smileymicros-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">smileymicros</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/smileymicros-0" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/picture-38341-1410020303.jpg" alt="smileymicros&#39;s picture" title="smileymicros&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Raving Lunatic              </div>
      <div class="forum-post-panel-joined">
                  Joined: Wed. Nov 17, 2004              </div>
      <div class="forum-post-panel-posts">
                  Posts: 6299 <a href="http://community.atmel.com/user/38341/content">View posts</a>              </div>
      <div class="forum-post-user-location">
                  Location: Great Smokey Mountains.              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/356624#comment-356624" class="permalink" rel="bookmark">#49</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/smileymicros-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/smileymicros-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">smileymicros</a></span>: </span>
              <span class="date-time">Mon. Mar 31, 2008 - 02:45 PM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-cd8070f3df63493b4a20fee62a8ea685 rate-comment-356624-3-3 rate-processed" id="rate-comment-356624-3-3--2"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-491">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-492">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-493">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-494">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-495">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p></p><div class="bb-quote"><b>curtvm wrote:</b><blockquote class="bb-quote-body"><div class="bb-quote">Quote:<blockquote class="bb-quote-body">This is frightening </blockquote></div>what's frightening is all that assembly code that could be replaced with a few C lines :)<p></p>
<p>Project-&gt;Configuration Options-&gt;Custom Options-&gt;<br>
select [Linker options],<br>
type in -nostartfiles,<br>
click add</p>
<p>add this to your code-<br>
</p><div class="bb-quote">
<blockquote class="bb-quote-body">
<pre>int main (void) __attribute__ ((naked,section (".init9")));
void my_crt (void) __attribute__ ((naked,section (".init0")));
void my_crt (void){
    asm volatile ( "clr __zero_reg__" );
    SREG=0; //newer crt1.S does this
    SP=RAMEND;
}</pre></blockquote>
</div>
<p>that will get r1 cleared (before its used to clear bss data), clear sreg (I assume to cli), and set the stack. The normal data/bss thing still happens right after that (you need -nodefaultlibs to get rid of that). Then main is positioned at .init9 so it is the first thing to run after the startup stuff.</p></blockquote></div><p></p>
<p>I'm using the following from Peter Fluery:<br>
</p><div class="bb-quote">
<blockquote class="bb-quote-body">
<pre>// From Peter Fluery AVRFreaks Aug 10 2005 - to remove interrupt Vector table
void __jumpMain     (void) __attribute__ ((naked)) __attribute__ ((section (".init9")));

void __jumpMain(void)
{   
    asm volatile ( ".set __stack, %0" :: "i" (RAMEND) );
    asm volatile ( "clr __zero_reg__" );        // r1 set to 0
    asm volatile ( "rjmp main");                // jump to main()
} 
</pre></blockquote>
</div>
<p>Frankly, I'm not sure what difference either makes. I'll do a bit more research on it. </p>
<p>Smiley</p>
</div></div></div><span property="foaf:name" content="smileymicros" class="rdf-meta"></span>        </div>
                                      </div>
    </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<a id="comment-356636"></a>

<a id="forum-topic-top"></a>
<div id="post-356636" class="forum-post clearfix en posted-by-42662 odd comment-with-picture  " about="/comment/356636#comment-356636" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><img src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/offline.png"><a href="http://community.atmel.com/users/curtvm-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/curtvm-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">curtvm</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/curtvm-0" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/picture-default.jpg" alt="curtvm&#39;s picture" title="curtvm&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Raving Lunatic              </div>
      <div class="forum-post-panel-joined">
                  Joined: Wed. Sep 21, 2005              </div>
      <div class="forum-post-panel-posts">
                  Posts: 2328 <a href="http://community.atmel.com/user/42662/content">View posts</a>              </div>
      <div class="forum-post-user-location">
              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/356636#comment-356636" class="permalink" rel="bookmark">#50</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/curtvm-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/curtvm-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">curtvm</a></span>: </span>
              <span class="date-time">Mon. Mar 31, 2008 - 03:14 PM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-9339e779ec4ac638e78d8eebcfed9202 rate-comment-356636-3-3 rate-processed" id="rate-comment-356636-3-3--2"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-496">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-497">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-498">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-499">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-500">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p>There's many ways to do the same thing, but in the Fluery example, r1 is not cleared until .init9, which comes AFTER the bss clearing which uses r1 (since you are still using the libgcc.a startup code). So his example will leave bss data in the state of whatever r1 happens to be. Maybe your code happens to not need any initialized bss data.</p>
<p>In my example, .init0 runs first- which clears r1,sets stack, (and clears sreg as the newer crt1.S does), then it continues to .init4 which sets up the data and clears bss, then it continues to .init9 (before .text). Since 'main' was told to start at .init9, it will be the first to run (no other functions can sneak in, since other functions start at .text).</p>
<p>.vectors (no longer used) (-nostartfiles)<br>
.init0 -new startup stuff<br>
.init4 -normal data/bss stuff<br>
.init9 -main starts here<br>
.text -the rest of the app</p>
</div></div></div><span property="foaf:name" content="curtvm" class="rdf-meta"></span>        </div>
                                      </div>
    </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<a id="comment-356653"></a>

<a id="forum-topic-top"></a>
<div id="post-356653" class="forum-post clearfix en posted-by-42662 even comment-with-picture  " about="/comment/356653#comment-356653" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><img src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/offline.png"><a href="http://community.atmel.com/users/curtvm-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/curtvm-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">curtvm</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/curtvm-0" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/picture-default.jpg" alt="curtvm&#39;s picture" title="curtvm&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Raving Lunatic              </div>
      <div class="forum-post-panel-joined">
                  Joined: Wed. Sep 21, 2005              </div>
      <div class="forum-post-panel-posts">
                  Posts: 2328 <a href="http://community.atmel.com/user/42662/content">View posts</a>              </div>
      <div class="forum-post-user-location">
              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/356653#comment-356653" class="permalink" rel="bookmark">#51</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/curtvm-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/curtvm-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">curtvm</a></span>: </span>
              <span class="date-time">Mon. Mar 31, 2008 - 04:16 PM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-bac221f364fb4e123386267c11db2d3a rate-comment-356653-3-3 rate-processed" id="rate-comment-356653-3-3--2"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-501">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-502">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-503">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-504">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-505">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p></p><div class="bb-quote">Quote:<blockquote class="bb-quote-body">I'll wait for the new and improved source tomorrow??? </blockquote></div>simple, inefficient version-<br>
<div class="bb-quote">
<blockquote class="bb-quote-body">
<pre>#if defined(SIGRD)
void readSignatureBytes(void){ // 's'
    sendByte(boot_signature_byte_get(4));
    sendByte(boot_signature_byte_get(2));
    sendByte(boot_signature_byte_get(0));
}
#endif</pre></blockquote>
</div>
<p>a little better<br>
</p><div class="bb-quote">
<blockquote class="bb-quote-body">
<pre>#if defined(SIGRD)
void readSignatureBytes(void){ // 's'
    uint8_t addr=4;
    while(addr!=254){
        sendByte(boot_signature_byte_get(addr));
        addr-=2;
    };
}
#endif</pre></blockquote>
</div>
<p>non-library version<br>
</p><div class="bb-quote">
<blockquote class="bb-quote-body">
<pre>#if defined(SIGRD)
void readSignatureBytes(void){ // 's'
    register volatile uint16_t Z asm("r30");
    Z=4;
    while(1){
        SPMCSR=(1&lt;&lt;SIGRD)|(1&lt;&lt;SPMEN);
        asm volatile("lpm r24,z");
        asm volatile("call sendByte");
        if(!Z) break;
        Z-=2;
    };
}
#endif</pre></blockquote>
</div>
</div></div></div><span property="foaf:name" content="curtvm" class="rdf-meta"></span>        </div>
                                      </div>
    </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<a id="comment-356752"></a>

<a id="forum-topic-top"></a>
<div id="post-356752" class="forum-post clearfix en posted-by-1007 odd comment-with-picture comment-with-signature  " about="/comment/356752#comment-356752" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><a href="http://community.atmel.com/users/js" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/js" typeof="sioc:UserAccount" property="foaf:name" datatype="">js</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/js" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/picture-1007-1406680492.jpg" alt="js&#39;s picture" title="js&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Moderator              </div>
      <div class="forum-post-panel-joined">
                  Joined: Wed. Mar 28, 2001              </div>
      <div class="forum-post-panel-posts">
                  Posts: 25219 <a href="http://community.atmel.com/user/1007/content">View posts</a>              </div>
      <div class="forum-post-user-location">
                  Location: Sydney, Australia (Gum trees, Koalas and Kangaroos, No Edelweiss)              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/356752#comment-356752" class="permalink" rel="bookmark">#52</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/js" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/js" typeof="sioc:UserAccount" property="foaf:name" datatype="">js</a></span>: </span>
              <span class="date-time">Mon. Mar 31, 2008 - 10:29 PM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-4f0f22a99558651b203ed68a461701e7 rate-comment-356752-3-3 rate-processed" id="rate-comment-356752-3-3"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-506">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-507">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-508">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-509">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-510">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p>Have you actually tested any of the above?</p>
</div></div></div><span property="foaf:name" content="js" class="rdf-meta"></span>        </div>
                                  <div class="author-signature">
            <p>John Samperi</p>
<p>Ampertronics Pty. Ltd.</p>
<p><a href="http://www.ampertronics.com.au/" target="_blank">www.ampertronics.com.au</a></p>
<p>* Electronic Design * Custom Products * Contract Assembly</p>
          </div>
                      </div>
    </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<a id="comment-356777"></a>

<a id="forum-topic-top"></a>
<div id="post-356777" class="forum-post clearfix en posted-by-42662 even comment-with-picture  " about="/comment/356777#comment-356777" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><img src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/offline.png"><a href="http://community.atmel.com/users/curtvm-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/curtvm-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">curtvm</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/curtvm-0" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/picture-default.jpg" alt="curtvm&#39;s picture" title="curtvm&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Raving Lunatic              </div>
      <div class="forum-post-panel-joined">
                  Joined: Wed. Sep 21, 2005              </div>
      <div class="forum-post-panel-posts">
                  Posts: 2328 <a href="http://community.atmel.com/user/42662/content">View posts</a>              </div>
      <div class="forum-post-user-location">
              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/356777#comment-356777" class="permalink" rel="bookmark">#53</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/curtvm-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/curtvm-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">curtvm</a></span>: </span>
              <span class="date-time">Mon. Mar 31, 2008 - 11:29 PM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-5672054642f94375f0e3fcda5beff21c rate-comment-356777-3-3 rate-processed" id="rate-comment-356777-3-3"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-511">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-512">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-513">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-514">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-515">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p></p><div class="bb-quote">Quote:<blockquote class="bb-quote-body">Have you actually tested any of the above?</blockquote></div>Now you want me to test it too? I'm not by my 'stuff', so I just compiled it. The compiled code looked ok to me, but who knows. I would also need an avr that can read the signatures via spm (and I also would have to be motivated to actually try it, as I don't really care that much). You can tell me which versions above don't work, or if they all don't work, or you can just ignore them. Your choice.<p></p>
<p>I'm assuming in the first two that you are using winavr20071221. You would also need the 'if defined(SIGRD)' wherever you are checking for that 's' command (if avr doesn't have SIGRD, can't get signatures).</p>
</div></div></div><span property="foaf:name" content="curtvm" class="rdf-meta"></span>        </div>
                                      </div>
    </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<a id="comment-356780"></a>

<a id="forum-topic-top"></a>
<div id="post-356780" class="forum-post clearfix en posted-by-1007 odd comment-with-picture comment-with-signature  " about="/comment/356780#comment-356780" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><a href="http://community.atmel.com/users/js" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/js" typeof="sioc:UserAccount" property="foaf:name" datatype="">js</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/js" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/picture-1007-1406680492.jpg" alt="js&#39;s picture" title="js&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Moderator              </div>
      <div class="forum-post-panel-joined">
                  Joined: Wed. Mar 28, 2001              </div>
      <div class="forum-post-panel-posts">
                  Posts: 25219 <a href="http://community.atmel.com/user/1007/content">View posts</a>              </div>
      <div class="forum-post-user-location">
                  Location: Sydney, Australia (Gum trees, Koalas and Kangaroos, No Edelweiss)              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/356780#comment-356780" class="permalink" rel="bookmark">#54</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/js" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/js" typeof="sioc:UserAccount" property="foaf:name" datatype="">js</a></span>: </span>
              <span class="date-time">Mon. Mar 31, 2008 - 11:39 PM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-4cdaf5d6672748a4b374c2fd26aa8f4f rate-comment-356780-3-3 rate-processed" id="rate-comment-356780-3-3"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-516">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-517">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-518">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-519">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-520">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p></p><div class="bb-quote">Quote:<blockquote class="bb-quote-body">Now you want me to test it too? </blockquote></div> Will I get my money back if they don't work? :mrgreen:<p></p>
</div></div></div><span property="foaf:name" content="js" class="rdf-meta"></span>        </div>
                                  <div class="author-signature">
            <p>John Samperi</p>
<p>Ampertronics Pty. Ltd.</p>
<p><a href="http://www.ampertronics.com.au/" target="_blank">www.ampertronics.com.au</a></p>
<p>* Electronic Design * Custom Products * Contract Assembly</p>
          </div>
                      </div>
    </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<a id="comment-356808"></a>

<a id="forum-topic-top"></a>
<div id="post-356808" class="forum-post clearfix en posted-by-42662 even comment-with-picture  " about="/comment/356808#comment-356808" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><img src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/offline.png"><a href="http://community.atmel.com/users/curtvm-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/curtvm-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">curtvm</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/curtvm-0" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/picture-default.jpg" alt="curtvm&#39;s picture" title="curtvm&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Raving Lunatic              </div>
      <div class="forum-post-panel-joined">
                  Joined: Wed. Sep 21, 2005              </div>
      <div class="forum-post-panel-posts">
                  Posts: 2328 <a href="http://community.atmel.com/user/42662/content">View posts</a>              </div>
      <div class="forum-post-user-location">
              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/356808#comment-356808" class="permalink" rel="bookmark">#55</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/curtvm-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/curtvm-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">curtvm</a></span>: </span>
              <span class="date-time">Tue. Apr 1, 2008 - 01:32 AM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-d3364c37799034fe328f4ab69d4abf60 rate-comment-356808-3-3 rate-processed" id="rate-comment-356808-3-3"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-521">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-522">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-523">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-524">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-525">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p></p><div class="bb-quote">Quote:<blockquote class="bb-quote-body">Will I get my money back if they don't work?</blockquote></div>DOUBLE your money back.<p></p>
</div></div></div><span property="foaf:name" content="curtvm" class="rdf-meta"></span>        </div>
                                      </div>
    </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<a id="comment-356963"></a>

<a id="forum-topic-top"></a>
<div id="post-356963" class="forum-post clearfix en posted-by-42662 odd comment-with-picture  " about="/comment/356963#comment-356963" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><img src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/offline.png"><a href="http://community.atmel.com/users/curtvm-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/curtvm-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">curtvm</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/curtvm-0" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/picture-default.jpg" alt="curtvm&#39;s picture" title="curtvm&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Raving Lunatic              </div>
      <div class="forum-post-panel-joined">
                  Joined: Wed. Sep 21, 2005              </div>
      <div class="forum-post-panel-posts">
                  Posts: 2328 <a href="http://community.atmel.com/user/42662/content">View posts</a>              </div>
      <div class="forum-post-user-location">
              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/356963#comment-356963" class="permalink" rel="bookmark">#56</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/curtvm-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/curtvm-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">curtvm</a></span>: </span>
              <span class="date-time">Tue. Apr 1, 2008 - 02:15 PM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-d1ddd47b9191155d15e2bf9dccdb1718 rate-comment-356963-3-3 rate-processed" id="rate-comment-356963-3-3"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-526">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-527">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-528">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-529">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-530">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p>I should add that if you happen to use PROGMEM in your bootloaders (I don't think you are), and are removing the vector table, then a little different approach would be needed as .progmem is right after the .vectors section. You don't want that progmem section to start executing at the boot reset address, so this would be one way to handle it<br>
</p><div class="bb-quote">
<blockquote class="bb-quote-body">
<pre>//.vectors (reset address)
void skip_progmem(void) __attribute__ ((naked,section (".vectors")));
void skip_progmem(void){
    //skip over .progmem section
    asm volatile("rjmp my_crt");
}
//.progmem data is located here
//.init0
void my_crt (void) __attribute__ ((naked,section (".init0")));
void my_crt (void){
    asm volatile ( "clr __zero_reg__" );
    SREG=0; //newer crt1.S does this
    SP=RAMEND;
}
//.init1-.init8 - will run (if exists)
//.init9 - make sure main is the first to run
int main (void) __attribute__ ((naked,section (".init9")));
//.text - everything else will follow</pre></blockquote>
</div>
<p>This would  handle the occasions that progmem would be used (probably only needed with 'smart' bootloaders, as those relying on a pc app aren't going to be sending 'human readable' strings anyway). You end up with 1 unneeded rjmp if progmem is not used. This would be a good 'one-size-fits-almost-all' setup, but skip_progmem could be removed if not needed (and we are then back to my original code).</p>
<p>You can also edit the linker script to move progmem around, but linker scripts are best left untouched (mostly).</p>
</div></div></div><span property="foaf:name" content="curtvm" class="rdf-meta"></span>        </div>
                                      </div>
    </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<a id="comment-356976"></a>

<a id="forum-topic-top"></a>
<div id="post-356976" class="forum-post clearfix en posted-by-38341 post-by-starter even comment-with-picture  " about="/comment/356976#comment-356976" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><a href="http://community.atmel.com/users/smileymicros-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/smileymicros-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">smileymicros</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/smileymicros-0" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/picture-38341-1410020303.jpg" alt="smileymicros&#39;s picture" title="smileymicros&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Raving Lunatic              </div>
      <div class="forum-post-panel-joined">
                  Joined: Wed. Nov 17, 2004              </div>
      <div class="forum-post-panel-posts">
                  Posts: 6299 <a href="http://community.atmel.com/user/38341/content">View posts</a>              </div>
      <div class="forum-post-user-location">
                  Location: Great Smokey Mountains.              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/356976#comment-356976" class="permalink" rel="bookmark">#57</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/smileymicros-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/smileymicros-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">smileymicros</a></span>: </span>
              <span class="date-time">Tue. Apr 1, 2008 - 03:44 PM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-7ff6bd26147299d4357e20c89e1d7417 rate-comment-356976-3-3 rate-processed" id="rate-comment-356976-3-3"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-531">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-532">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-533">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-534">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-535">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p>curtvm,</p>
<p>Thanks for all the good information. I think I'll also spend some time learning the .initx and other location parameters since it is beginning to look like they may be useful after all.</p>
<p>Smiley</p>
</div></div></div><span property="foaf:name" content="smileymicros" class="rdf-meta"></span>        </div>
                                      </div>
    </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<a id="comment-357125"></a>

<a id="forum-topic-top"></a>
<div id="post-357125" class="forum-post clearfix en posted-by-1007 odd comment-with-picture comment-with-signature  " about="/comment/357125#comment-357125" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><a href="http://community.atmel.com/users/js" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/js" typeof="sioc:UserAccount" property="foaf:name" datatype="">js</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/js" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/picture-1007-1406680492.jpg" alt="js&#39;s picture" title="js&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Moderator              </div>
      <div class="forum-post-panel-joined">
                  Joined: Wed. Mar 28, 2001              </div>
      <div class="forum-post-panel-posts">
                  Posts: 25219 <a href="http://community.atmel.com/user/1007/content">View posts</a>              </div>
      <div class="forum-post-user-location">
                  Location: Sydney, Australia (Gum trees, Koalas and Kangaroos, No Edelweiss)              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/357125#comment-357125" class="permalink" rel="bookmark">#58</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/js" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/js" typeof="sioc:UserAccount" property="foaf:name" datatype="">js</a></span>: </span>
              <span class="date-time">Tue. Apr 1, 2008 - 11:09 PM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-019685118c4e2d8bbe3d70ec8c9e6e26 rate-comment-357125-3-3 rate-processed" id="rate-comment-357125-3-3"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-536">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-537">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-538">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-539">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-540">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p>My goodness curtvm, all that typing to achieve:</p>
<div class="bb-quote">
<blockquote class="bb-quote-body">
<pre>.org FIRSTBOOTSTART</pre></blockquote>
</div>
<p> and a couple of lines to init the stack and maybe clear the ram.</p>
<p>No wonder some people only use C on April 1.... :lol:</p>
</div></div></div><span property="foaf:name" content="js" class="rdf-meta"></span>        </div>
                                  <div class="author-signature">
            <p>John Samperi</p>
<p>Ampertronics Pty. Ltd.</p>
<p><a href="http://www.ampertronics.com.au/" target="_blank">www.ampertronics.com.au</a></p>
<p>* Electronic Design * Custom Products * Contract Assembly</p>
          </div>
                      </div>
    </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<a id="comment-357274"></a>

<a id="forum-topic-top"></a>
<div id="post-357274" class="forum-post clearfix en posted-by-42662 even comment-with-picture  " about="/comment/357274#comment-357274" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><img src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/offline.png"><a href="http://community.atmel.com/users/curtvm-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/curtvm-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">curtvm</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/curtvm-0" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/picture-default.jpg" alt="curtvm&#39;s picture" title="curtvm&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Raving Lunatic              </div>
      <div class="forum-post-panel-joined">
                  Joined: Wed. Sep 21, 2005              </div>
      <div class="forum-post-panel-posts">
                  Posts: 2328 <a href="http://community.atmel.com/user/42662/content">View posts</a>              </div>
      <div class="forum-post-user-location">
              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/357274#comment-357274" class="permalink" rel="bookmark">#59</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/curtvm-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/curtvm-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">curtvm</a></span>: </span>
              <span class="date-time">Wed. Apr 2, 2008 - 10:23 AM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-9fdcfde84250ea1e0b17c17497044dd3 rate-comment-357274-3-3 rate-processed" id="rate-comment-357274-3-3"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-541">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-542">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-543">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-544">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-545">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p></p><div class="bb-quote"><b>js wrote:</b><blockquote class="bb-quote-body">My goodness curtvm, all that typing to achieve:<p></p>
<div class="bb-quote">
<blockquote class="bb-quote-body">
<pre>.org FIRSTBOOTSTART</pre></blockquote>
</div>
<p></p></blockquote></div>Well, none of that typing had anything to do with where the bootloader code starts. You changed that in the avr studio memory settings earlier.<p></p>
</div></div></div><span property="foaf:name" content="curtvm" class="rdf-meta"></span>        </div>
                                      </div>
    </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<a id="comment-357697"></a>

<a id="forum-topic-top"></a>
<div id="post-357697" class="forum-post clearfix en posted-by-1007 odd comment-with-picture comment-with-signature  " about="/comment/357697#comment-357697" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><a href="http://community.atmel.com/users/js" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/js" typeof="sioc:UserAccount" property="foaf:name" datatype="">js</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/js" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/picture-1007-1406680492.jpg" alt="js&#39;s picture" title="js&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Moderator              </div>
      <div class="forum-post-panel-joined">
                  Joined: Wed. Mar 28, 2001              </div>
      <div class="forum-post-panel-posts">
                  Posts: 25219 <a href="http://community.atmel.com/user/1007/content">View posts</a>              </div>
      <div class="forum-post-user-location">
                  Location: Sydney, Australia (Gum trees, Koalas and Kangaroos, No Edelweiss)              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/357697#comment-357697" class="permalink" rel="bookmark">#60</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/js" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/js" typeof="sioc:UserAccount" property="foaf:name" datatype="">js</a></span>: </span>
              <span class="date-time">Thu. Apr 3, 2008 - 04:41 AM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-8309e70b2e2cf49618c6603231343260 rate-comment-357697-3-3 rate-processed" id="rate-comment-357697-3-3"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-546">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-547">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-548">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-549">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-550">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p>I have been doing a bit more reading and I see how the boot.h does the signature byte reading with boot_signature_byte_get, very nice.</p>
<p>So you'll be happy that no refund is necessary as the "simple, inefficient version" works well and I can get the code down to 1020 bytes, just inside the first bootloader space.<br>
Haven't tried the other versions.</p>
<p>Still confused about the various .initx thingy, maybe use one of the "Unused. User definable" and put a simple stack init and ram clearing code? It would be nice to get rid of the dead vectors. At least it would be a good exercise in getting to know things a bit deeper.</p>
</div></div></div><span property="foaf:name" content="js" class="rdf-meta"></span>        </div>
                                  <div class="author-signature">
            <p>John Samperi</p>
<p>Ampertronics Pty. Ltd.</p>
<p><a href="http://www.ampertronics.com.au/" target="_blank">www.ampertronics.com.au</a></p>
<p>* Electronic Design * Custom Products * Contract Assembly</p>
          </div>
                      </div>
    </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<a id="comment-357723"></a>

<a id="forum-topic-top"></a>
<div id="post-357723" class="forum-post clearfix en posted-by-1007 even comment-with-picture comment-with-signature  " about="/comment/357723#comment-357723" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><a href="http://community.atmel.com/users/js" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/js" typeof="sioc:UserAccount" property="foaf:name" datatype="">js</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/js" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/picture-1007-1406680492.jpg" alt="js&#39;s picture" title="js&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Moderator              </div>
      <div class="forum-post-panel-joined">
                  Joined: Wed. Mar 28, 2001              </div>
      <div class="forum-post-panel-posts">
                  Posts: 25219 <a href="http://community.atmel.com/user/1007/content">View posts</a>              </div>
      <div class="forum-post-user-location">
                  Location: Sydney, Australia (Gum trees, Koalas and Kangaroos, No Edelweiss)              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/357723#comment-357723" class="permalink" rel="bookmark">#61</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/js" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/js" typeof="sioc:UserAccount" property="foaf:name" datatype="">js</a></span>: </span>
              <span class="date-time">Thu. Apr 3, 2008 - 08:00 AM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-b93201f437b6734ee5a829a6ec87193e rate-comment-357723-3-3 rate-processed" id="rate-comment-357723-3-3"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-551">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-552">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-553">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-554">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-555">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p>OK Vectors gone!! :) size of code now 870 bytes and whats more it STILL works, downloaded my world famous flashing led program with AVROSPii and it's flashing.</p>
<p>I guess had I read the bit</p><div class="bb-quote">Quote:<blockquote class="bb-quote-body">// From Peter Fluery AVRFreaks Aug 10 2005 - to remove interrupt Vector table<br>
// put -nostartfiles in <span style="color:red"><span style="font-weight:bold">LDFlags</span></span>, add the following function<br>
// saves wasted space </blockquote></div> I could have had this working a lot earlier. :(<p></p>
<p>By just adding -nostartfiles into the Custom Option, it goes into the compiler directives instead of the LINKER directives.</p>
<p>By clicking on the [Linker Options] and THEN adding -nostartfiles, the vectors go away.</p>
</div></div></div><span property="foaf:name" content="js" class="rdf-meta"></span>        </div>
                                  <div class="author-signature">
            <p>John Samperi</p>
<p>Ampertronics Pty. Ltd.</p>
<p><a href="http://www.ampertronics.com.au/" target="_blank">www.ampertronics.com.au</a></p>
<p>* Electronic Design * Custom Products * Contract Assembly</p>
          </div>
                      </div>
    </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<a id="comment-357754"></a>

<a id="forum-topic-top"></a>
<div id="post-357754" class="forum-post clearfix en posted-by-42662 odd comment-with-picture  " about="/comment/357754#comment-357754" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><img src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/offline.png"><a href="http://community.atmel.com/users/curtvm-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/curtvm-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">curtvm</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/curtvm-0" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/picture-default.jpg" alt="curtvm&#39;s picture" title="curtvm&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Raving Lunatic              </div>
      <div class="forum-post-panel-joined">
                  Joined: Wed. Sep 21, 2005              </div>
      <div class="forum-post-panel-posts">
                  Posts: 2328 <a href="http://community.atmel.com/user/42662/content">View posts</a>              </div>
      <div class="forum-post-user-location">
              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/357754#comment-357754" class="permalink" rel="bookmark">#62</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/curtvm-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/curtvm-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">curtvm</a></span>: </span>
              <span class="date-time">Thu. Apr 3, 2008 - 11:19 AM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-881aaa2f61987dfb777386560fe303d9 rate-comment-357754-3-3 rate-processed" id="rate-comment-357754-3-3"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-556">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-557">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-558">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-559">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-560">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p>you could have simply read this post (was not so long ago)-<br>
<a href="http://www.avrfreaks.net/index.php?name=PNphpBB2&amp;file=viewtopic&amp;p=428154#428154" target="_blank">http://www.avrfreaks.net/index.p...</a></p>
<p>which was an answer to your question-</p><div class="bb-quote">Quote:<blockquote class="bb-quote-body">Any hints on how to do this with the Studio config options?</blockquote></div><p></p>
<p>Maybe I need to learn how to use <span style="color:red"><span style="font-weight:bold"><span style="font-size: 18px">RED</span></span></span> highlighting</p>
</div></div></div><span property="foaf:name" content="curtvm" class="rdf-meta"></span>        </div>
                                      </div>
    </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<a id="comment-357986"></a>

<a id="forum-topic-top"></a>
<div id="post-357986" class="forum-post clearfix en posted-by-1007 even comment-with-picture comment-with-signature  " about="/comment/357986#comment-357986" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><a href="http://community.atmel.com/users/js" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/js" typeof="sioc:UserAccount" property="foaf:name" datatype="">js</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/js" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/picture-1007-1406680492.jpg" alt="js&#39;s picture" title="js&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Moderator              </div>
      <div class="forum-post-panel-joined">
                  Joined: Wed. Mar 28, 2001              </div>
      <div class="forum-post-panel-posts">
                  Posts: 25219 <a href="http://community.atmel.com/user/1007/content">View posts</a>              </div>
      <div class="forum-post-user-location">
                  Location: Sydney, Australia (Gum trees, Koalas and Kangaroos, No Edelweiss)              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/357986#comment-357986" class="permalink" rel="bookmark">#63</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/js" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/js" typeof="sioc:UserAccount" property="foaf:name" datatype="">js</a></span>: </span>
              <span class="date-time">Thu. Apr 3, 2008 - 11:03 PM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-4d8c8bb4759a8b4eeb24e9721c18da80 rate-comment-357986-3-3 rate-processed" id="rate-comment-357986-3-3"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-561">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-562">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-563">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-564">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-565">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p>Do you mean something like:</p><div class="bb-quote">Quote:<blockquote class="bb-quote-body"> <span style="color:red"><span style="font-size: 24px">select [Linker options]</span>,</span><br>
</blockquote></div> :)<br>
yep, that would have helped, I skipped over that bit altogether. Didn't know that I had to click on the Linker options on the L/H windows, I thought that was just some display window.<p></p>
<p>I guess this proves that one cannot be too specific or too clear when explaining things to dummies. :(</p>
<p>does Red come in flashing too???</p>
</div></div></div><span property="foaf:name" content="js" class="rdf-meta"></span>        </div>
                                  <div class="author-signature">
            <p>John Samperi</p>
<p>Ampertronics Pty. Ltd.</p>
<p><a href="http://www.ampertronics.com.au/" target="_blank">www.ampertronics.com.au</a></p>
<p>* Electronic Design * Custom Products * Contract Assembly</p>
          </div>
                      </div>
    </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
<a id="comment-357996"></a>

<a id="forum-topic-top"></a>
<div id="post-357996" class="forum-post clearfix en posted-by-42662 odd last comment-with-picture  " about="/comment/357996#comment-357996" typeof="sioc:Post sioct:Comment">
    <div class="forum-post-info clearfix">        
    <div class="forum-author-name-block">
              <div class="author-pane"><img src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/offline.png"><a href="http://community.atmel.com/users/curtvm-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/curtvm-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">curtvm</a>  <div class="user-picture">
    <a href="http://community.atmel.com/users/curtvm-0" title="View user profile."><img typeof="foaf:Image" class="image-style-thumbnail" src="./Bootloader Pre-Tutorial Source Code - ATmega644 _ AVR Freaks_files/picture-default.jpg" alt="curtvm&#39;s picture" title="curtvm&#39;s picture"></a>  </div>
</div>          </div>
    <div class="forum-post-panel-sub">
      <div class="forum-post-user-rate">
                  Level: Raving Lunatic              </div>
      <div class="forum-post-panel-joined">
                  Joined: Wed. Sep 21, 2005              </div>
      <div class="forum-post-panel-posts">
                  Posts: 2328 <a href="http://community.atmel.com/user/42662/content">View posts</a>              </div>
      <div class="forum-post-user-location">
              </div>
          </div>
  </div>
    <div class="avr-forum-post-wrapper">
    <div class="avr-forum-post-panel-main clearfix">
      <div class="forum-post-upper-panel ">
        <div class="avr-forum-posted-on">
          <div class="forum-post-number">
                        <a href="http://www.avrfreaks.net/comment/357996#comment-357996" class="permalink" rel="bookmark">#64</a></div>
          <div class="forum-post-rating">
            <div class="post-date">
              <span class="label-text">Posted <span class="topic-posted-by"> by <a href="http://community.atmel.com/users/curtvm-0" title="View user profile." class="username" xml:lang="" about="http://community.atmel.com/users/curtvm-0" typeof="sioc:UserAccount" property="foaf:name" datatype="">curtvm</a></span>: </span>
              <span class="date-time">Thu. Apr 3, 2008 - 11:51 PM</span>                                        </div>
                          <div class="rating-widget">
                <div class="rate-widget-3 rate-widget clear-block rate-average rate-widget-fivestar rate-c103f5bd745f0dd24c9f653dd0165f35 rate-comment-357996-3-3 rate-processed" id="rate-comment-357996-3-3"><div class="item-list"><ul class="rate-fivestar-processed"><li class="even first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-566">1</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-567">2</span></li><li class="even"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-568">3</span></li><li class="odd"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-569">4</span></li><li class="even last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-570">5</span></li></ul></div><div class="rate-info">Total votes: 0</div></div>              
              </div>   
                      </div>
        </div>
      </div>
        <div class="forum-post-content">
          <span rel="sioc:reply_of" resource="/forum/bootloader-pre-tutorial-source-code-atmega644" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden view-mode-full"><div class="field-items"><div class="field-item even" property="content:encoded"><p></p><div class="bb-quote">Quote:<blockquote class="bb-quote-body">does Red come in flashing too???</blockquote></div>everyone may be sorry you showed me <span style="color:red">red</span> was possible. We hope flashing text is not possible.<p></p>
</div></div></div><span property="foaf:name" content="curtvm" class="rdf-meta"></span>        </div>
                                      </div>
    </div>
        <div class="forum-post-footer clearfix">
      <div class="forum-post-links">
        <ul class="links inline"><li class="comment_forbidden first last"><span><a href="http://www.avrfreaks.net/user/login?destination=node/58300%23comment-form">Log in</a> or <a href="http://www.avrfreaks.net/user/register?destination=node/58300%23comment-form">register</a> to post comments</span></li>
</ul>          <a href="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all#forum-topic-top" title="Jump to top of page" class="af-button-small"><span>Top</span></a>
      </div>
    </div>
</div>
    <div class="pane-avrfreaks-select"><form action="http://www.avrfreaks.net/forum/bootloader-pre-tutorial-source-code-atmega644?page=all" method="post" id="avrfreaks-forum-select-form" accept-charset="UTF-8" class="form hideSubmitButton-processed">
  <div>
        
  <div class="form-item form-type-select form-item-taxonomy-forum">
  <label for="edit-taxonomy-forum">Jump To </label>
 <select id="edit-taxonomy-forum" name="taxonomy_forum" class="form-select"><option value="http://www.avrfreaks.net/forums/avr-microcontrollers" class="level-2">-AVR Microcontrollers</option><option value="http://www.avrfreaks.net/forums/megaavr-and-tinyavr" class="level-3" selected="selected">--megaAVR and tinyAVR</option><option value="http://www.avrfreaks.net/forums/avr-xmega" class="level-3">--AVR XMEGA</option><option value="http://www.avrfreaks.net/forums/avr-uc3" class="level-3">--AVR UC3</option><option value="http://www.avrfreaks.net/forums/tools" class="level-2">-Tools</option><option value="http://www.avrfreaks.net/forums/arduino" class="level-3">--Arduino</option><option value="http://www.avrfreaks.net/forums/atmel-studio-avr-related" class="level-3">--Atmel Studio (AVR-related)</option><option value="http://www.avrfreaks.net/forums/atmel-software-framework-asf" class="level-3">--Atmel Software Framework (ASF)</option><option value="http://www.avrfreaks.net/forums/evaluation-and-development-kits" class="level-3">--Evaluation and Development Kits</option><option value="http://www.avrfreaks.net/forums/system-debuggers-and-programmers" class="level-3">--In-System Debuggers and Programmers</option><option value="http://www.avrfreaks.net/forums/compilers-and-general-programming" class="level-3">--Compilers and General Programming</option><option value="http://www.avrfreaks.net/forums/learning-and-information" class="level-2">-Learning and Information</option><option value="http://www.avrfreaks.net/forums/general-electronics" class="level-3">--General Electronics</option><option value="http://www.avrfreaks.net/forums/tutorials" class="level-3">--Tutorials</option><option value="http://www.avrfreaks.net/forums/avr-freaks-projects" class="level-3">--AVR Freaks Projects</option><option value="http://www.avrfreaks.net/forums/miscellaneous" class="level-2">-Miscellaneous</option><option value="http://www.avrfreaks.net/forums/marketplace" class="level-3">--Marketplace</option><option value="http://www.avrfreaks.net/forums/atmel-smart-arm-based-mcus" class="level-1">Atmel SMART ARM-based MCUs</option><option value="http://www.avrfreaks.net/forums/atmel-smart-arm-based-mcus-and-mpus" class="level-2">-Atmel SMART ARM-based MCUs and MPUs</option><option value="http://www.avrfreaks.net/forums/atmel-cortex-mpus" class="level-3">--Atmel Cortex-A MPUs</option><option value="http://www.avrfreaks.net/forums/atmel-cortex-m-mcus" class="level-3">--Atmel Cortex-M MCUs</option><option value="http://www.avrfreaks.net/forums/atmel-arm7-mcus" class="level-3">--Atmel ARM7 MCUs</option><option value="http://www.avrfreaks.net/forums/tools-1" class="level-2">-Tools</option><option value="http://www.avrfreaks.net/forums/evaluation-and-development-kits-arm-related" class="level-3">--Evaluation and Development Kits (ARM-related)</option><option value="http://www.avrfreaks.net/forums/system-debuggers-and-programmers-arm-related" class="level-3">--In-System Debuggers and Programmers (ARM-related)</option><option value="http://www.avrfreaks.net/forums/atmel-studio-arm-related" class="level-3">--Atmel Studio (ARM-related)</option><option value="http://www.avrfreaks.net/forums/compilers-assembers-linkers-and-general-programming-arm-related" class="level-3">--Compilers, Assembers, Linkers and General Programming (ARM-related)</option><option value="http://www.avrfreaks.net/forums/operating-systems" class="level-2">-Operating Systems</option><option value="http://www.avrfreaks.net/forums/linux" class="level-3">--Linux</option><option value="http://www.avrfreaks.net/forums/android" class="level-3">--Android</option><option value="http://www.avrfreaks.net/forums/wince" class="level-3">--WinCE</option><option value="http://www.avrfreaks.net/forums/%C2%B5cos-ii-real-time-kernel" class="level-3">--µC/OS-II - Real-Time Kernel</option><option value="http://www.avrfreaks.net/forums/internet-things" class="level-1">Internet of Things</option><option value="http://www.avrfreaks.net/forums/wireless-2" class="level-2">-Wireless</option><option value="http://www.avrfreaks.net/forums/general-wireless-discussions" class="level-3">--General Wireless Discussions</option><option value="http://www.avrfreaks.net/forums/80211wi-fi" class="level-3">--802.11/Wi-Fi</option><option value="http://www.avrfreaks.net/forums/802154zigbee" class="level-3">--802.15.4/ZigBee</option><option value="http://www.avrfreaks.net/forums/bluetooth" class="level-3">--Bluetooth</option><option value="http://www.avrfreaks.net/forums/security-0" class="level-2">-Security</option><option value="http://www.avrfreaks.net/forums/general-security-discussions" class="level-3">--General Security Discussions</option><option value="http://www.avrfreaks.net/forums/capacitive-touch" class="level-1">Capacitive Touch</option><option value="http://www.avrfreaks.net/forums/capacitive-touch-solutions" class="level-2">-Capacitive Touch Solutions</option><option value="http://www.avrfreaks.net/forums/general-capacitive-touch-discussions" class="level-3">--General Capacitive Touch Discussions</option></select>
</div>
<input type="hidden" name="form_build_id" value="form-xQPu5WmEyHMmx3XC852zk_enAfcPxjQSFmlo5j3X0c4">
<input type="hidden" name="form_id" value="avrfreaks_forum_select_form">

  </div>
</form>

</div>
        </div>
    </div>

    
    
  </div>
</div>
    </div>
  </div>
</div>
            </div>
          
          

          
        </div><!-- /end #main-content -->

        <!-- region: Content Aside -->
        
      </div><!-- /end .content-inner -->
    </div><!-- /end #content-column -->

    <!-- regions: Sidebar first and Sidebar second -->
        
  </div><!-- /end #columns -->

  <!-- region: Tertiary Content -->
  
  <!-- region: Footer -->
  
</div>
<div id="footer-second" class="footer-wrapper"><div class="region region-footer-second"><div class="region-inner clearfix"><div id="block-block-6" class="block block-block no-title odd first block-count-5 block-region-footer-second block-6"><div class="block-inner clearfix">  
  
  <div class="block-content content"><p>©2015 Atmel Corporation</p>
</div>
  </div></div><nav id="block-menu-menu-footer-links" class="block block-menu no-title even last block-count-6 block-region-footer-second block-menu-footer-links" role="navigation"><div class="block-inner clearfix">  
  
  <div class="block-content content"><ul class="menu clearfix"><li class="first leaf"><a href="http://www.atmel.com/About/privacy.aspx" target="_blank">Privacy</a></li>
<li class="leaf"><a href="http://www.atmel.com/About/contact/distributors/default.aspx?contactType=Online%20Directory" target="_blank">Contact</a></li>
<li class="leaf"><a href="http://www.atmel.com/About/legal.aspx" target="_blank">Site Use Terms</a></li>
<li class="last leaf"><a href="http://www.atmel.com/About/cookies.aspx" target="_blank">Cookies</a></li>
</ul></div>
  </div></nav></div></div></div>
  

</body></html>